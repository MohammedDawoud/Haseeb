<div class="home-page flex flex-col gap-5">
  <div class="flex gap-3 flex-wrap">
    <div
      *ngFor="let div of info"
      class="flex gap-2 flex-grow justify-between items-center bg-white rounded-2xl p-4"
      style="cursor: pointer"
      (click)="
       
           div.title.ar == 'الاشعارات'
          ? open(notifications)
          
          : div.title.ar == 'التعاميم'
          ? open(alert, null, null, null, 'alert')
          : ''
      "
    >
      <div class="flex gap-2 items-center">
        <img class="w-10" src="assets/icons/{{ div.img }}.png" alt="" />
        <span
          class="text-xl"
          [translate]="'name'"
          [translateParams]="{
            ar: div.title.ar,
            en: div.title.en
          }"
        ></span>
      </div>
      <div
        [style]="'background-color:' + div.color"
        class="last-of-type:aspect-auto rounded-full flex items-center justify-center p-1 aspect-square text-white"
      >
        <span *ngIf="div.title.ar == 'الاشعارات'">{{
          NotificationsCount
        }}</span>
        <span *ngIf="div.title.ar == 'التعاميم'">{{ AllertCount }}</span>

        <!-- <span>{{
          div.title.ar == 'مشاريعي'
          ? GetUserProjects
          : div.title.ar == 'الاشعارات'
          ? NotificationsCount
          : div.title.ar == 'مهامى'
          ? TasksByUserCount
          : div.title.ar == 'التعاميم'
          ? AllertCount
          : '200'
      "

        }}</span> -->
        <span *ngIf="div.title?.en == 'Tools'"
          >{{ Custodies }}{{ lang == "ar" ? " ر.س" : " r.s" }}</span
        >
      </div>
    </div>
  </div>
  <!--  -->
  <div class="w-full overflow-x-auto">
    <div class="flex gap-3 flex-nowrap">
      <!-- Card 1 -->
      <div
        (click)="open(followLoanModal, null, null, null, 'client')"
        class="flex min-w-[220px] gap-2 items-center bg-orange-400 text-white rounded-2xl p-3"
        style="cursor: pointer"
      >
        <img class="w-5" src="assets/icons/moneybag@2x.png" alt="" />
        <span class="text-sm" [translate]="'name'" [translateParams]="{ ar: 'طلب سلفة', en: 'Predecessor Application' }"></span>
      </div>
  
      <!-- Card 2 -->
      <div
        (click)="open(followVacationsModal, null, null, null, 'vacationclient')"
        class="flex min-w-[220px] gap-2 items-center bg-cyan-600 text-white rounded-2xl p-3"
        style="cursor: pointer"
      >
        <img class="w-5" src="assets/icons/on-holiday-line@2x.png" alt="" />
        <span class="text-sm" [translate]="'name'" [translateParams]="{ ar: 'طلب اجازة', en: 'Vacation Application' }"></span>
      </div>
  
      <!-- Card 3 -->
      <div
        (click)="open(Reports, null, null, null, 'openreport')"
        class="flex min-w-[220px] gap-2 items-center bg-zinc-600 text-white rounded-2xl p-3"
        style="cursor: pointer"
      >
        <img class="w-5" src="assets/icons/report@2x.png" alt="" />
        <span class="text-sm" [translate]="'name'" [translateParams]="{ ar: 'التقارير', en: 'Reports' }"></span>
      </div>
  
      <!-- Card 4 -->
      <div
        (click)="open(supervision, null, null, null, 'supervisions')"
        class="flex min-w-[220px] gap-2 items-center bg-emerald-600 text-white rounded-2xl p-3"
        style="cursor: pointer"
      >
        <img class="w-5" src="assets/icons/airline-manage-gates@2x.png" alt="" />
        <span class="text-sm" [translate]="'name'" [translateParams]="{ ar: 'طلعات الاشراف', en: 'Supervisions' }"></span>
      </div>
  
      <!-- Table Box -->
      <div class="flex min-w-[300px] bg-blue-600 text-white rounded-2xl p-2 items-center">
        <table class="table-fixed text-center text-xs border-separate border-spacing-1 w-full">
          <tr>
            <td class="border border-white px-5 py-0.5" style="color: red; font-weight: bold;">غياب</td>
            <td class="border border-white px-5 py-0.5">{{ monthName }}</td>
            <td class="border border-white px-2 py-0.5">{{ absenceCount }}</td>
          </tr>
          <tr *ngIf="(dawam == null || dawam == '') || absenceCount > 3" style="color: red; font-weight: bold;">
            <td class="border border-white px-2 py-0.5 text-[11px]" colspan="3">
              <ng-container *ngIf="(dawam == null || dawam == '') && absenceCount > 3">
                راجع شؤون الموظفين / الموظف غير مرتبط بدوام
              </ng-container>
              <ng-container *ngIf="(dawam == null || dawam == '') && absenceCount <= 3">
                الموظف غير مرتبط بدوام
              </ng-container>
              <ng-container *ngIf="(dawam != null && dawam != '') && absenceCount > 3">
                راجع شؤون الموظفين
              </ng-container>
            </td>
          </tr>
        </table>
      </div>
  
      <!-- Alerts -->
      <div class="flex flex-col justify-center gap-1 px-1 min-w-[200px]">
        <div *ngIf="Hosting_Message" class="bg-danger text-white text-[10px] rounded-md px-2 py-1 flex items-center gap-1">
          <i class="fas fa-location text-xs"></i>
          <span>{{ Hosting_Message }}</span>
        </div>
  
        <div *ngIf="backupload != null" class="bg-danger text-white text-[10px] rounded-md px-2 py-1 flex items-center gap-1">
          <i class="fas fa-location text-xs"></i>
          <span [translate]="'name'" [translateParams]="{ ar: 'تنبيه بضرورة إجراء نسخ احتياطي', en: 'You have a backup order' }"></span>
        </div>
      </div>
    </div>
  </div>
  
  
  <!--  -->
  <div class="shaped-tab box relative">
    <div class="info">
      <h3>{{ UseName }}</h3>
      <p>{{ JobName }}</p>
    </div>

    
  </div>

  <!-- ------------------------------------المخططات الزمنية ------------------------------->
  
          <!-----------------------------------------    region  Tasks   --------------------------------->

          

   

 

  <!-- متابعة المالية -->
  <div class="shaped-tab box" *ngIf="userG?.userPrivileges.includes(1512)">
    <div class="header">
      <span
        [translate]="'name'"
        [translateParams]="{
          ar: 'المتابعة المالية',
          en: 'Financial Flow-Up'
        }"
      ></span>
      <button (click)="FinancialTab = !FinancialTab">
        <i class="fa-solid fa-bars"></i>
      </button>
    </div>
    <div *ngIf="FinancialTab" [@collapse]="!FinancialTab">
      <div class="mt-3 mb-4" style="max-width: 300px">
        <div class="form-group">
          <ng-select
            name="costCenter"
            class="w-full p-0"
            (change)="refreshAllFinancialfollowup()"
            placeholder="{{ 'Chose' | translate }}"
            [clearable]="false"
            [(ngModel)]="FilterLoadData.selectedDate"
            [ngModelOptions]="{ standalone: true }"
          >
            <ng-option
              *ngFor="let date of dates"
              [value]="date.id"
              [translate]="'name'"
              [translateParams]="{ ar: date?.name?.ar, en: date?.name?.en }"
            >
            </ng-option>
          </ng-select>
        </div>
      </div>
      <div class="flex gap-4 flex-wrap my-3">
        <div
          *ngIf="userG?.userPrivileges.includes(151211)"
          [routerLink]="'/accounts/FollowUp_on_Customer_revenue'"
          class="rounded-2xl bg-white shadow-lg flex items-center py-3 px-5 flex-col gap-3"
        >
          <img
            class="h-14"
            src="/assets/icons/box-arrow-in-down-1@2x.png"
            alt=""
          />
          <span
            class="text-lg font-semi-bold"
            [translate]="'name'"
            [translateParams]="{
              ar: 'الايرادات',
              en: 'Income'
            }"
          >
          </span>
          <div class="px-3 text-blue-600 text-lg font-semibold text-base">
            {{ FilterLoadData?.RevCounterHome }} {{ "SARcurrency" | translate }}
          </div>
        </div>
        <div
          *ngIf="userG?.userPrivileges.includes(151212)"
          [routerLink]="'/accounts/Expense_follow_up'"
          class="rounded-2xl bg-white shadow-lg flex items-center py-3 px-5 flex-col gap-3"
        >
          <img
            class="h-14"
            src="/assets/icons/box-arrow-in-down@2x.png"
            alt=""
          />
          <span
            class="text-lg font-semi-bold"
            [translate]="'name'"
            [translateParams]="{
              ar: 'المصروفات',
              en: 'Expenses'
            }"
          >
          </span>
          <div class="px-3 text-blue-600 text-lg font-semibold text-base">
            {{ FilterLoadData?.ExpCounterHome }} {{ "SARcurrency" | translate }}
          </div>
        </div>
        <div
          *ngIf="userG?.userPrivileges.includes(151213)"
          class="rounded-2xl bg-white shadow-lg flex items-center py-3 px-5 flex-col gap-3"
        >
          <img class="h-14" src="/assets/icons/box@2x.png" alt="" />
          <span
            class="text-lg font-semi-bold"
            [translate]="'name'"
            [translateParams]="{
              ar: 'الصندوق',
              en: 'Box'
            }"
          >
          </span>
          <div class="px-3 text-blue-600 text-lg font-semibold text-base">
            {{ FilterLoadData?.BoxNetCounterHome }}
            {{ "SARcurrency" | translate }}
          </div>
        </div>
        <div
          *ngIf="userG?.userPrivileges.includes(151214)"
          class="rounded-2xl bg-white shadow-lg flex items-center py-3 px-5 flex-col gap-3"
        >
          <img class="h-14" src="/assets/icons/bank@2x.png" alt="" />
          <span
            class="text-lg font-semi-bold"
            [translate]="'name'"
            [translateParams]="{
              ar: 'البنك',
              en: 'Bank'
            }"
          >
          </span>
          <div class="px-3 text-blue-600 text-lg font-semibold text-base">
            {{ FilterLoadData?.BankNetCounterHome }}
            {{ "SARcurrency" | translate }}
          </div>
        </div>
      </div>

      <mat-tab-group
        [dir]="'dir' | translate"
        (selectedTabChange)="resetFilterLoad($event)"
      >
        <mat-tab *ngIf="userG?.userPrivileges.includes(151215)">
          <ng-template mat-tab-label>
            <span>
              {{ "Sale invoices" | translate }}
            </span>
            <span
              class="aspect-square w-8 border-2 border-white end-4 -translate-y-1/2 p-1 rounded-full text-center bg-orange-500 text-white absolute top-0"
            >
              {{ Saleinvoicescount }}
            </span>
          </ng-template>
          <div>
            <div class="flex gap-2 flex-wrap items-center justify-between my-3">
              <div class="flex gap-2 flex-wrap">
                <div>
                  <label class="col-form-label">
                    {{ "Sort by customer name" | translate }}</label
                  >
                  <ng-select
                    class="w-full p-0"
                    placeholder="{{ 'Chose' | translate }}"
                    (change)="GetFinancialfollowup_paging(1)"
                    [(ngModel)]="FilterLoadData.CustomerId"
                    [ngModelOptions]="{ standalone: true }"
                    [dropdownPosition]="'bottom'"
                  >
                    <ng-option
                      *ngFor="let item of FilterLoadData?.loadCustomer"
                      [value]="item.id"
                      >{{ item.name }}</ng-option
                    >
                  </ng-select>
                </div>
                <div>
                  <label class="col-form-label">
                    {{ "Sort by payment type" | translate }}</label
                  >
                  <ng-select
                    class="w-full p-0"
                    placeholder="{{ 'Chose' | translate }}"
                    name="Paytype"
                    [clearable]="true"
                    (change)="GetFinancialfollowup_paging(1)"
                    [(ngModel)]="FilterLoadData.paytypeId"
                    [ngModelOptions]="{ standalone: true }"
                    [dropdownPosition]="'bottom'"
                  >
                    <ng-option
                      *ngFor="let type of FilterLoadData?.loadpaytype"
                      [value]="type.id"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: type.name?.ar,
                        en: type.name?.en
                      }"
                    >
                    </ng-option>
                  </ng-select>
                </div>
                <div>
                  <label class="col-form-label">
                    {{ "Search" | translate }}</label
                  >
                  <input
                    #SaleinvoicesInput
                    (keyup)="GetFinancialfollowup_paging(1)"
                    type="text"
                    class="form-control"
                    name="searchtext"
                    [(ngModel)]="FilterLoadData.searchtext"
                  />
                </div>
              </div>
            </div>
            <div class="overflow-hidden">
              <div class="overflow-auto">
                <table
                  #tasksSort
                  mat-table
                  [dataSource]="FinfolData?.Saleinvoices"
                  matSort
                  class="mat-elevation-z8 rounded-t-lg overflow-hidden w-max"
                >
                  <ng-container matColumnDef="invoiceNumber">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "invoice number" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.invoiceNumber }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="InvoiceDate">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Invoice date" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.date }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="InvoiceAmount">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Invoice amount" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.totalValue }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="PaymentType">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Payment type" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.payTypeName }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="InvoiceStatus">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Invoice status" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.statusNameNew }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="PostingDate">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Posting date" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.postDate }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="customerName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "customer name" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.customerName }}
                    </td>
                  </ng-container>
                  <!-- <ng-container matColumnDef="projectNumber">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "project number" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.projectNo }}
                    </td>
                  </ng-container> -->
                  <ng-container matColumnDef="InvoiceOptions">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Invoice options" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      <div class="flex gap-1 justify-center py-2">
                        <!--طباعة  -->
                        <button
                          (click)="
                            GetInvoicePrint(element, 1); open(printDivModal)
                          "
                          type="button"
                          class="btn btn-outline-success btn-sm waves-effect"
                          data-toggle="tooltip"
                          data-placement="top"
                          title=" طباعة "
                          data-original-title="طباعة "
                        >
                          <i class="fa-solid fa-print"></i>
                        </button>
                        <!--طباعة مبسطة -->
                        <button
                          (click)="PrintVoucher(element)"
                          type="button"
                          class="btn btn-outline-success btn-sm waves-effect"
                          data-toggle="tooltip"
                          data-placement="top"
                          title=" طباعة مبسطة"
                          data-original-title="طباعة مبسطة"
                        >
                          <i class="fa-solid fa-print"></i>
                        </button>
                        <button
                          *ngIf="element.isPost == true"
                          (click)="
                            open(
                              accountingentry,
                              null,
                              element,
                              null,
                              'accountingentry'
                            )
                          "
                          class="min-w-max p-2 bg-orange-100 hover:bg-orange-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
                        >
                          <i class="fa-brands fa-stripe-s"></i>
                        </button>
                        <a
                          *ngIf="element.fileUrl"
                          class="svg-icon svg-icon-3 text-dark svg-icon-dark"
                          [href]="pathurl + element.fileUrl"
                          target="_blank"
                        >
                          <i class="fa-solid fa-eye"></i>
                        </a>
                      </div>
                    </td>
                  </ng-container>

                  <tr
                    mat-header-row
                    *matHeaderRowDef="columns1.saleInvoices"
                  ></tr>

                  <tr
                    mat-row
                    *matRowDef="let row; columns: columns1.saleInvoices"
                    class="duration-300 hover:bg-slate-100"
                  ></tr>
                  <!-- Row shown when there is no matching data. -->
                  <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell" colspan="9">
                      {{ "No result found for " }} "{{
                        SaleinvoicesInput.value
                      }}"
                    </td>
                  </tr>
                </table>
              </div>

              <mat-paginator
                #paginatorSaleinvoices
                [length]="Saleinvoicescount"
                (page)="onPageChange_Saleinvoices($event)"
                [pageSizeOptions]="[10, 25, 100]"
              >
              </mat-paginator>
            </div>
          </div>
        </mat-tab>

        <mat-tab *ngIf="userG?.userPrivileges.includes(151216)">
          <ng-template mat-tab-label>
            <span>
              {{ "Unposted sales invoices" | translate }}
            </span>
            <span
              class="aspect-square w-8 border-2 border-white end-4 -translate-y-1/2 p-1 rounded-full text-center bg-orange-500 text-white absolute top-0"
            >
              {{ Unpostedsalesinvoicescount }}
            </span>
          </ng-template>
          <div>
            <div class="flex gap-2 flex-wrap items-center justify-between my-3">
              <div class="flex gap-2 flex-wrap">
                <div>
                  <label class="col-form-label">
                    {{ "Sort by customer name" | translate }}</label
                  >
                  <ng-select
                    class="w-full p-0"
                    placeholder="{{ 'Chose' | translate }}"
                    (change)="GetFinancialfollowup_paging(2)"
                    [(ngModel)]="FilterLoadData.CustomerId"
                    [ngModelOptions]="{ standalone: true }"
                    [dropdownPosition]="'bottom'"
                  >
                    <ng-option
                      *ngFor="let item of FilterLoadData?.loadCustomer"
                      [value]="item.id"
                      >{{ item.name }}</ng-option
                    >
                  </ng-select>
                </div>
                <div>
                  <label class="col-form-label">
                    {{ "Sort by payment type" | translate }}</label
                  >
                  <ng-select
                    class="w-full p-0"
                    placeholder="{{ 'Chose' | translate }}"
                    name="Paytype"
                    [clearable]="true"
                    (change)="GetFinancialfollowup_paging(2)"
                    [(ngModel)]="FilterLoadData.paytypeId"
                    [ngModelOptions]="{ standalone: true }"
                    [dropdownPosition]="'bottom'"
                  >
                    <ng-option
                      *ngFor="let type of FilterLoadData?.loadpaytype"
                      [value]="type.id"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: type.name?.ar,
                        en: type.name?.en
                      }"
                    >
                    </ng-option>
                  </ng-select>
                </div>
                <div>
                  <label class="col-form-label">
                    {{ "Search" | translate }}</label
                  >

                  <input
                    #SaleinvoicesInput
                    (keyup)="GetFinancialfollowup_paging(2)"
                    type="text"
                    class="form-control"
                    name="searchtext"
                    [(ngModel)]="FilterLoadData.searchtext"
                  />
                </div>
              </div>
            </div>
            <div class="overflow-hidden">
              <div class="overflow-auto">
                <table
                  #tasksSort
                  mat-table
                  [dataSource]="FinfolData?.Unpostedsalesinvoices"
                  matSort
                  class="mat-elevation-z8 rounded-t-lg overflow-hidden w-max"
                >
                  <ng-container matColumnDef="contractNumber">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "contract number" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.contractNo }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="invoiceNumber">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "invoice number" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.invoiceNumber }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="InvoiceDate">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Invoice date" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.date }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="InvoiceAmount">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Invoice amount" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.totalValue }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="PaymentType">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Payment type" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.payTypeName }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="CustomerName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Customer Name" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.customerName }}
                    </td>
                  </ng-container>
                  <!-- <ng-container matColumnDef="ProjectNumber">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Project Number" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.projectNo }}
                    </td>
                  </ng-container> -->
                  <ng-container matColumnDef="DataEntryName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Data Entry Name" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.addUser }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="InvoiceOptions">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Invoice options" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      <div class="flex gap-1 justify-center py-2">
                        <!--طباعة  -->
                        <button
                          (click)="
                            GetInvoicePrint(element, 1); open(printDivModal)
                          "
                          type="button"
                          class="btn btn-outline-success btn-sm waves-effect"
                          data-toggle="tooltip"
                          data-placement="top"
                          title=" طباعة "
                          data-original-title="طباعة "
                        >
                          <i class="fa-solid fa-print"></i>
                        </button>
                        <!--طباعة مبسطة -->
                        <button
                          (click)="PrintVoucher(element)"
                          type="button"
                          class="btn btn-outline-success btn-sm waves-effect"
                          data-toggle="tooltip"
                          data-placement="top"
                          title=" طباعة مبسطة"
                          data-original-title="طباعة مبسطة"
                        >
                          <i class="fa-solid fa-print"></i>
                        </button>
                        <a
                          *ngIf="element.fileUrl"
                          class="svg-icon svg-icon-3 text-dark svg-icon-dark"
                          [href]="pathurl + element.fileUrl"
                          target="_blank"
                        >
                          <i class="fa-solid fa-eye"></i>
                        </a>
                      </div>
                    </td>
                  </ng-container>

                  <tr
                    mat-header-row
                    *matHeaderRowDef="columns1.DeferredSalesInvoices"
                  ></tr>

                  <tr
                    mat-row
                    *matRowDef="
                      let row;
                      columns: columns1.DeferredSalesInvoices
                    "
                    class="duration-300 hover:bg-slate-100"
                  ></tr>
                  <!-- Row shown when there is no matching data. -->
                  <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell" colspan="9">
                      {{ "No result found for " }}
                    </td>
                  </tr>
                </table>
              </div>

              <mat-paginator
                #paginatorUnpostedsalesinvoices
                [length]="Unpostedsalesinvoicescount"
                (page)="onPageChange_Unpostedsalesinvoices($event)"
                [pageSizeOptions]="[10, 25, 100]"
              >
              </mat-paginator>
            </div>
          </div>
        </mat-tab>

        <mat-tab *ngIf="userG?.userPrivileges.includes(151217)">
          <ng-template mat-tab-label>
            <span>
              {{ "Bills without a project" | translate }}
            </span>
            <span
              class="aspect-square w-8 border-2 border-white end-4 -translate-y-1/2 p-1 rounded-full text-center bg-orange-500 text-white absolute top-0"
            >
              {{ Billswithoutaprojectcount }}
            </span>
          </ng-template>
          <div>
            <div class="flex gap-2 flex-wrap items-center justify-between my-3">
              <div class="flex gap-2 flex-wrap">
                <div>
                  <label class="col-form-label">
                    {{ "Sort by customer name" | translate }}</label
                  >
                  <ng-select
                    class="w-full p-0"
                    placeholder="{{ 'Chose' | translate }}"
                    (change)="GetFinancialfollowup_paging(3)"
                    [(ngModel)]="FilterLoadData.CustomerId"
                    [ngModelOptions]="{ standalone: true }"
                    [dropdownPosition]="'bottom'"
                  >
                    <ng-option
                      *ngFor="let item of FilterLoadData?.loadCustomer"
                      [value]="item.id"
                      >{{ item.name }}</ng-option
                    >
                  </ng-select>
                </div>
                <div>
                  <label class="col-form-label">
                    {{ "Sort by payment type" | translate }}</label
                  >
                  <ng-select
                    class="w-full p-0"
                    placeholder="{{ 'Chose' | translate }}"
                    name="Paytype"
                    [clearable]="true"
                    (change)="GetFinancialfollowup_paging(3)"
                    [(ngModel)]="FilterLoadData.paytypeId"
                    [ngModelOptions]="{ standalone: true }"
                    [dropdownPosition]="'bottom'"
                  >
                    <ng-option
                      *ngFor="let type of FilterLoadData?.loadpaytype"
                      [value]="type.id"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: type.name?.ar,
                        en: type.name?.en
                      }"
                    >
                    </ng-option>
                  </ng-select>
                </div>
                <div>
                  <label class="col-form-label">
                    {{ "Search" | translate }}</label
                  >

                  <input
                    #BillswithoutaprojectInput
                    (keyup)="GetFinancialfollowup_paging(3)"
                    type="text"
                    class="form-control"
                    name="searchtext"
                    [(ngModel)]="FilterLoadData.searchtext"
                  />
                </div>
              </div>
            </div>
            <div class="overflow-hidden">
              <div class="overflow-auto">
                <table
                  #tasksSort
                  mat-table
                  [dataSource]="FinfolData?.Billswithoutaproject"
                  matSort
                  class="mat-elevation-z8 rounded-t-lg overflow-hidden w-max"
                >
                  <ng-container matColumnDef="invoiceNumber">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "invoice number" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.invoiceNumber }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="InvoiceDate">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Invoice date" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.date }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="InvoiceAmount">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Invoice amount" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.totalValue }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="PaymentType">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Payment type" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.payTypeName }}
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="InvoiceStatus">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Invoice status" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.statusNameNew }}
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="PostingDate">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Posting date" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.postDate }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="customerName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "customer name" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.customerName }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="DataEntryName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Data Entry Name" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.addUser }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="InvoiceOptions">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Invoice options" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      <div class="flex gap-2 justify-center py-2">
                        <!--طباعة  -->
                        <button
                          (click)="
                            GetInvoicePrint(element, 1); open(printDivModal)
                          "
                          type="button"
                          class="btn btn-outline-success btn-sm waves-effect"
                          data-toggle="tooltip"
                          data-placement="top"
                          title=" طباعة "
                          data-original-title="طباعة "
                        >
                          <i class="fa-solid fa-print"></i>
                        </button>
                        <!--طباعة مبسطة -->
                        <button
                          (click)="PrintVoucher(element)"
                          type="button"
                          class="btn btn-outline-success btn-sm waves-effect"
                          data-toggle="tooltip"
                          data-placement="top"
                          title=" طباعة مبسطة"
                          data-original-title="طباعة مبسطة"
                        >
                          <i class="fa-solid fa-print"></i>
                        </button>
                        <button
                          *ngIf="element.isPost == true"
                          (click)="
                            open(
                              accountingentry,
                              null,
                              element,
                              null,
                              'accountingentry'
                            )
                          "
                          class="min-w-max p-2 bg-orange-100 hover:bg-orange-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
                        >
                          <i class="fa-brands fa-stripe-s"></i>
                        </button>
                        <a
                          *ngIf="element.fileUrl"
                          class="svg-icon svg-icon-3 text-dark svg-icon-dark"
                          [href]="pathurl + element.fileUrl"
                          target="_blank"
                        >
                          <i class="fa-solid fa-eye"></i>
                        </a>
                      </div>
                    </td>
                  </ng-container>

                  <tr
                    mat-header-row
                    *matHeaderRowDef="columns1.InvoicesWithoutProjects"
                  ></tr>

                  <tr
                    mat-row
                    *matRowDef="
                      let row;
                      columns: columns1.InvoicesWithoutProjects
                    "
                    class="duration-300 hover:bg-slate-100"
                  ></tr>
                  <!-- Row shown when there is no matching data. -->
                  <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell" colspan="9">
                      {{ "No result found for " }} "{{
                        BillswithoutaprojectInput.value
                      }}"
                    </td>
                  </tr>
                </table>
              </div>

              <mat-paginator
                #paginatorBillswithoutaproject
                [length]="Billswithoutaprojectcount"
                (page)="onPageChange_Billswithoutaproject($event)"
                [pageSizeOptions]="[10, 25, 100]"
              >
              </mat-paginator>
            </div>
          </div>
        </mat-tab>

        <mat-tab *ngIf="userG?.userPrivileges.includes(151218)">
          <ng-template mat-tab-label>
            <span>
              {{ "Purchase invoices" | translate }}
            </span>
            <span
              class="aspect-square w-8 border-2 border-white end-4 -translate-y-1/2 p-1 rounded-full text-center bg-orange-500 text-white absolute top-0"
            >
              {{ Purchaseinvoicescount }}
            </span>
          </ng-template>
          <div>
            <div class="flex gap-2 flex-wrap items-center justify-between my-3">
              <div class="flex gap-2 flex-wrap">
                <div>
                  <label class="col-form-label">
                    {{ "Sort by resource name" | translate }}</label
                  >
                  <ng-select
                    class="w-full p-0"
                    placeholder="{{ 'Chose' | translate }}"
                    (change)="GetFinancialfollowup_paging(4)"
                    [(ngModel)]="FilterLoadData.supplierId"
                    [ngModelOptions]="{ standalone: true }"
                    [dropdownPosition]="'bottom'"
                  >
                    <ng-option
                      *ngFor="let item of FilterLoadData?.loadSupplier"
                      [value]="item.id"
                      >{{ item.name }}</ng-option
                    >
                  </ng-select>
                </div>
                <div>
                  <label class="col-form-label">
                    {{ "Sort by payment type" | translate }}</label
                  >
                  <ng-select
                    class="w-full p-0"
                    placeholder="{{ 'Chose' | translate }}"
                    name="Paytype"
                    [clearable]="true"
                    (change)="GetFinancialfollowup_paging(4)"
                    [(ngModel)]="FilterLoadData.paytypeId"
                    [ngModelOptions]="{ standalone: true }"
                  >
                    <ng-option
                      *ngFor="let type of FilterLoadData?.loadpaytype"
                      [value]="type.id"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: type.name?.ar,
                        en: type.name?.en
                      }"
                    >
                    </ng-option>
                  </ng-select>
                </div>
                <div>
                  <label class="col-form-label">
                    {{ "Search" | translate }}</label
                  >

                  <input
                    #SaleinvoicesInput
                    (keyup)="GetFinancialfollowup_paging(4)"
                    type="text"
                    class="form-control"
                    name="searchtext"
                    [(ngModel)]="FilterLoadData.searchtext"
                  />
                </div>
              </div>
            </div>
            <div class="overflow-hidden">
              <div class="overflow-auto">
                <table
                  #tasksSort
                  mat-table
                  [dataSource]="FinfolData?.Purchaseinvoices"
                  matSort
                  class="mat-elevation-z8 rounded-t-lg overflow-hidden w-max"
                >
                  <ng-container matColumnDef="invoiceNumber">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "invoice number" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.invoiceNumber }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="InvoiceDate">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Invoice date" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.date }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="InvoiceAmount">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Invoice amount" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.totalValue }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="PaymentType">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Payment type" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.payTypeName }}
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="ResourceName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "ResourceName" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.customerName }}
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="InvoiceStatus">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Invoice status" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.statusNameNew }}
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="PostingDate">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Posting date" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.postDate }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="DataEntryName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Data Entry Name" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.addUser }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="InvoiceOptions">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Invoice options" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      <div class="flex gap-1 justify-center py-2">
                        <!--طباعة  -->
                        <button
                          (click)="
                            GetInvoicePurchasePrint(element, 1);
                            open(printDivModalPurchase)
                          "
                          type="button"
                          class="btn btn-outline-success btn-sm waves-effect"
                          data-toggle="tooltip"
                          data-placement="top"
                          title=" طباعة "
                          data-original-title="طباعة "
                        >
                          <i class="fa-solid fa-print"></i>
                        </button>
                        <button
                          *ngIf="element.isPost == true"
                          (click)="
                            open(
                              accountingentry,
                              null,
                              element,
                              null,
                              'accountingentryPurchase'
                            )
                          "
                          class="min-w-max p-2 bg-orange-100 hover:bg-orange-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
                        >
                          <i class="fa-brands fa-stripe-s"></i>
                        </button>

                        <!-- <button *ngIf="element.isPost == true"
                        (click)="open(accountingentry,null, element,null, 'accountingentryPurchase')"
                         class="min-w-max p-2 bg-orange-100 hover:bg-orange-500 rounded-lg duration-300 hover:text-white aspect-square w-10">
                         <i class="fa-brands fa-stripe-s"></i>
                       </button> -->
                      </div>
                    </td>
                  </ng-container>

                  <tr
                    mat-header-row
                    *matHeaderRowDef="columns1.purchaseInvoices"
                  ></tr>

                  <tr
                    mat-row
                    *matRowDef="let row; columns: columns1.purchaseInvoices"
                    class="duration-300 hover:bg-slate-100"
                  ></tr>
                  <!-- Row shown when there is no matching data. -->
                  <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell" colspan="9">
                      {{ "No result found " }}
                    </td>
                  </tr>
                </table>
              </div>

              <mat-paginator
                #paginatorPurchaseinvoices
                [length]="Purchaseinvoicescount"
                (page)="onPageChange_Purchaseinvoices($event)"
                [pageSizeOptions]="[10, 25, 100]"
              >
              </mat-paginator>
            </div>
          </div>
        </mat-tab>

        <mat-tab *ngIf="userG?.userPrivileges.includes(151219)">
          <ng-template mat-tab-label>
            <span>
              {{ "Unposted purchase invoices" | translate }}
            </span>
            <span
              class="aspect-square w-8 border-2 border-white end-4 -translate-y-1/2 p-1 rounded-full text-center bg-orange-500 text-white absolute top-0"
            >
              {{ Unpostedpurchaseinvoicescount }}
            </span>
          </ng-template>
          <div>
            <div class="flex gap-2 flex-wrap items-center justify-between my-3">
              <div class="flex gap-2 flex-wrap">
                <div>
                  <label class="col-form-label">
                    {{ "Sort by resource name" | translate }}</label
                  >
                  <ng-select
                    class="w-full p-0"
                    placeholder="{{ 'Chose' | translate }}"
                    (change)="GetFinancialfollowup_paging(5)"
                    [(ngModel)]="FilterLoadData.supplierId"
                    [ngModelOptions]="{ standalone: true }"
                    [dropdownPosition]="'bottom'"
                  >
                    <ng-option
                      *ngFor="let item of FilterLoadData?.loadSupplier"
                      [value]="item.id"
                      >{{ item.name }}</ng-option
                    >
                  </ng-select>
                </div>
                <div>
                  <label class="col-form-label">
                    {{ "Sort by payment type" | translate }}</label
                  >
                  <ng-select
                    class="w-full p-0"
                    placeholder="{{ 'Chose' | translate }}"
                    name="Paytype"
                    [clearable]="true"
                    (change)="GetFinancialfollowup_paging(5)"
                    [(ngModel)]="FilterLoadData.paytypeId"
                    [ngModelOptions]="{ standalone: true }"
                  >
                    <ng-option
                      *ngFor="let type of FilterLoadData?.loadpaytype"
                      [value]="type.id"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: type.name?.ar,
                        en: type.name?.en
                      }"
                    >
                    </ng-option>
                  </ng-select>
                </div>
                <div>
                  <label class="col-form-label">
                    {{ "Search" | translate }}</label
                  >

                  <input
                    #UnpostedpurchaseinvoicesInput
                    (keyup)="GetFinancialfollowup_paging(5)"
                    type="text"
                    class="form-control"
                    name="searchtext"
                    [(ngModel)]="FilterLoadData.searchtext"
                  />
                </div>
              </div>
            </div>
            <div class="overflow-hidden">
              <div class="overflow-auto">
                <table
                  #tasksSort
                  mat-table
                  [dataSource]="FinfolData?.Unpostedpurchaseinvoices"
                  matSort
                  class="mat-elevation-z8 rounded-t-lg overflow-hidden w-max"
                >
                  <ng-container matColumnDef="invoiceNumber">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "invoice number" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.invoiceNumber }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="InvoiceDate">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Invoice date" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.date }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="InvoiceAmount">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Invoice amount" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.invoiceValue }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="PaymentType">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Payment type" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.payTypeName }}
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="ResourceName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "ResourceName" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.customerName }}
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="InvoiceStatus">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Invoice status" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.statusNameNew }}
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="DataEntryName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Data Entry Name" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.addUser }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="InvoiceOptions">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Invoice options" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      <div class="flex gap-1 justify-center py-2">
                        <!--طباعة  -->
                        <button
                          (click)="
                            GetInvoicePurchasePrint(element, 1);
                            open(printDivModalPurchase)
                          "
                          type="button"
                          class="btn btn-outline-success btn-sm waves-effect"
                          data-toggle="tooltip"
                          data-placement="top"
                          title=" طباعة "
                          data-original-title="طباعة "
                        >
                          <i class="fa-solid fa-print"></i>
                        </button>
                      </div>
                    </td>
                  </ng-container>

                  <tr
                    mat-header-row
                    *matHeaderRowDef="columns1.DeferredPurchaseInvoices"
                  ></tr>

                  <tr
                    mat-row
                    *matRowDef="
                      let row;
                      columns: columns1.DeferredPurchaseInvoices
                    "
                    class="duration-300 hover:bg-slate-100"
                  ></tr>
                  <!-- Row shown when there is no matching data. -->
                  <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell" colspan="9">
                      {{ "No result found for " }} "{{
                        UnpostedpurchaseinvoicesInput.value
                      }}"
                    </td>
                  </tr>
                </table>
              </div>

              <mat-paginator
                #paginatorUnpostedpurchaseinvoices
                [length]="Unpostedpurchaseinvoicescount"
                (page)="onPageChange_Unpostedpurchaseinvoices($event)"
                [pageSizeOptions]="[10, 25, 100]"
              >
              </mat-paginator>
            </div>
          </div>
        </mat-tab>

        <mat-tab *ngIf="userG?.userPrivileges.includes(151220)">
          <ng-template mat-tab-label>
            <span>
              {{ "Non-post receipt vouchers" | translate }}
            </span>
            <span
              class="aspect-square w-8 border-2 border-white end-4 -translate-y-1/2 p-1 rounded-full text-center bg-orange-500 text-white absolute top-0"
            >
              {{ Nonpostreceiptvoucherscount }}
            </span>
          </ng-template>
          <div>
            <div class="flex gap-2 flex-wrap items-center justify-between my-3">
              <div class="flex gap-2 flex-wrap">
                <div>
                  <label class="col-form-label">
                    {{ "Sort by customer name" | translate }}</label
                  >
                  <ng-select
                    class="w-full p-0"
                    placeholder="{{ 'Chose' | translate }}"
                    (change)="GetFinancialfollowup_paging(6)"
                    [(ngModel)]="FilterLoadData.CustomerId"
                    [ngModelOptions]="{ standalone: true }"
                    [dropdownPosition]="'bottom'"
                  >
                    <ng-option
                      *ngFor="let item of FilterLoadData?.loadCustomer"
                      [value]="item.id"
                      >{{ item.name }}</ng-option
                    >
                  </ng-select>
                </div>
                <div>
                  <label class="col-form-label">
                    {{ "Sort by payment type" | translate }}</label
                  >
                  <ng-select
                    class="w-full p-0"
                    placeholder="{{ 'Chose' | translate }}"
                    name="Paytype"
                    [clearable]="true"
                    (change)="GetFinancialfollowup_paging(6)"
                    [(ngModel)]="FilterLoadData.paytypeId"
                    [ngModelOptions]="{ standalone: true }"
                  >
                    <ng-option
                      *ngFor="let type of FilterLoadData?.loadpaytype"
                      [value]="type.id"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: type.name?.ar,
                        en: type.name?.en
                      }"
                    >
                    </ng-option>
                  </ng-select>
                </div>
                <div>
                  <label class="col-form-label">
                    {{ "Search" | translate }}</label
                  >

                  <input
                    #NonpostreceiptvouchersInput
                    (keyup)="GetFinancialfollowup_paging(6)"
                    type="text"
                    class="form-control"
                    name="searchtext"
                    [(ngModel)]="FilterLoadData.searchtext"
                  />
                </div>
              </div>
            </div>
            <div class="overflow-hidden">
              <div class="overflow-auto">
                <table
                  #tasksSort
                  mat-table
                  [dataSource]="FinfolData?.Nonpostreceiptvouchers"
                  matSort
                  class="mat-elevation-z8 rounded-t-lg overflow-hidden w-max"
                >
                  <ng-container matColumnDef="BondNumber">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Bond number" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.invoiceNumber }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="BondDate">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "BondDate" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.date }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="BondAmount">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Bond amount" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.totalValue }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="PaymentType">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Payment type" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.payTypeName }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="ClientName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Client Name" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.customerName }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="BondCondition">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "BondCondition" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.statusNameNew }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="DataEntryName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Data Entry Name" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.addUser }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="operations">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "operations" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      <div class="flex gap-1 justify-center py-2">
                        <button
                          type="button"
                          id="68"
                          class="AddNewTaskbtn btn btn-outline-success btn-sm waves-effect mx-1"
                          (click)="GetReport(element)"
                          data-toggle="tooltip"
                          data-placement="top"
                          title=" طباعة "
                          data-original-title="طباعة "
                        >
                          <i class="fa-solid fa-print"></i>
                        </button>
                        <button
                          *ngIf="element.fileUrl"
                          (click)="downloadFileFinfollowup(element)"
                          class="min-w-max p-2 bg-orange-100 hover:bg-orange-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
                        >
                          <i class="fa-solid fa-paperclip"></i>
                        </button>
                      </div>
                    </td>
                  </ng-container>

                  <tr mat-header-row *matHeaderRowDef="columns1.Bonds"></tr>

                  <tr
                    mat-row
                    *matRowDef="let row; columns: columns1.Bonds"
                    class="duration-300 hover:bg-slate-100"
                  ></tr>
                  <!-- Row shown when there is no matching data. -->
                  <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell" colspan="9">
                      {{ "No result found for " }} "{{
                        NonpostreceiptvouchersInput.value
                      }}"
                    </td>
                  </tr>
                </table>
              </div>

              <mat-paginator
                #paginatorNonpostreceiptvouchers
                [length]="Nonpostreceiptvoucherscount"
                (page)="onPageChange_Nonpostreceiptvouchers($event)"
                [pageSizeOptions]="[10, 25, 100]"
              >
              </mat-paginator>
            </div>
          </div>
        </mat-tab>

        <mat-tab *ngIf="userG?.userPrivileges.includes(151221)">
          <ng-template mat-tab-label>
            <span>
              {{ "Non-post bonds" | translate }}
            </span>
            <span
              class="aspect-square w-8 border-2 border-white end-4 -translate-y-1/2 p-1 rounded-full text-center bg-orange-500 text-white absolute top-0"
            >
              {{ Nonpostbondscount }}
            </span>
          </ng-template>
          <div>
            <div class="flex gap-2 flex-wrap items-center justify-between my-3">
              <div class="flex gap-2 flex-wrap">
                <div>
                  <label class="col-form-label">
                    {{ "Sort by recipient name" | translate }}</label
                  >
                  <ng-select
                    class="w-full p-0"
                    placeholder="{{ 'Chose' | translate }}"
                    (change)="GetFinancialfollowup_paging(7)"
                    [(ngModel)]="FilterLoadData.supplierId"
                    [ngModelOptions]="{ standalone: true }"
                    [dropdownPosition]="'bottom'"
                  >
                    <ng-option
                      *ngFor="let item of FilterLoadData?.loadSupplier"
                      [value]="item.id"
                      >{{ item.name }}</ng-option
                    >
                  </ng-select>
                </div>
                <div>
                  <label class="col-form-label">
                    {{ "Sort by payment type" | translate }}</label
                  >
                  <ng-select
                    class="w-full p-0"
                    placeholder="{{ 'Chose' | translate }}"
                    name="Paytype"
                    [clearable]="true"
                    (change)="GetFinancialfollowup_paging(7)"
                    [(ngModel)]="FilterLoadData.paytypeId"
                    [ngModelOptions]="{ standalone: true }"
                    [dropdownPosition]="'bottom'"
                  >
                    <ng-option
                      *ngFor="let type of FilterLoadData?.loadpaytype"
                      [value]="type.id"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: type.name?.ar,
                        en: type.name?.en
                      }"
                    >
                    </ng-option>
                  </ng-select>
                </div>
                <div>
                  <label class="col-form-label">
                    {{ "Search" | translate }}</label
                  >

                  <input
                    #NonpostbondsInput
                    (keyup)="GetFinancialfollowup_paging(7)"
                    type="text"
                    class="form-control"
                    name="searchtext"
                    [(ngModel)]="FilterLoadData.searchtext"
                  />
                </div>
              </div>
            </div>
            <div class="overflow-hidden">
              <div class="overflow-auto">
                <table
                  #tasksSort
                  mat-table
                  [dataSource]="FinfolData?.Nonpostbonds"
                  matSort
                  class="mat-elevation-z8 rounded-t-lg overflow-hidden w-max"
                >
                  <ng-container matColumnDef="BondNumber">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Bond number" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.invoiceNumber }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="BondDate">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "BondDate" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.date }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="BondAmount">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Bond amount" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.totalValue }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="PaymentType">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Payment type" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.payTypeName }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="SupplierEmployeeName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Supplier/employee name" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.customerName }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="PurchaseInvoiceNumber">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Purchase invoice number" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.supplierInvoiceNo }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="ExchangeItemName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Exchange item name" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.clauseName }}
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="DataEntryName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Data Entry Name" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.addUser }}
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="operations">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "operations" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      <div class="flex gap-1 justify-center py-2">
                        <!--طباعة  -->
                        <button
                          type="button"
                          id="68"
                          class="AddNewTaskbtn btn btn-outline-success btn-sm waves-effect mx-1"
                          data-toggle="tooltip"
                          data-placement="top"
                          title=" طباعة "
                          data-original-title="طباعة "
                          (click)="GetReportR(element)"
                        >
                          <i class="fa-solid fa-print"></i>
                        </button>
                        <button
                          *ngIf="element.fileUrl"
                          (click)="downloadFileFinfollowup(element)"
                          class="min-w-max p-2 bg-orange-100 hover:bg-orange-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
                        >
                          <i class="fa-solid fa-paperclip"></i>
                        </button>
                      </div>
                    </td>
                  </ng-container>

                  <tr
                    mat-header-row
                    *matHeaderRowDef="columns1.DeferredBonds"
                  ></tr>

                  <tr
                    mat-row
                    *matRowDef="let row; columns: columns1.DeferredBonds"
                    class="duration-300 hover:bg-slate-100"
                  ></tr>
                  <!-- Row shown when there is no matching data. -->
                  <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell" colspan="9">
                      {{ "No result found for " }} "{{
                        NonpostbondsInput.value
                      }}"
                    </td>
                  </tr>
                </table>
              </div>

              <mat-paginator
                #paginatorNonpostbonds
                [length]="Nonpostbondscount"
                (page)="onPageChange_Nonpostbonds($event)"
                [pageSizeOptions]="[10, 25, 100]"
              >
              </mat-paginator>
            </div>
          </div>
        </mat-tab>
      </mat-tab-group>
    </div>
  </div>

  <!-- --------------------------------المتابعه الادارية --------------------------------->
  <div
    class="shaped-tab box Administrative"
    *ngIf="userG?.userPrivileges.includes(1513)"
  >
    <div class="header">
      <span
        [translate]="'name'"
        [translateParams]="{
          ar: 'المتابعه الادارية',
          en: 'Administrative Flow'
        }"
      ></span>
      <button (click)="AdministrativeTab = !AdministrativeTab">
        <i class="fa-solid fa-bars"></i>
      </button>
    </div>

    <div *ngIf="AdministrativeTab" [@collapse]="!AdministrativeTab">
      <div class="mt-3 mb-4" style="max-width: 300px">
        <div class="form-group">
          <ng-select
            name="costCenter"
            class="w-full p-0"
            placeholder="{{ 'Chose' | translate }}"
            [(ngModel)]="selectedDatemangementemp"
            [ngModelOptions]="{ standalone: true }"
            (ngModelChange)="getemployeereports()"
            [dropdownPosition]="'bottom'"
          >
            <ng-option
              *ngFor="let date of dates"
              [value]="date.id"
              [translate]="'name'"
              [translateParams]="{ ar: date?.name?.ar, en: date?.name?.en }"
            >
            </ng-option>
          </ng-select>
        </div>
      </div>

      <div class="flex gap-4 flex-wrap my-3">
        <div
          *ngIf="userG?.userPrivileges.includes(151311)"
          class="rounded-2xl bg-white shadow-lg flex items-center py-3 px-5 flex-col gap-3"
        >
          <img
            class="h-14"
            src="/assets/icons/status-resolved-1@2x.png"
            alt=""
          />
          <span
            class="text-lg font-semi-bold"
            [translate]="'name'"
            [translateParams]="{
              ar: 'الحاضرون',
              en: 'Attendence'
            }"
          >
          </span>
          <div
            class="py-2 px-3 bg-blue-100 text-blue-600 rounded-full"
            [translate]="'name'"
            [translateParams]="{
              ar: attendencecount + 'موظف',
              en: attendencecount + 'Employees'
            }"
          ></div>
        </div>
        <div
          *ngIf="userG?.userPrivileges.includes(151312)"
          class="rounded-2xl bg-white shadow-lg flex items-center py-3 px-5 flex-col gap-3"
          (click)="open(AbsenceModal, 'lg')"
          style="cursor: pointer"
        >
          <img class="h-14" src="/assets/icons/close-outline@2x.png" alt="" />
          <span
            class="text-lg font-semi-bold"
            [translate]="'name'"
            [translateParams]="{
              ar: 'الغائبون',
              en: 'Absence'
            }"
          >
          </span>
          <div
            class="py-2 px-3 bg-green-100 text-green-600 rounded-full"
            [translate]="'name'"
            [translateParams]="{
              ar: absenteecount + ' موظف',
              en: absenteecount + ' Employees'
            }"
          ></div>
        </div>
        <div
          *ngIf="userG?.userPrivileges.includes(151313)"
          class="rounded-2xl bg-white shadow-lg flex items-center py-3 px-5 flex-col gap-3"
          (click)="open(LateModal, 'lg')"
          style="cursor: pointer"
        >
          <img class="h-14" src="/assets/icons/stop-circle@2x.png" alt="" />
          <span
            class="text-lg font-semi-bold"
            [translate]="'name'"
            [translateParams]="{
              ar: 'المتأخرون',
              en: 'Late'
            }"
          >
          </span>
          <div
            class="py-2 px-3 bg-zinc-100 text-zinc-600 rounded-full"
            [translate]="'name'"
            [translateParams]="{
              ar: datalatecount + 'موظف',
              en: datalatecount + 'Employees'
            }"
          ></div>
        </div>
        <div
          *ngIf="userG?.userPrivileges.includes(151314)"
          class="rounded-2xl bg-white shadow-lg flex items-center py-3 px-5 flex-col gap-3"
        >
          <img
            class="h-14"
            src="/assets/icons/lightbulb-outline-badged@2x.png"
            alt=""
          />
          <span
            class="text-lg font-semi-bold"
            [translate]="'name'"
            [translateParams]="{
              ar: 'المستأذنون',
              en: 'Authorized'
            }"
          >
          </span>
          <div
            class="py-2 px-3 bg-red-100 text-red-600 rounded-full"
            [translate]="'name'"
            [translateParams]="{
              ar: NotlogoutCount + 'موظف',
              en: NotlogoutCount + 'Employees'
            }"
          ></div>
        </div>
        <div
          *ngIf="userG?.userPrivileges.includes(151315)"
          (click)="
            open(followVacationsModal, null, null, null, 'vacationadmin')
          "
          class="rounded-2xl bg-white shadow-lg flex items-center py-3 px-5 flex-col gap-3"
        >
          <img
            class="h-14"
            src="/assets/icons/on-howliday-line@2x.png"
            alt=""
          />
          <span
            class="text-lg font-semi-bold"
            [translate]="'name'"
            [translateParams]="{
              ar: 'طلبات الاجازه',
              en: 'Holiday requests'
            }"
          >
          </span>
          <div
            class="py-2 px-3 bg-orange-100 text-orange-600 rounded-full"
            [translate]="'name'"
            [translateParams]="{
              ar: waitingvacationcount + 'موظف',
              en: waitingvacationcount + 'Employees'
            }"
          ></div>
        </div>
        <div
          *ngIf="userG?.userPrivileges.includes(151316)"
          (click)="open(followLoanModal, null, null, null, 'admin')"
          class="rounded-2xl bg-white shadow-lg flex items-center py-3 px-5 flex-col gap-3"
        >
          <img class="h-14" src="/assets/icons/mozneybag@2x.png" alt="" />
          <span
            class="text-lg font-semi-bold"
            [translate]="'name'"
            [translateParams]="{
              ar: 'طلبات السلف',
              en: 'Loan requests'
            }"
          >
          </span>
          <div
            class="py-2 px-3 bg-emerald-100 text-emerald-600 rounded-full"
            [translate]="'name'"
            [translateParams]="{
              ar: waitingimpresetcount + 'موظف',
              en: waitingimpresetcount + 'Employees'
            }"
          ></div>
        </div>
      </div>

      <mat-tab-group [dir]="'dir' | translate">
        <mat-tab *ngIf="userG?.userPrivileges.includes(151317)">
          <ng-template mat-tab-label>
            <span>
              {{ "Identities are about to expire" | translate }}
            </span>
            <span
              class="aspect-square w-8 border-2 border-white end-4 -translate-y-1/2 p-1 rounded-full text-center bg-orange-500 text-white absolute top-0"
            >
              {{ totalcountResidentAboutToExpire }}
            </span>
          </ng-template>
          <div>
            <div class="flex gap-2 flex-wrap items-center justify-between my-3">
              <div class="fix-drp flex gap-2 flex-wrap items-end w-100">
                <div>
                  <label class="col-form-label">
                    {{ "Sort by department" | translate }}</label
                  >

                  <ng-select
                    class="w-full p-0"
                    placeholder="{{ 'Chose' | translate }}"
                    (change)="GetResDencesAbouutToExpire_paging(1, 10)"
                    [(ngModel)]="ResDencesAbouutToExpireDepartment"
                    [ngModelOptions]="{ standalone: true }"
                    [dropdownPosition]="'bottom'"
                  >
                    <ng-option
                      *ngFor="let item of departments"
                      [value]="item.id"
                      >{{ item.name }}</ng-option
                    >
                  </ng-select>
                </div>

                <div>
                  <label class="col-form-label">
                    {{ "Search" | translate }}</label
                  >

                  <input
                    #ResDencesAbouutToExpire
                    (keyup)="GetResDencesAbouutToExpire_paging(1, 10)"
                    type="text"
                    class="form-control"
                    name="searchtextResidentAboutToExpire"
                    [(ngModel)]="searchtextResidentAboutToExpire"
                  />
                </div>

                <button
                  mat-raised-button
                  class="bg-base text-white mx-2"
                  (click)="printdashboard(1, ResDencesAbouutToExpireDepartment)"
                >
                  {{ "Print" | translate }}
                </button>
                <div class="form-check form-switch position-relative mb-2">
                  <input
                    class="form-check-input position-absolute me-0"
                    type="checkbox"
                    role="switch"
                    [(ngModel)]="ResidentAboutToExpirert"
                    id="flexSwitchCheckDefault"
                    (change)="GetResDencesAbouutToExpire_paging(1, 10)"
                  />

                  <label
                    class="form-check-label position-absolute me-5"
                    for="flexSwitchCheckDefault"
                    style="width: max-content"
                  >
                    {{
                      "Show the identities closest to ending first" | translate
                    }}
                  </label>
                </div>
              </div>
            </div>
            <div class="overflow-hidden">
              <div class="overflow-auto">
                <table
                  #tasksSort
                  mat-table
                  [dataSource]="EmpManagement.ResidentAboutToExpire"
                  matSort
                  class="mat-elevation-z8 rounded-t-lg overflow-hidden w-max"
                >
                  <ng-container matColumnDef="EmployeeName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Employee Name" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.nameAr }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="Nationality">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Nationality" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.nationality }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="IDNumber">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "ID Number" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.nationalId }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="department">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "department" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.department }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="Branch">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Branch" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.branch }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="JobName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Job Name" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.jobName }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="EndDate">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "End Date" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.nationalIdEndDate }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="dateReminder">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "date reminder" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.notifiDate }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="ContractExpiryDate">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Contract expiry date" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.contractEndDate }}
                    </td>
                  </ng-container>

                  <tr
                    mat-header-row
                    *matHeaderRowDef="columns1.IdentitiesExpire"
                  ></tr>

                  <tr
                    mat-row
                    *matRowDef="let row; columns: columns1.IdentitiesExpire"
                    class="duration-300 hover:bg-slate-100"
                  ></tr>
                  <!-- Row shown when there is no matching data. -->
                  <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell" colspan="4">
                      {{ "No result found for " }} 
                    </td>
                  </tr>
                </table>
              </div>

              <mat-paginator
                #paginatorOfficialDocAboutToExpire
                [length]="totalcountResidentAboutToExpire"
                (page)="onPageChange_ResidentAboutToExpire($event)"
                [pageSizeOptions]="[10, 25, 100]"
              >
              </mat-paginator>
            </div>
          </div>
        </mat-tab>

        <mat-tab *ngIf="userG?.userPrivileges.includes(151318)">
          <ng-template mat-tab-label>
            <span>
              {{ "Expired identities" | translate }}
            </span>
            <span
              class="aspect-square w-8 border-2 border-white end-4 -translate-y-1/2 p-1 rounded-full text-center bg-orange-500 text-white absolute top-0"
            >
              {{ totalcountResidentExpired }}
            </span>
          </ng-template>
          <div>
            <div class="flex gap-2 flex-wrap items-center justify-between my-3">
              <div class="flex gap-2 flex-wrap items-end w-100">
                <div>
                  <label class="col-form-label">
                    {{ "Sort by department" | translate }}</label
                  >
                  <ng-select
                    class="w-full p-0"
                    placeholder="{{ 'Chose' | translate }}"
                    (change)="GetResDencesExpired_paging(1, 10)"
                    [(ngModel)]="ResidentExpiredDepartment"
                    [ngModelOptions]="{ standalone: true }"
                    [dropdownPosition]="'bottom'"
                  >
                    <ng-option
                      *ngFor="let item of departments"
                      [value]="item.id"
                      >{{ item.name }}</ng-option
                    >
                  </ng-select>
                </div>

                <div>
                  <label class="col-form-label">
                    {{ "Search" | translate }}</label
                  >

                  <input
                    #ResidentExpired
                    (keyup)="GetResDencesExpired_paging(1, 10)"
                    type="text"
                    class="form-control"
                    name="searchtextResidentExpired"
                    [(ngModel)]="searchtextResidentExpired"
                  />
                </div>

                <button
                  mat-raised-button
                  class="bg-base text-white mx-2"
                  (click)="printdashboard(2, ResidentExpiredDepartment)"
                >
                  {{ "Print" | translate }}
                </button>
              </div>
            </div>
            <div class="overflow-hidden">
              <div class="overflow-auto">
                <table
                  #tasksSort
                  mat-table
                  [dataSource]="EmpManagement.ResidentExpired"
                  matSort
                  class="mat-elevation-z8 rounded-t-lg overflow-hidden w-max"
                >
                  <ng-container matColumnDef="EmployeeName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Employee Name" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.nameAr }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="Nationality">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Nationality" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.nationality }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="IDNumber">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "ID Number" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.nationalId }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="EndDate">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "End Date" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.nationalIdEndDate }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="JobName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Job Name" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.jobName }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="department">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "department" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.department }}
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="DirectManager">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Direct manager" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.directManager }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="Branch">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Branch" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.branch }}
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="ContractExpiryDate">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Contract expiry date" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.contractEndDate }}
                    </td>
                  </ng-container>

                  <tr
                    mat-header-row
                    *matHeaderRowDef="columns1.IdentitiesIsExpired"
                  ></tr>

                  <tr
                    mat-row
                    *matRowDef="let row; columns: columns1.IdentitiesIsExpired"
                    class="duration-300 hover:bg-slate-100"
                  ></tr>
                  <!-- Row shown when there is no matching data. -->
                  <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell" colspan="4">
                      {{ "No result found for " }} 
                    </td>
                  </tr>
                </table>
              </div>

              <mat-paginator
                #paginatorResidentExpired
                [length]="totalcountResidentExpired"
                (page)="onPageChange_ResidentExpired($event)"
                [pageSizeOptions]="[10, 25, 100]"
              >
              </mat-paginator>
            </div>
          </div>
        </mat-tab>

        <mat-tab *ngIf="userG?.userPrivileges.includes(151319)">
          <ng-template mat-tab-label>
            <span>
              {{ "Documents nearing completion" | translate }}
            </span>
            <span
              class="aspect-square w-8 border-2 border-white end-4 -translate-y-1/2 p-1 rounded-full text-center bg-orange-500 text-white absolute top-0"
            >
              {{ totalcountOfficialDocAboutToExpire }}
            </span>
          </ng-template>
          <div>
            <div class="flex gap-2 flex-wrap items-center justify-between my-3">
              <div class="fix-drp flex gap-2 flex-wrap items-end w-100">
                <div>
                  <label class="col-form-label">
                    {{ "Sort by department" | translate }}</label
                  >
                  <ng-select
                    class="w-full p-0"
                    placeholder="{{ 'Chose' | translate }}"
                    (change)="GetOfficialDocsAboutToExpire_paging(1, 10)"
                    [(ngModel)]="OfficialDocAboutToExpireDepartment"
                    [ngModelOptions]="{ standalone: true }"
                    [dropdownPosition]="'bottom'"
                  >
                    <ng-option
                      *ngFor="let item of departments"
                      [value]="item.id"
                      >{{ item.name }}</ng-option
                    >
                  </ng-select>
                </div>

                <div>
                  <label class="col-form-label">
                    {{ "Search" | translate }}</label
                  >

                  <input
                    #OfficialDocAboutToExpire
                    (keyup)="GetOfficialDocsAboutToExpire_paging(1, 10)"
                    type="text"
                    class="form-control"
                    name="searchtextOfficialDocAboutToExpire"
                    [(ngModel)]="searchtextOfficialDocAboutToExpire"
                  />
                </div>
                <button
                  mat-raised-button
                  class="bg-base text-white mx-2"
                  (click)="
                    printdashboard(3, OfficialDocAboutToExpireDepartment)
                  "
                >
                  {{ "Print" | translate }}
                </button>

                <div class="form-check form-switch position-relative mb-2">
                  <input
                    class="form-check-input position-absolute me-0"
                    type="checkbox"
                    role="switch"
                    [(ngModel)]="OfficialDocAboutToExpiresort"
                    id="flexSwitchCheckDefault"
                    (change)="GetOfficialDocsAboutToExpire_paging(1, 10)"
                  />

                  <label
                    class="form-check-label position-absolute me-5"
                    for="flexSwitchCheckDefault"
                    style="width: max-content"
                  >
                    {{
                      "Show documents to the nearest expiry date first"
                        | translate
                    }}
                  </label>
                </div>
              </div>
            </div>
            <div class="overflow-hidden">
              <div class="overflow-auto">
                <table
                  #tasksSort
                  mat-table
                  [dataSource]="EmpManagement.OfficialDocAboutToExpire"
                  matSort
                  class="mat-elevation-z8 rounded-t-lg overflow-hidden w-max"
                >
                  <ng-container matColumnDef="DocumentName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "DocumentName" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.nameAr }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="DocumentNumber">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "DocumentNumber" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.number }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="Issuer">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Issuer" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.docSource }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="EndDate">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "End Date" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.expiredDate }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="AlertDate">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Alert date" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.notifiDate }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="Branch">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Branch" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.branch }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="reminderText">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "reminder text" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.notes }}
                    </td>
                  </ng-container>

                  <tr
                    mat-header-row
                    *matHeaderRowDef="columns1.DocumentsNearComplete"
                  ></tr>

                  <tr
                    mat-row
                    *matRowDef="
                      let row;
                      columns: columns1.DocumentsNearComplete
                    "
                    class="duration-300 hover:bg-slate-100"
                  ></tr>
                  <!-- Row shown when there is no matching data. -->
                  <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell" colspan="4">
                      {{ "No result found for " }} 
                    </td>
                  </tr>
                </table>
              </div>

              <mat-paginator
                #paginatorOfficialDocAboutToExpire
                [length]="totalcountOfficialDocAboutToExpire"
                (page)="onPageChange_OfficialDocAboutToExpire($event)"
                [pageSizeOptions]="[10, 25, 100]"
              >
              </mat-paginator>
            </div>
          </div>
        </mat-tab>

        <mat-tab *ngIf="userG?.userPrivileges.includes(151320)">
          <ng-template mat-tab-label>
            <span>
              {{ "expired documents" | translate }}
            </span>
            <span
              class="aspect-square w-8 border-2 border-white end-4 -translate-y-1/2 p-1 rounded-full text-center bg-orange-500 text-white absolute top-0"
            >
              {{ totalcountOOfficialDocExpired }}
            </span>
          </ng-template>
          <div>
            <div class="flex gap-2 flex-wrap items-center justify-between my-3">
              <div class="fix-drp flex gap-2 flex-wrap items-end w-100">
                <div>
                  <label class="col-form-label">
                    {{ "Sort by department" | translate }}</label
                  >
                  <ng-select
                    class="w-full p-0"
                    placeholder="{{ 'Chose' | translate }}"
                    (change)="GetOfficialDocsExpired_paging(1, 10)"
                    [(ngModel)]="OfficialDocExpiredDepartment"
                    [ngModelOptions]="{ standalone: true }"
                    [dropdownPosition]="'bottom'"
                  >
                    <ng-option
                      *ngFor="let item of departments"
                      [value]="item.id"
                      >{{ item.name }}</ng-option
                    >
                  </ng-select>
                </div>

                <div>
                  <label class="col-form-label">
                    {{ "Search" | translate }}</label
                  >

                  <input
                    #OfficialDocExpired
                    (keyup)="GetOfficialDocsExpired_paging(1, 10)"
                    type="text"
                    class="form-control"
                    name="searchtextOfficialDocExpired"
                    [(ngModel)]="searchtextOfficialDocExpired"
                  />
                </div>

                <button
                  mat-raised-button
                  class="bg-base text-white mx-2"
                  (click)="printdashboard(4, OfficialDocExpiredDepartment)"
                >
                  {{ "Print" | translate }}
                </button>
              </div>
            </div>
            <div class="overflow-hidden">
              <div class="overflow-auto">
                <table
                  #tasksSort
                  mat-table
                  [dataSource]="EmpManagement.OfficialDocExpired"
                  matSort
                  class="mat-elevation-z8 rounded-t-lg overflow-hidden w-max"
                >
                  <ng-container matColumnDef="DocumentName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "DocumentName" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.nameAr }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="DocumentNumber">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "DocumentNumber" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.number }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="Issuer">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Issuer" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.docSource }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="EndDate">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "End Date" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.expiredDate }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="Branch">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Branch" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.branch }}
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="Attachments">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Attachments" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      <!-- {{ element.attachmentUrl }} -->
                      <button
                        *ngIf="element.attachmentUrl"
                        (click)="downloadFile(element.attachmentUrl)"
                        class="min-w-max p-2 bg-sky-100 hover:bg-sky-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
                      >
                        <i class="fa-solid fa-eye"></i>
                      </button>
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="reminderText">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "reminder text" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.notes }}
                    </td>
                  </ng-container>

                  <tr
                    mat-header-row
                    *matHeaderRowDef="columns1.ExpiredDocuments"
                  ></tr>

                  <tr
                    mat-row
                    *matRowDef="let row; columns: columns1.ExpiredDocuments"
                    class="duration-300 hover:bg-slate-100"
                  ></tr>
                  <!-- Row shown when there is no matching data. -->
                  <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell" colspan="4">
                      {{ "No result found for " }} 
                    </td>
                  </tr>
                </table>
              </div>

              <mat-paginator
                #paginatorOfficialDocExpired
                [length]="totalcountOOfficialDocExpired"
                (page)="onPageChange_OfficialDocExpired($event)"
                [pageSizeOptions]="[10, 25, 100]"
              >
              </mat-paginator>
            </div>
          </div>
        </mat-tab>
        <mat-tab *ngIf="userG?.userPrivileges.includes(151321)">
          <ng-template mat-tab-label>
            <span>
              {{ "Employee contracts are about to expire" | translate }}
            </span>
            <span
              class="aspect-square w-8 border-2 border-white end-4 -translate-y-1/2 p-1 rounded-full text-center bg-orange-500 text-white absolute top-0"
            >
              {{ totalcountContractAboutToExpired }}
            </span>
          </ng-template>
          <div>
            <div class="flex gap-2 flex-wrap items-center justify-between my-3">
              <div class="fix-drp flex gap-2 flex-wrap items-end w-100">
                <div>
                  <label class="col-form-label">
                    {{ "Sort by department" | translate }}</label
                  >
                  <ng-select
                    class="w-full p-0"
                    placeholder="{{ 'Chose' | translate }}"
                    (change)="GetEmpContractsAboutToExpire_paging(1, 10)"
                    [(ngModel)]="ContractAboutToExpiredDepartment"
                    [ngModelOptions]="{ standalone: true }"
                    [dropdownPosition]="'bottom'"
                  >
                    <ng-option
                      *ngFor="let item of departments"
                      [value]="item.id"
                      >{{ item.name }}</ng-option
                    >
                  </ng-select>
                </div>

                <div>
                  <label class="col-form-label">
                    {{ "Search" | translate }}</label
                  >

                  <input
                    #SaleinvoicesInput
                    (keyup)="GetEmpContractsAboutToExpire_paging(1, 10)"
                    type="text"
                    class="form-control"
                    name="searchtextContractAboutToExpired"
                    [(ngModel)]="searchtextContractAboutToExpired"
                  />
                </div>
                <button
                  mat-raised-button
                  class="bg-base text-white mx-2"
                  (click)="printdashboard(5, ContractAboutToExpiredDepartment)"
                >
                  {{ "Print" | translate }}
                </button>
                <div class="form-check form-switch position-relative mb-2">
                  <input
                    class="form-check-input position-absolute me-0"
                    type="checkbox"
                    role="switch"
                    [(ngModel)]="ContractAboutToExpiredsort"
                    id="flexSwitchCheckDefault"
                    (change)="GetEmpContractsAboutToExpire_paging(1, 10)"
                  />

                  <label
                    class="form-check-label position-absolute me-5"
                    for="flexSwitchCheckDefault"
                    style="width: max-content"
                  >
                    {{
                      "Show contracts for the nearest expiry date" | translate
                    }}
                  </label>
                </div>
              </div>
            </div>
            <div class="overflow-hidden">
              <div class="overflow-auto">
                <table
                  #tasksSort
                  mat-table
                  [dataSource]="EmpManagement.ContractAboutToExpired"
                  matSort
                  class="mat-elevation-z8 rounded-t-lg overflow-hidden w-max"
                >
                  <ng-container matColumnDef="EmployeeName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Employee Name" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.nameAr }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="Nationality">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Nationality" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.nationality }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="JobName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Job Name" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.jobName }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="department">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "department" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.department }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="Branch">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Branch" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.branch }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="serviceDuration">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Length of service" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.duration }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="Salary">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Salary" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.salary }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="ContractExpiryDate">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Contract expiry date" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.contractEndDate }}
                    </td>
                  </ng-container>

                  <tr
                    mat-header-row
                    *matHeaderRowDef="columns1.ContractsNearComplete"
                  ></tr>

                  <tr
                    mat-row
                    *matRowDef="
                      let row;
                      columns: columns1.ContractsNearComplete
                    "
                    class="duration-300 hover:bg-slate-100"
                  ></tr>
                  <!-- Row shown when there is no matching data. -->
                  <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell" colspan="4">
                      {{ "No result found for " }} 
                    </td>
                  </tr>
                </table>
              </div>

              <mat-paginator
                #paginatorContractAboutToExpired
                [length]="totalcountContractAboutToExpired"
                (page)="onPageChange_ContractAboutToExpired($event)"
                [pageSizeOptions]="[10, 25, 100]"
              >
              </mat-paginator>
            </div>
          </div>
        </mat-tab>
        <mat-tab *ngIf="userG?.userPrivileges.includes(151322)">
          <ng-template mat-tab-label>
            <span>
              {{ "Expired employee contracts" | translate }}
            </span>
            <span
              class="aspect-square w-8 border-2 border-white end-4 -translate-y-1/2 p-1 rounded-full text-center bg-orange-500 text-white absolute top-0"
            >
              {{ totalcountContractExpired }}
            </span>
          </ng-template>
          <div>
            <div class="flex gap-2 flex-wrap items-center justify-between my-3">
              <div class="fix-drp flex gap-2 flex-wrap items-end w-100">
                <div>
                  <label class="col-form-label">
                    {{ "Sort by department" | translate }}</label
                  >
                  <ng-select
                    class="w-full p-0"
                    placeholder="{{ 'Chose' | translate }}"
                    (change)="GetEmpContractsExpired_paging(1, 10)"
                    [(ngModel)]="ContractExpiredDepartment"
                    [ngModelOptions]="{ standalone: true }"
                    [dropdownPosition]="'bottom'"
                  >
                    <ng-option
                      *ngFor="let item of departments"
                      [value]="item.id"
                      >{{ item.name }}</ng-option
                    >
                  </ng-select>
                </div>

                <div>
                  <label class="col-form-label">
                    {{ "Search" | translate }}</label
                  >

                  <input
                    #SaleinvoicesInput
                    (keyup)="GetEmpContractsExpired_paging(1, 10)"
                    type="text"
                    class="form-control"
                    name="searchtextContractExpired"
                    [(ngModel)]="searchtextContractExpired"
                  />
                </div>
                <button
                  mat-raised-button
                  class="bg-base text-white mx-2"
                  (click)="printdashboard(9, ContractExpiredDepartment)"
                >
                  {{ "Print" | translate }}
                </button>
              </div>
            </div>
            <div class="overflow-hidden">
              <div class="overflow-auto">
                <table
                  #tasksSort
                  mat-table
                  [dataSource]="EmpManagement.ContractExpired"
                  matSort
                  class="mat-elevation-z8 rounded-t-lg overflow-hidden w-max"
                >
                  <ng-container matColumnDef="contractNumber">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "contract number" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.contractNo }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="EmployeeName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Employee Name" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.nameAr }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="Nationality">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Nationality" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.nationality }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="JobName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Job Name" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.jobName }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="department">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "department" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.department }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="Branch">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Branch" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.branch }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="serviceDuration">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Length of service" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.duration }}
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="ContractExpiryDate">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Contract expiry date" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.contractEndDate }}
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="Salary">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Salary" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.salary }}
                    </td>
                  </ng-container>

                  <tr
                    mat-header-row
                    *matHeaderRowDef="columns1.ExpiredContracts"
                  ></tr>

                  <tr
                    mat-row
                    *matRowDef="let row; columns: columns1.ExpiredContracts"
                    class="duration-300 hover:bg-slate-100"
                  ></tr>
                  <!-- Row shown when there is no matching data. -->
                  <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell" colspan="4">
                      {{ "No result found for " }} 
                    </td>
                  </tr>
                </table>
              </div>

              <mat-paginator
                #paginatorContractExpired
                [length]="totalcountContractExpired"
                (page)="onPageChange_ContractExpired($event)"
                [pageSizeOptions]="[10, 25, 100]"
              >
              </mat-paginator>
            </div>
          </div>
        </mat-tab>
        <mat-tab *ngIf="userG?.userPrivileges.includes(151323)">
          <ng-template mat-tab-label>
            <span>
              {{ "Employees without contracts" | translate }}
            </span>
            <span
              class="aspect-square w-8 border-2 border-white end-4 -translate-y-1/2 p-1 rounded-full text-center bg-orange-500 text-white absolute top-0"
            >
              {{ totalcountEmployeeWithoutContract }}
            </span>
          </ng-template>
          <div>
            <div class="flex gap-2 flex-wrap items-center justify-between my-3">
              <div class="fix-drp flex gap-2 flex-wrap items-end w-100">
                <div>
                  <label class="col-form-label">
                    {{ "Sort by department" | translate }}</label
                  >
                  <ng-select
                    class="w-full p-0"
                    placeholder="{{ 'Chose' | translate }}"
                    (change)="GetEmployeesWithoutContract_paging(1, 10)"
                    [(ngModel)]="EmployeeswithoutcontractDepartment"
                    [ngModelOptions]="{ standalone: true }"
                    [dropdownPosition]="'bottom'"
                  >
                    <ng-option
                      *ngFor="let item of departments"
                      [value]="item.id"
                      >{{ item.name }}</ng-option
                    >
                  </ng-select>
                </div>

                <div>
                  <label class="col-form-label">
                    {{ "Search" | translate }}</label
                  >

                  <input
                    #EmployeeWithoutContract
                    (keyup)="GetEmployeesWithoutContract_paging(1, 10)"
                    type="text"
                    class="form-control"
                    name="searchtextEmployeeWithoutContract"
                    [(ngModel)]="searchtextEmployeeWithoutContract"
                  />
                </div>
                <button
                  mat-raised-button
                  class="bg-base text-white mx-2"
                  (click)="
                    printdashboard(10, EmployeeswithoutcontractDepartment)
                  "
                >
                  {{ "Print" | translate }}
                </button>
              </div>
            </div>
            <div class="overflow-hidden">
              <div class="overflow-auto">
                <table
                  #tasksSort
                  mat-table
                  [dataSource]="EmpManagement.EmployeeWithoutContract"
                  matSort
                  class="mat-elevation-z8 rounded-t-lg overflow-hidden w-max"
                >
                  <ng-container matColumnDef="EmployeeName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Employee Name" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.employeeName }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="Nationality">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Nationality" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.nationalityName }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="JobName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Job Name" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.jobName }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="department">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "department" | translate }} </span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.departmentName }}
                    </td>
                  </ng-container>
                  <ng-container matColumnDef="Branch">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Branch" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.branchName }}
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="MobileNumber">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Mobile Number" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.mobile }}
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="Email">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "Email" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.email }}
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="IDNumber">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      <span>{{ "ID Number" | translate }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.nationalId }}
                    </td>
                  </ng-container>

                  <tr
                    mat-header-row
                    *matHeaderRowDef="columns1.employeeWithoutContract"
                  ></tr>

                  <tr
                    mat-row
                    *matRowDef="
                      let row;
                      columns: columns1.employeeWithoutContract
                    "
                    class="duration-300 hover:bg-slate-100"
                  ></tr>
                  <!-- Row shown when there is no matching data. -->
                  <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell" colspan="4">
                      {{ "No result found for " }}
                    </td>
                  </tr>
                </table>
              </div>

              <mat-paginator
                #paginatorEmployeeWithoutContract
                [length]="totalcountEmployeeWithoutContract"
                (page)="onPageChange_EmployeeWithoutContract($event)"
                [pageSizeOptions]="[10, 25, 100]"
              >
              </mat-paginator>
            </div>
          </div>
        </mat-tab>
      </mat-tab-group>
    </div>
    <div
      class="max-h-100 overflow-x-scroll overflow-y-scroll p-4"
      id="reportaccountingentryModal"
      [ngStyle]="{ direction: lang == 'ar' ? 'rtl' : 'ltr' }"
      style="position: absolute"
    >
      <!--Header-->
      <div
        class="report-header"
        style="
          display: flex;
          align-items: center;
          gap: 100px;
          padding: 3px 0px;
          margin-bottom: 20px;
        "
      >
        <div class="headerNe-right-side">
          <img
            src="{{ environmentPho }}"
            alt="logo"
            style="
              height: 200px;
              width: 200px;
              max-width: 200px;
              object-fit: fill;
            "
          />
        </div>

        <div class="headerNe-lefy-side" style="width: 100%">
          <h1
            style="
              letter-spacing: 0.25px;
              font-size: 23px;
              margin: 0;
              margin-bottom: 5px;
            "
          >
            {{ OrganizationData?.nameAr }}
          </h1>
          <h1
            style="
              letter-spacing: 0.25px;
              font-size: 23px;
              margin: 0;
              margin-bottom: 5px;
            "
          >
            {{ OrganizationData?.nameEn }}
          </h1>
          <h1
            style="
              margin-bottom: 0;
              font-size: 34px;
              color: #0c8191;
              margin-bottom: 0;
              margin-top: 30px;
              font-weight: 500;
              display: flex;
              justify-content: center;
            "
          >
            {{ "View_accounting_entry" | translate }}
          </h1>
        </div>
      </div>
      <!--/Header-->

      <div style="margin-bottom: 10px">
        <p>
          <span
            [translate]="'name'"
            [translateParams]="{
              ar: 'التاريخ: ',
              en: 'Date: '
            }"
          ></span>
          <span> {{ datePrintJournals | date }} </span>
        </p>
      </div>

      <table
        class="border border-gray-500"
        style="width: 100%; text-align: center"
      >
        <thead>
          <tr>
            <th class="w-1/9 px-1 border py-2">{{ "date" | translate }}</th>
            <th class="w-1/9 px-1 border py-2">
              {{ "Bond number" | translate }}
            </th>
            <th class="w-1/9 px-1 border py-2">
              {{ "Bond type" | translate }}
            </th>
            <th class="w-1/9 px-1 border py-2">
              {{ "Registration number" | translate }}
            </th>
            <th class="w-1/9 px-1 border py-2">
              {{ "account code" | translate }}
            </th>
            <th class="w-1/9 px-1 border py-2">
              {{ "account name" | translate }}
            </th>
            <th class="w-1/9 px-1 border py-2">
              {{ "Statement" | translate }}
            </th>
            <th class="w-1/9 px-1 border py-2">{{ "debtor" | translate }}</th>
            <th class="w-1/9 px-1 border py-2">{{ "Creditor" | translate }}</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let entry of FilterLoadData.AllJournalEntries">
            <td class="w-1/9 border px-1 py-2">{{ entry.transactionDate }}</td>
            <td class="w-1/9 border px-1 py-2">{{ entry.invoiceNumber }}</td>
            <td class="w-1/9 border px-1 py-2">{{ entry.typeName }}</td>
            <td class="w-1/9 border px-1 py-2">{{ entry.journalNo }}</td>
            <td class="w-1/9 border px-1 py-2">{{ entry.accountCode }}</td>
            <td class="w-1/9 border px-1 py-2">{{ entry.accountName }}</td>
            <td class="w-1/9 border px-1 py-2">{{ entry.notes }}</td>
            <td class="w-1/9 border px-1 py-2">{{ entry.depit }}</td>
            <td class="w-1/9 border px-1 py-2">{{ entry.credit }}</td>
          </tr>
          <tr>
            <td class="w-1/9 border px-1 py-2">{{ "total" | translate }}</td>
            <td class="w-1/9 border px-1 py-2"></td>
            <td class="w-1/9 border px-1 py-2"></td>
            <td class="w-1/9 border px-1 py-2"></td>
            <td class="w-1/9 border px-1 py-2"></td>
            <td class="w-1/9 border px-1 py-2"></td>
            <td class="w-1/9 border px-1 py-2"></td>
            <td class="w-1/9 border px-1 py-2 bg-green-500">
              {{ totaldepit }}
            </td>
            <td class="w-1/9 border px-1 py-2 bg-red-500">{{ totalcredit }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- متابعة الاداء العام -->
  <div class="shaped-tab box follow-tabs" style="display: none">
    <div class="header">
      <span
        [translate]="'name'"
        [translateParams]="{
          ar: 'متابعة الاداء العام',
          en: 'Flow-up on puplic preformance'
        }"
      ></span>
      <button (click)="preformanceTab = !preformanceTab">
        <i class="fa-solid fa-bars"></i>
      </button>
    </div>

    <div *ngIf="preformanceTab" [@collapse]="!preformanceTab">
      <div class="mt-3 mb-4" style="max-width: 300px">
        <div class="form-group">
          <ng-select
            name="costCenter"
            class="w-full p-0"
            placeholder="{{ 'Chose' | translate }}"
            [(ngModel)]="selectedDate3"
            [ngModelOptions]="{ standalone: true }"
          >
            <ng-option
              *ngFor="let date of dates"
              [value]="date.id"
              [translate]="'name'"
              [translateParams]="{ ar: date?.name?.ar, en: date?.name?.en }"
            >
            </ng-option>
          </ng-select>
        </div>
      </div>

      <div class="flex gap-3 flex-wrap follow-btns my-3">
        <button
          (click)="employeeType = 1"
          class="btn {{ employeeType == 1 ? 'btn-primary' : '' }}"
          [translate]="'name'"
          [translateParams]="{
            ar: 'الاكثراكمال للمشاريع',
            en: 'Most Completed projects'
          }"
        ></button>
        <button
          (click)="employeeType = 2"
          class="btn {{ employeeType == 2 ? 'btn-primary' : '' }}"
          [translate]="'name'"
          [translateParams]="{
            ar: 'الاكثر انجازا للمهام',
            en: 'Most accomplished tasks'
          }"
        ></button>
        <button
          (click)="employeeType = 3"
          class="btn {{ employeeType == 3 ? 'btn-primary' : '' }}"
          [translate]="'name'"
          [translateParams]="{
            ar: 'الاكثر تاخير للمشاريع',
            en: 'Most dalayed projects'
          }"
        ></button>
        <button
          (click)="employeeType = 4"
          class="btn {{ employeeType == 4 ? 'btn-primary' : '' }}"
          [translate]="'name'"
          [translateParams]="{
            ar: 'الاكثر تاخير للمهام',
            en: 'Most dalayed tasks'
          }"
        ></button>
        <button
          (click)="employeeType = 5"
          class="btn {{ employeeType == 5 ? 'btn-primary' : '' }}"
          [translate]="'name'"
          [translateParams]="{
            ar: 'الاكثر غيابا',
            en: 'Most absence'
          }"
        ></button>
        <button
          (click)="employeeType = 6"
          class="btn {{ employeeType == 6 ? 'btn-primary' : '' }}"
          [translate]="'name'"
          [translateParams]="{
            ar: 'الاكثر تاخير',
            en: 'Most delayed'
          }"
        ></button>
      </div>
      <div class="flex gap-4 flex-wrap my-3">
        <div
          class="shadow-md bg-white p-4 rounded-2xl flex gap-3 flex-col items-center user-box gap-3"
        >
          <img
            class="w-20 aspect-square rounded-full"
            src="assets/user-test.png"
            alt=""
          />
          <span>عبدالرحمن ياسر</span>
          <div
            class="flex items-center gap-2 rounded-full p-1 px-2 bg-blue-100 text-blue-600"
          >
            <img
              class="w-5"
              src="assets/icons/location-company@2x.png"
              alt=""
            />
            <span>مكه - السعودية</span>
          </div>
        </div>
        <div
          class="shadow-md bg-white p-4 rounded-2xl flex gap-3 flex-col items-center user-box gap-3"
        >
          <img
            class="w-20 aspect-square rounded-full"
            src="assets/user-test.png"
            alt=""
          />
          <span>عبدالرحمن ياسر</span>
          <div
            class="flex items-center gap-2 rounded-full p-1 px-2 bg-blue-100 text-blue-600"
          >
            <img
              class="w-5"
              src="assets/icons/location-company@2x.png"
              alt=""
            />
            <span>مكه - السعودية</span>
          </div>
        </div>
        <div
          class="shadow-md bg-white p-4 rounded-2xl flex gap-3 flex-col items-center user-box gap-3"
        >
          <img
            class="w-20 aspect-square rounded-full"
            src="assets/user-test.png"
            alt=""
          />
          <span>عبدالرحمن ياسر</span>
          <div
            class="flex items-center gap-2 rounded-full p-1 px-2 bg-blue-100 text-blue-600"
          >
            <img
              class="w-5"
              src="assets/icons/location-company@2x.png"
              alt=""
            />
            <span>مكه - السعودية</span>
          </div>
        </div>
        <div
          class="shadow-md bg-white p-4 rounded-2xl flex gap-3 flex-col items-center user-box gap-3"
        >
          <img
            class="w-20 aspect-square rounded-full"
            src="assets/user-test.png"
            alt=""
          />
          <span>عبدالرحمن ياسر</span>
          <div
            class="flex items-center gap-2 rounded-full p-1 px-2 bg-blue-100 text-blue-600"
          >
            <img
              class="w-5"
              src="assets/icons/location-company@2x.png"
              alt=""
            />
            <span>مكه - السعودية</span>
          </div>
        </div>
        <div
          class="shadow-md bg-white p-4 rounded-2xl flex gap-3 flex-col items-center user-box gap-3"
        >
          <img
            class="w-20 aspect-square rounded-full"
            src="assets/user-test.png"
            alt=""
          />
          <span>عبدالرحمن ياسر</span>
          <div
            class="flex items-center gap-2 rounded-full p-1 px-2 bg-blue-100 text-blue-600"
          >
            <img
              class="w-5"
              src="assets/icons/location-company@2x.png"
              alt=""
            />
            <span>مكه - السعودية</span>
          </div>
        </div>
        <div
          class="shadow-md bg-white p-4 rounded-2xl flex gap-3 flex-col items-center user-box gap-3"
        >
          <img
            class="w-20 aspect-square rounded-full"
            src="assets/user-test.png"
            alt=""
          />
          <span>عبدالرحمن ياسر</span>
          <div
            class="flex items-center gap-2 rounded-full p-1 px-2 bg-blue-100 text-blue-600"
          >
            <img
              class="w-5"
              src="assets/icons/location-company@2x.png"
              alt=""
            />
            <span>مكه - السعودية</span>
          </div>
        </div>
        <div
          class="shadow-md bg-white p-4 rounded-2xl flex gap-3 flex-col items-center user-box gap-3"
        >
          <img
            class="w-20 aspect-square rounded-full"
            src="assets/user-test.png"
            alt=""
          />
          <span>عبدالرحمن ياسر</span>
          <div
            class="flex items-center gap-2 rounded-full p-1 px-2 bg-blue-100 text-blue-600"
          >
            <img
              class="w-5"
              src="assets/icons/location-company@2x.png"
              alt=""
            />
            <span>مكه - السعودية</span>
          </div>
        </div>
        <div
          class="shadow-md bg-white p-4 rounded-2xl flex gap-3 flex-col items-center user-box gap-3"
        >
          <img
            class="w-20 aspect-square rounded-full"
            src="assets/user-test.png"
            alt=""
          />
          <span>عبدالرحمن ياسر</span>
          <div
            class="flex items-center gap-2 rounded-full p-1 px-2 bg-blue-100 text-blue-600"
          >
            <img
              class="w-5"
              src="assets/icons/location-company@2x.png"
              alt=""
            />
            <span>مكه - السعودية</span>
          </div>
        </div>
        <div
          class="shadow-md bg-white p-4 rounded-2xl flex gap-3 flex-col items-center user-box gap-3"
        >
          <img
            class="w-20 aspect-square rounded-full"
            src="assets/user-test.png"
            alt=""
          />
          <span>عبدالرحمن ياسر</span>
          <div
            class="flex items-center gap-2 rounded-full p-1 px-2 bg-blue-100 text-blue-600"
          >
            <img
              class="w-5"
              src="assets/icons/location-company@2x.png"
              alt=""
            />
            <span>مكه - السعودية</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- نسبة الانجاز -->
  <!-- <div class="shaped-tab box mb-5">
    <div class="header">
      <span
        [translate]="'name'"
        [translateParams]="{
          ar: 'نسبة الانجاز',
          en: 'Achivement progress ratio'
        }"
      ></span>
      <button (click)="progressTab = !progressTab">
        <i class="fa-solid fa-bars"></i>
      </button>
    </div>
    <div *ngIf="progressTab" [@collapse]="!progressTab">
      <div class="mt-3">
        <div
          class="font-semibold text-blue-600"
          [translate]="'name'"
          [translateParams]="{
            ar: 'نسبة تقدم انجاز المهام',
            en: 'Rate of progress of complation of tasks'
          }"
        ></div>
        <div class="flex gap-3 items-center">
          <div class="flex-grow relative my-3">
            <div
              class="absolute top-0 inset-0 bg-blue-100 rounded-full h-3 w-full"
            ></div>
            <div
              class="absolute top-0 inset-0 bg-blue-500 rounded-full h-3"
              [style]="'width: ' + dataPercent.tasksPercent + '%'"
            ></div>
          </div>
          <span class="w-14 text-blue-600 font-bold"
            >{{ dataPercent.tasksPercent }}%</span
          >
        </div>
      </div>
      <div class="mt-3">
        <div
          class="font-semibold text-blue-600"
          [translate]="'name'"
          [translateParams]="{
            ar: 'نسبة تقدم انجاز المهام الادارية',
            en: 'Rate of progress in accomplishing administrative tasks'
          }"
        ></div>
        <div class="flex gap-3 items-center">
          <div class="flex-grow relative my-3">
            <div
              class="absolute top-0 inset-0 bg-blue-100 rounded-full h-3 w-full"
            ></div>
            <div
              class="absolute top-0 inset-0 bg-green-500 rounded-full h-3"
              [style]="'width: ' + dataPercent.workOrdersPercent + '%'"
            ></div>
          </div>
          <span class="w-14 text-blue-600 font-bold"
            >{{ dataPercent.workOrdersPercent }}%</span
          >
        </div>
      </div>
      <div class="mt-3">
        <div
          class="font-semibold text-blue-600"
          [translate]="'name'"
          [translateParams]="{
            ar: 'نسبة تقدم انجاز مشاريعي',
            en: 'Rate of progress of project delivery'
          }"
        ></div>
        <div class="flex gap-3 items-center">
          <div class="flex-grow relative my-3">
            <div
              class="absolute top-0 inset-0 bg-blue-100 rounded-full h-3 w-full"
            ></div>
            <div
              class="absolute top-0 inset-0 bg-orange-500 rounded-full h-3"
              [style]="'width: ' + dataPercent.projectsPercent + '%'"
            ></div>
          </div>

          <span class="w-14 text-blue-600 font-bold"
            >{{ dataPercent.projectsPercent }}%</span
          >
        </div>
      </div>
      <div class="mt-3">
        <div
          class="font-semibold text-blue-600"
          [translate]="'name'"
          [translateParams]="{
            ar: 'نسبة الانجاز الكلي',
            en: 'Total complation ratio'
          }"
        ></div>
        <div class="flex gap-3 items-center">
          <div class="flex-grow relative my-3">
            <div
              class="absolute top-0 inset-0 bg-blue-100 rounded-full h-3 w-full"
            ></div>
            <div
              class="absolute top-0 inset-0 bg-zinc-500 rounded-full h-3"
              [style]="'width: ' + dataPercent.totalInProress + '%'"
            ></div>
          </div>
          <span class="w-14 text-blue-600 font-bold"
            >{{ dataPercent.totalInProress }}%</span
          >
        </div>
      </div>
      <div class="mt-3">
        <div
          class="font-semibold text-blue-600"
          [translate]="'name'"
          [translateParams]="{
            ar: 'نسبة التأخير الكلي',
            en: 'Retio of total delay'
          }"
        ></div>
        <div class="flex gap-3 items-center">
          <div class="flex-grow relative my-3">
            <div
              class="absolute top-0 inset-0 bg-blue-100 rounded-full h-3 w-full"
            ></div>
            <div
              class="absolute top-0 inset-0 bg-red-500 rounded-full h-3"
              [style]="'width: ' + dataPercent.totalLate + '%'"
            ></div>
          </div>
          <span class="w-14 text-blue-600 font-bold"
            >{{ dataPercent.totalLate }}%</span
          >
        </div>
      </div>
    </div>
  </div> -->

  <ng-template #projects let-modal>
    <div
      style="background-color: var(--base-color)"
      class="modal-header text-white flex justify-between items-center"
    >
      <h4 class="m-0">
        <span
          class="text-2xl"
          [translate]="'name'"
          [translateParams]="{
                     ar: 'مشاريعي',
      en: 'My projects',
                }"
        >
        </span>
      </h4>
      <button
        type="button"
        class="text-2xl text-white m-0"
        (click)="modal.dismiss()"
      >
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>
    <div class="modal-body">
      <app-projects></app-projects>
    </div>
    <div class="model-footer px-4 mb-3 flex justify-end">
      <button
        type="button"
        class="btn btn-outline-secondary"
        (click)="modal.dismiss()"
      >
        {{ "close" | translate }}
      </button>
    </div>
  </ng-template>

  <ng-template #AbsenceModal let-modal>
    <div
      style="background-color: var(--base-color)"
      class="modal-header text-white flex justify-between items-center"
    >
      <h4 class="m-0">
        <span
          class="text-2xl"
          [translate]="'name'"
          [translateParams]="{
                     ar: 'الغائبون',
      en: 'absentees',
                }"
        >
        </span>
      </h4>
      <button
        type="button"
        class="text-2xl text-white m-0"
        (click)="modal.dismiss()"
      >
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>
    <div class="modal-body">
      <div class="add-search pb-4">
        <app-navigator [title]="title"></app-navigator>

        <div class="tables-data mt-3 overflow-hidden">
          <div class="flex gap-2 flex-wrap items-end justify-between">
            <div class="flex gap-2 flex-wrap items-end">
              <div class="max-w-xs flex-grow">
                <label class="col-form-label">
                  {{ "Branch" | translate }}</label
                >
                <ng-select
                  #Brsearch
                  [items]="BranchSearch"
                  bindLabel="name"
                  bindValue="id"
                  [clearable]="true"
                  class="w-full p-0"
                  [(ngModel)]="absenteebranchid"
                  (ngModelChange)="getemployeereports()"
                  placeholder="{{ 'Chose' | translate }}"
                >
                </ng-select>
              </div>
              <div class="max-w-xs flex-grow">
                <label class="col-form-label">
                  {{ "Employee" | translate }}</label
                >
                <ng-select
                  #Empsearch
                  [items]="EmployeeSearch"
                  bindLabel="name"
                  bindValue="id"
                  [clearable]="true"
                  class="w-full p-0"
                  [(ngModel)]="absenteeempid"
                  (ngModelChange)="getemployeereports()"
                  placeholder="{{ 'Chose' | translate }}"
                >
                </ng-select>
              </div>
              <!-- <button
                class="btn btn-primary"
                (click)="data.filter.enable = !data.filter.enable"
                [translate]="'name'"
                [translateParams]="{
                  ar: 'فلترة بالوقت',
                  en: 'Time Filter'
                }"
              ></button>
              <div class="form-group timeInput" *ngIf="data.filter.enable">
                <input
                  placeholder="{{ 'Chose Date' | translate }}"
                  [(ngModel)]="data.filter.date"
                  (ngModelChange)="CheckDateabsentee($event)"

                  type="text"
                  class="form-control"
                  bsDaterangepicker
                  #dpr="bsDaterangepicker"
                />
              </div> -->
            </div>
            <div class="flex gap-2 controler">
              <button
                class="flex gap-1 btn btn-primary"
                (click)="Printabsence()"
              >
                <span class="hidden md:block">{{ "Print" | translate }}</span>
                <i class="fa-solid fa-print"></i>
              </button>
            </div>
          </div>

          <!-- table -->
          <div class="overflow-auto mt-3">
            <table
              class="min-w-max overflow-hidden rounded-t-lg table table-bordered table-striped"
            >
              <thead>
                <tr class="bg-base text-white">
                  <th
                    class="invoice-title uppercase text-center"
                    [translate]="'name'"
                    [translateParams]="{
                      ar: 'اسم العميل',
                      en: 'Employee Name'
                    }"
                  ></th>
                  <th
                    class="invoice-title uppercase text-center"
                    [translate]="'name'"
                    [translateParams]="{
                      ar: 'الرقم الوظيفى',
                      en: 'Jop Number'
                    }"
                  ></th>
                  <th
                    class="invoice-title uppercase text-center"
                    [translate]="'name'"
                    [translateParams]="{
                      ar: 'التاريخ',
                      en: 'Date'
                    }"
                  ></th>
                  <th
                    class="invoice-title uppercase text-center"
                    [translate]="'name'"
                    [translateParams]="{
                      ar: 'اليوم',
                      en: 'Day'
                    }"
                  ></th>
                  <th
                    class="invoice-title uppercase text-center"
                    [translate]="'name'"
                    [translateParams]="{
                      ar: 'الفرع',
                      en: 'Branch'
                    }"
                  ></th>
                </tr>
              </thead>
              <tbody id="tabledetails">
                <tr
                  class="text-black text-center"
                  *ngFor="let employee of data.absence"
                >
                  <td>{{ employee.e_FullName }}</td>
                  <td>{{ employee.empNo }}</td>
                  <td>{{ employee.mdate }}</td>
                  <td>{{ getDayName(employee.dayNOfWeek) }}</td>
                  <td>{{ employee.e_BranchId }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <div class="model-footer px-4 mb-3 flex justify-end">
      <button
        type="button"
        class="btn btn-outline-secondary"
        (click)="modal.dismiss()"
      >
        {{ "close" | translate }}
      </button>
    </div>

    <div style="display: none">
      <div
        id="reportabsemce"
        [ngStyle]="{ direction: lang == 'ar' ? 'rtl' : 'ltr' }"
      >
        <div
          class="report-header"
          style="
            display: flex;
            align-items: center;
            gap: 100px;
            padding: 3px 0px;
            margin-bottom: 20px;
          "
        >
          <div class="headerNe-right-side">
            <img
              *ngIf="logourl"
              src="{{ logourl }}"
              alt="logo"
              style="
                height: 200px;
                width: 200px;
                max-width: 200px;
                object-fit: fill;
              "
            />
          </div>

          <div class="headerNe-lefy-side" style="width: 100%">
            <h1
              style="
                letter-spacing: 0.25px;
                font-size: 23px;
                margin: 0;
                margin-bottom: 3px;
              "
            >
              {{ userG?.companyName }}
            </h1>
            <div class="line" style="position: relative; padding: 5px 0px 10px">
              <span
                style="
                  position: absolute;
                  right: 0;
                  width: 100%;
                  height: 2px;
                  background-color: #e5e5e5;
                  z-index: 1;
                "
              ></span>
              <span
                style="
                  position: absolute;
                  right: 0;
                  width: 70%;
                  height: 2px;
                  background-color: #ec1c24;
                  z-index: 2;
                "
              ></span>
            </div>

            <h1
              style="
                margin-bottom: 0;
                font-size: 34px;
                color: #0c8191;
                margin-bottom: 0;
                margin-top: 30px;
                font-weight: 500;
              "
              [translate]="'name'"
              [translateParams]="{
                ar: ' الموظفون الغائبون ',
                en: 'ُEmployees Abcence'
              }"
            ></h1>
          </div>
        </div>

        <div style="margin-bottom: 10px">
          <p>
            <span
              [translate]="'name'"
              [translateParams]="{
                ar: 'التاريخ: ',
                en: 'Date: '
              }"
            ></span>
            <span> {{ datePrintabcence }}</span>
          </p>
        </div>

        <div class="services" style="width: 100%; margin-bottom: 10px">
          <div class="content">
            <table
              style="
                text-align: center;
                vertical-align: middle;
                width: 100%;
                font-size: 12px;
              "
            >
              <thead>
                <td
                  style="
                    font-size: 16px;
                    background-color: #fff;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  اسم الموظف
                </td>

                <td
                  style="
                    font-size: 16px;
                    background-color: #f7f7f7;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  الرقم الوظيفي
                </td>
                <td
                  style="
                    font-size: 16px;
                    background-color: #f7f7f7;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  التاريخ
                </td>

                <td
                  style="
                    font-size: 16px;
                    background-color: #f7f7f7;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  اليوم
                </td>
                <td
                  style="
                    font-size: 16px;
                    background-color: #fff;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  الفرع
                </td>
              </thead>
              <tbody>
                <tr *ngFor="let employee of data.absence">
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ employee.e_FullName }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ employee.empNo }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ employee.mdate }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ getDayName(employee.dayNOfWeek) }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                      border-left: 1px dashed #272727;
                    "
                  >
                    {{ employee.e_BranchId }}
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </ng-template>

  <ng-template #LateModal let-modal>
    <div
      style="background-color: var(--base-color)"
      class="modal-header text-white flex justify-between items-center"
    >
      <h4 class="m-0">
        <span
          class="text-2xl"
          [translate]="'name'"
          [translateParams]="{
                     ar: 'المتأخرون',
      en: 'Latecomers',
                }"
        >
        </span>
      </h4>
      <button
        type="button"
        class="text-2xl text-white m-0"
        (click)="modal.dismiss()"
      >
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>
    <div class="modal-body">
      <!-- table -->
      <div class="overflow-auto mt-3">
        <table
          class="min-w-max overflow-hidden rounded-t-lg table table-bordered table-striped"
        >
          <thead>
            <tr class="bg-base text-white">
              <th
                class="invoice-title uppercase text-center"
                [translate]="'name'"
                [translateParams]="{
                  ar: 'اسم العميل',
                  en: 'Employee Name'
                }"
              ></th>
              <th
                class="invoice-title uppercase text-center"
                [translate]="'name'"
                [translateParams]="{
                  ar: 'الرقم الوظيفى',
                  en: 'Jop Number'
                }"
              ></th>
              <th
                class="invoice-title uppercase text-center"
                [translate]="'name'"
                [translateParams]="{
                  ar: 'التاريخ',
                  en: 'Date'
                }"
              ></th>
              <th
                class="invoice-title uppercase text-center"
                [translate]="'name'"
                [translateParams]="{
                  ar: 'حضور فترة اولى	',
                  en: 'Attending an initial period	'
                }"
              ></th>
              <th
                class="invoice-title uppercase text-center"
                [translate]="'name'"
                [translateParams]="{
                  ar: 'زمن التأخير',
                  en: '	Delay Time	'
                }"
              ></th>
              <th
                class="invoice-title uppercase text-center"
                [translate]="'name'"
                [translateParams]="{
                  ar: 'حضور فترة ثانية	',
                  en: 'Attend a Second Term'
                }"
              ></th>
              <th
                class="invoice-title uppercase text-center"
                [translate]="'name'"
                [translateParams]="{
                  ar: 'زمن التأخير	',
                  en: '	Delay Time	'
                }"
              ></th>
            </tr>
          </thead>
          <tbody id="tabledetails">
            <tr
              class="text-black text-center"
              *ngFor="let employee of datalate"
            >
              <td>{{ employee.fullName }}</td>
              <td>{{ employee.empNo }}</td>
              <td>{{ employee.dateDay }}</td>
              <td>{{ employee.timeJoin1 }}</td>
              <td>{{ employee.moveTimeStringJoin1 }}</td>
              <td>{{ employee.timeJoin2 }}</td>
              <td>{{ employee.moveTimeStringJoin2 }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="model-footer px-4 mb-3 flex justify-end">
      <button
        type="button"
        class="btn btn-outline-secondary"
        (click)="modal.dismiss()"
      >
        {{ "close" | translate }}
      </button>
    </div>
  </ng-template>

  <ng-template #notifications let-modal>
    <div
      style="background-color: var(--base-color)"
      class="modal-header text-white flex justify-between items-center"
    >
      <h4 class="m-0">
        <span
          class="text-2xl"
          [translate]="'name'"
          [translateParams]="{
                     ar: 'الاشعارات',
      en: 'Notifications',
                }"
        >
        </span>
      </h4>
      <button
        type="button"
        class="text-2xl text-white m-0"
        (click)="modal.dismiss()"
      >
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>
    <div class="modal-body">
      <app-notifications></app-notifications>
    </div>
    <div class="model-footer px-4 mb-3 flex justify-end">
      <button
        type="button"
        class="btn btn-outline-secondary"
        (click)="modal.dismiss()"
      >
        {{ "close" | translate }}
      </button>
    </div>
  </ng-template>

  <ng-template #tasks let-modal>
    <div
      style="background-color: var(--base-color)"
      class="modal-header text-white flex justify-between items-center"
    >
      <h4 class="m-0">
        <span
          class="text-2xl"
          [translate]="'name'"
          [translateParams]="{
     ar: 'المهام',
      en: 'Tasks',
                }"
        >
        </span>
      </h4>
      <button
        type="button"
        class="text-2xl text-white m-0"
        (click)="modal.dismiss()"
      >
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>
    <div class="modal-body">
      <app-tasks></app-tasks>
    </div>
    <div class="model-footer px-4 mb-3 flex justify-end">
      <button
        type="button"
        class="btn btn-outline-secondary"
        (click)="modal.dismiss()"
      >
        {{ "close" | translate }}
      </button>
    </div>
  </ng-template>

  <ng-template #supervision let-modal>
    <div
      style="background-color: var(--base-color)"
      class="modal-header text-white flex justify-between items-center"
    >
      <h4 class="m-0">
        <span
          class="text-2xl"
          [translate]="'name'"
          [translateParams]="{
   ar: 'متابعة طلعات الإشراف',
      en: 'Supervision',
                }"
        >
        </span>
      </h4>
      <button
        type="button"
        class="text-2xl text-white m-0"
        (click)="modal.dismiss()"
      >
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>
    <div class="modal-body">
      <!-- table -->
      <div class="overflow-auto mt-3">
        <table
          class="custome-table min-w-max overflow-hidden rounded-t-lg table table-bordered table-striped"
        >
          <thead>
            <tr class="bg-base text-white">
              <th
                class="invoice-title uppercase text-center"
                [translate]="'name'"
                [translateParams]="{
                  ar: 'اسم العميل',
                  en: 'Client Name'
                }"
              ></th>
              <th
                class="invoice-title uppercase text-center"
                [translate]="'name'"
                [translateParams]="{
                  ar: 'رقم المشروع	',
                  en: 'Project  Number'
                }"
              ></th>
              <th
                class="invoice-title uppercase text-center"
                [translate]="'name'"
                [translateParams]="{
                  ar: 'رقم أمر الاشراف	',
                  en: 'Supervision Order No.'
                }"
              ></th>
              <th
                class="invoice-title uppercase text-center"
                [translate]="'name'"
                [translateParams]="{
                  ar: 'المرحلة',
                  en: 'Stage '
                }"
              ></th>
              <th
                class="invoice-title uppercase text-center"
                [translate]="'name'"
                [translateParams]="{
                  ar: 'تاريخ التكليف	',
                  en: 'Commissioning Date'
                }"
              ></th>
              <th
                class="invoice-title uppercase text-center"
                [translate]="'name'"
                [translateParams]="{
                  ar: 'الحالة	',
                  en: 'Status '
                }"
              ></th>
              <th
                class="invoice-title uppercase text-center"
                [translate]="'name'"
                [translateParams]="{
                  ar: 'الخيارات	',
                  en: 'Options'
                }"
              ></th>
            </tr>
          </thead>
          <tbody id="tabledetails">
            <tr
              class="text-black text-center"
              *ngFor="let item of supervicsionlist"
            >
              <td>{{ item.customerName }}</td>
              <td>{{ item.projectNo }}</td>
              <td>{{ item.number }}</td>
              <td>{{ item.phaseName }}</td>
              <td>{{ item.superDateConfirm }}</td>
              <td>
                <span
                  style="background-color: #d3f9d3"
                  *ngIf="item.superStatus == 2"
                  >{{ item.superStatusName }}</span
                >
                <span
                  style="background-color: #ffd1d1"
                  *ngIf="item.superStatus == 3"
                  >{{ item.superStatusName }}</span
                >
                <span *ngIf="item.superStatus != 2 && item.superStatus != 3">{{
                  item.superStatusName
                }}</span>
              </td>

              <td>
                <div class="flex gap-1 justify-center py-2">
                  <button
                    (click)="reReciveSuper(item.supervisionId)"
                    class="min-w-max p-2 bg-sky-100 hover:bg-sky-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
                  >
                    <i class="fa-solid fa-thumbs-up"></i>
                  </button>
                  <button
                    (click)="NotReciveSuper(item.supervisionId)"
                    class="min-w-max p-2 bg-red-100 hover:bg-red-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
                  >
                    <i class="fa-solid fa-thumbs-down"></i>
                  </button>
                  <button
                    (click)="GetAllSupervisionDetailsBySuperId(item)"
                    class="min-w-max p-2 bg-zinc-100 hover:bg-zinc-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
                  >
                    <i class="fa-solid fa-circle-info"></i>
                  </button>
                  <button
                    (click)="
                      PrintSupervisionBase(item);
                      open(PrintSupervisionBaseModal)
                    "
                    class="min-w-max p-2 bg-sky-100 hover:bg-sky-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
                  >
                    <i class="fa-solid fa-print"></i>
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- table -->
      <div class="overflow-auto mt-3">
        <table
          class="custome-table min-w-max overflow-hidden rounded-t-lg table table-bordered table-striped"
        >
          <thead>
            <tr class="bg-base text-white">
              <th
                class="invoice-title uppercase text-center"
                [translate]="'name'"
                [translateParams]="{
                  ar: 'اسم مرحلة الاستلام',
                  en: 'Receiving stage name'
                }"
              ></th>
              <th
                class="invoice-title uppercase text-center"
                [translate]="'name'"
                [translateParams]="{
                  ar: 'الملاحظات	',
                  en: 'Notes'
                }"
              ></th>
              <th
                class="invoice-title uppercase text-center"
                [translate]="'name'"
                [translateParams]="{
                  ar: 'الخيارات	',
                  en: 'Options'
                }"
              ></th>
            </tr>
          </thead>
          <tbody id="tabledetails">
            <tr
              class=" {{ getcolor(item) }}"
              *ngFor="let item of SupervisionDetailslist"
            >
              <td>{{ item.nameAr }}</td>
              <td>{{ item.note }}</td>

              <td>
                <div class="flex gap-1 justify-center py-2">
                  <button
                    (click)="ReciveSuperDet(item.superDetId)"
                    class="min-w-max p-2 bg-sky-100 hover:bg-sky-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
                  >
                    <i class="fa-solid fa-thumbs-up"></i>
                  </button>
                  <button
                    (click)="
                      open(
                        reasonrefusesuperdet,
                        null,
                        item.superDetId,
                        null,
                        'reasonrefuse'
                      )
                    "
                    class="min-w-max p-2 bg-red-100 hover:bg-red-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
                  >
                    <i class="fa-solid fa-thumbs-down"></i>
                  </button>
                  <button
                    (click)="
                      open(reason, null, item.superDetId, null, 'notavailable')
                    "
                    class="min-w-max p-2 bg-zinc-100 hover:bg-zinc-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
                  >
                    <i class="fa-solid fa-eye-slash"></i>
                  </button>
                  <button
                    *ngIf="!item.imageUrl"
                    (click)="open(img, null, item.superDetId, null, 'img')"
                    class="min-w-max p-2 bg-sky-100 hover:bg-sky-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
                  >
                    <i class="fa-solid fa-image"></i>
                  </button>
                  <button
                    *ngIf="item.imageUrl"
                    (click)="downloadFile(item.imageUrl)"
                    class="min-w-max p-2 bg-sky-100 hover:bg-sky-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
                  >
                    <i class="fa-solid fa-eye"></i>
                  </button>
                  <button
                    *ngIf="SUper.superCode == '14'"
                    (click)="
                      open(number, null, item.superDetId, null, 'number')
                    "
                    class="min-w-max p-2 bg-purple-100 hover:bg-purple-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
                  >
                    <i class="fa-solid fa-chart-simple"></i>
                  </button>
                  <button
                    *ngIf="SUper.superCode == '14'"
                    (click)="
                      open(site, null, item.superDetId, null, 'location')
                    "
                    class="min-w-max p-2 bg-purple-100 hover:bg-purple-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
                  >
                    <i class="fa-solid fa-location-dot"></i>
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div
        class="flex flex-wrap gap-2 justify-center"
        *ngIf="clickdetails == 1"
      >
        <button
          (click)="open(changes, 'lg')"
          class="btn btn-primary"
          [translate]="'name'"
          [translateParams]="{
   ar: 'التغييرات على المخططات المعتمدة التي أقرها المكتب المصمم',
      en: 'Changes to the approved plans approved by the designing office',
                }"
        ></button>
        <button
          (click)="open(Items, 'lg')"
          class="btn btn-primary"
          [translate]="'name'"
          [translateParams]="{
   ar: 'البنود التي لم تذكر في التقرير',
      en: 'Items not mentioned in the report',
                }"
        ></button>
      </div>
    </div>
    <div class="model-footer px-4 mb-3 flex justify-end">
      <button
        type="button"
        class="btn btn-outline-secondary"
        (click)="modal.dismiss()"
      >
        {{ "close" | translate }}
      </button>
    </div>
  </ng-template>
  <!-----------------------------------------------------REPORT----------------------------------->
  <ng-template #Reports let-modal>
    <div
      style="background-color: var(--base-color)"
      class="modal-header text-white flex justify-between items-center"
    >
      <h4 class="m-0">
        <span
          class="text-2xl"
          [translate]="'name'"
          [translateParams]="{
            ar: 'التقارير',
            en: 'Reports'
          }"
        >
        </span>
      </h4>
      <button
        type="button"
        class="text-2xl text-white m-0"
        (click)="modal.dismiss()"
      >
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>
    <div class="modal-body">
      <tabset>
        <tab heading="{{ 'Done Task' | translate }}" id="tab1">
          <div class="content">
            <div class="flex items-center justify-between flex-wrap">
              <div class="form-group timeInput max-w-xs">
                <label class="col-form-label">
                  {{ "Date" | translate }}
                </label>
                <input
                  placeholder="{{ 'Chose Date' | translate }}"
                  type="text"
                  class="form-control"
                  bsDaterangepicker
                  [(ngModel)]="data.filter.date"
                  type="text"
                  class="form-control"
                  (ngModelChange)="CheckDate2($event, 1)"
                  #dpr="bsDaterangepicker"
                />
              </div>
              <button
                mat-raised-button
                class="bg-base text-white"
                (click)="printDoneTasks()"
              >
                {{ "Print" | translate }}
              </button>
            </div>
            <!-- table -->
            <div class="overflow-auto mt-3">
              <table
                class="custome-table min-w-max overflow-hidden rounded-t-lg table table-bordered table-striped"
              >
                <thead>
                  <tr class="bg-base text-white">
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'المهمة',
                        en: 'Task'
                      }"
                    ></th>
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'المدة	',
                        en: 'Duration'
                      }"
                    ></th>
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'رقم المشروع		',
                        en: 'Project Number'
                      }"
                    ></th>
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'العميل',
                        en: 'Customer '
                      }"
                    ></th>
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'إلى تاريخ		',
                        en: 'End Date'
                      }"
                    ></th>
                    <th
                    class="invoice-title uppercase text-center"
                    [translate]="'name'"
                    [translateParams]="{
                    ar: 'انجزت قبل/بعد الموعد',
                    en: 'Completed before/after appointment'
                    }"
                  ></th>
                    <!-- <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'التكلفة	',
                        en: 'Coast '
                      }"
                    ></th> -->
                  </tr>
                </thead>
                <tbody id="tabledetails">
                  <tr
                    class="text-black text-center"
                    *ngFor="let item of DoneTasksDGV"
                  >
                    <td>{{ item.descriptionAr }}</td>
                    <td>{{ item.duration }}</td>
                    <td>{{ item.projectNo }}</td>
                    <td>{{ item.clientName }}</td>
                    <td>{{ item.endDate }}</td>
                    <td class="{{getAchievementStatusColor(item)}}">{{ getAchievementStatus(item) }}</td>

                    <!-- <td> {{item.cost}}</td> -->
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </tab>
        <tab heading="{{ 'Done Work Orders' | translate }}" id="tab2">
          <div class="content">
            <div class="flex items-center justify-between flex-wrap">
              <div class="form-group timeInput max-w-xs">
                <label class="col-form-label">
                  {{ "Date" | translate }}
                </label>
                <input
                  placeholder="{{ 'Chose Date' | translate }}"
                  type="text"
                  class="form-control"
                  bsDaterangepicker
                  [(ngModel)]="data.filter.date"
                  type="text"
                  class="form-control"
                  (ngModelChange)="CheckDate2($event, 2)"
                  #dpr="bsDaterangepicker"
                />
              </div>
              <button
                mat-raised-button
                class="bg-base text-white"
                (click)="printEmpDoneWOsDGV()"
              >
                {{ "Print" | translate }}
              </button>
            </div>
            <!-- table -->
            <div class="overflow-auto mt-3">
              <table
                class="custome-table min-w-max overflow-hidden rounded-t-lg table table-bordered table-striped"
              >
                <thead>
                  <tr class="bg-base text-white">
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'رقم الطلب',
                        en: 'Order No'
                      }"
                    ></th>
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'المطلوب التكليف	',
                        en: 'Required Work'
                      }"
                    ></th>
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'بواسطة		',
                        en: 'Order By'
                      }"
                    ></th>
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'العميل',
                        en: 'Customer '
                      }"
                    ></th>
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'المدة		',
                        en: 'Duration'
                      }"
                    ></th>
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'تاريخ الانجاز	',
                        en: 'Done Date '
                      }"
                    ></th>
                  </tr>
                </thead>
                <tbody id="tabledetails">
                  <tr
                    class="text-black text-center"
                    *ngFor="let item of EmpDoneWOsDGV"
                  >
                    <td>{{ item.workOrderId }}</td>
                    <td>{{ item.requiredOrder }}</td>
                    <td>{{ item.byUser }}</td>
                    <td>{{ item.customerName }}</td>
                    <td>{{ item.duration }}</td>
                    <td>{{ item.endDate }}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </tab>
        <tab heading="{{ 'Running Tasks' | translate }}" id="tab3">
          <div class="content">
            <div class="flex items-center justify-between flex-wrap">
              <div class="form-group timeInput max-w-xs">
                <label class="col-form-label">
                  {{ "Date" | translate }}
                </label>
                <input
                  placeholder="{{ 'Chose Date' | translate }}"
                  type="text"
                  class="form-control"
                  bsDaterangepicker
                  [(ngModel)]="data.filter.date"
                  type="text"
                  class="form-control"
                  (ngModelChange)="CheckDate2($event, 3)"
                  #dpr="bsDaterangepicker"
                />
              </div>
              <button
                mat-raised-button
                class="bg-base text-white"
                (click)="printInProgressProjectPhasesTasksHome_Search()"
              >
                {{ "Print" | translate }}
              </button>
            </div>
            <!-- table -->
            <div class="overflow-auto mt-3">
              <table
                class="custome-table min-w-max overflow-hidden rounded-t-lg table table-bordered table-striped"
              >
                <thead>
                  <tr class="bg-base text-white">
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'المهمة',
                        en: 'Task'
                      }"
                    ></th>
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'المدة	',
                        en: 'Duration'
                      }"
                    ></th>
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'رقم المشروع		',
                        en: 'Project Number'
                      }"
                    ></th>
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'العميل',
                        en: 'Customer '
                      }"
                    ></th>
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'من تاريخ			',
                        en: 'Start Date'
                      }"
                    ></th>
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'الأهمية	',
                        en: 'Importance '
                      }"
                    ></th>
                  </tr>
                </thead>
                <tbody id="tabledetails">
                  <tr
                    class="text-black text-center"
                    *ngFor="let item of InProgressProjectPhasesTasksHome_Search"
                  >
                    <td>{{ item.descriptionAr }}</td>
                    <td>{{ item.timeStr }}</td>
                    <td>{{ item.projectNumber }}</td>
                    <td>{{ item.clientName }}</td>
                    <td>
                      {{
                        item.startDate == null && item.status == 1
                          ? " "
                          : item.startDate
                      }}
                    </td>
                    <td>{{ GetPriortyStr(item.phasePriority) }}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </tab>
        <tab heading="{{ 'Running Work Orders' | translate }}" id="tab4">
          <div class="content">
            <div class="flex items-center justify-between flex-wrap">
              <div class="form-group timeInput max-w-xs">
                <label class="col-form-label">
                  {{ "Date" | translate }}
                </label>
                <input
                  placeholder="{{ 'Chose Date' | translate }}"
                  type="text"
                  class="form-control"
                  bsDaterangepicker
                  [(ngModel)]="data.filter.date"
                  type="text"
                  class="form-control"
                  (ngModelChange)="CheckDate2($event, 4)"
                  #dpr="bsDaterangepicker"
                />
              </div>
              <button
                mat-raised-button
                class="bg-base text-white"
                (click)="printEmpUnderGoingWOsDGV()"
              >
                {{ "Print" | translate }}
              </button>
            </div>
            <!-- table -->
            <div class="overflow-auto mt-3">
              <table
                class="custome-table min-w-max overflow-hidden rounded-t-lg table table-bordered table-striped"
              >
                <thead>
                  <tr class="bg-base text-white">
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'رقم الطلب',
                        en: 'Order No'
                      }"
                    ></th>
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'المطلوب التكليف	',
                        en: 'Required Work'
                      }"
                    ></th>
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'بواسطة		',
                        en: 'Order By'
                      }"
                    ></th>
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'العميل',
                        en: 'Customer '
                      }"
                    ></th>
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'المدة		',
                        en: 'Duration'
                      }"
                    ></th>
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'المدة المتبقية	',
                        en: 'the remaining time '
                      }"
                    ></th>
                  </tr>
                </thead>
                <tbody id="tabledetails">
                  <tr
                    class="text-black text-center"
                    *ngFor="let item of EmpUnderGoingWOsDGV"
                  >
                    <td>{{ item.workOrderId }}</td>
                    <td>{{ item.requiredOrder }}</td>
                    <td>{{ item.byUser }}</td>
                    <td>{{ item.customerName }}</td>
                    <td>{{ item.duration }}</td>
                    <td>{{ item.leftDuration }}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </tab>
        <tab heading="{{ 'Late Work Order' | translate }}" id="tab5">
          <div class="content">
            <div class="flex items-center justify-between flex-wrap">
              <div class="form-group timeInput max-w-xs">
                <label class="col-form-label">
                  {{ "Date" | translate }}
                </label>
                <input
                  placeholder="{{ 'Chose Date' | translate }}"
                  type="text"
                  class="form-control"
                  bsDaterangepicker
                  [(ngModel)]="data.filter.date"
                  type="text"
                  class="form-control"
                  (ngModelChange)="CheckDate2($event, 5)"
                  #dpr="bsDaterangepicker"
                />
              </div>
              <button
                mat-raised-button
                class="bg-base text-white"
                (click)="printLateTasksByUserIdHome_Search()"
              >
                {{ "Print" | translate }}
              </button>
            </div>
            <!-- table -->
            <div class="overflow-auto mt-3">
              <table
                class="custome-table min-w-max overflow-hidden rounded-t-lg table table-bordered table-striped"
              >
                <thead>
                  <tr class="bg-base text-white">
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'رقم الطلب',
                        en: 'Order No'
                      }"
                    ></th>
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'المطلوب التكليف	',
                        en: 'Required Work'
                      }"
                    ></th>
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'بواسطة		',
                        en: 'Order By'
                      }"
                    ></th>
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'العميل',
                        en: 'Customer '
                      }"
                    ></th>
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'المدة		',
                        en: 'Duration'
                      }"
                    ></th>
                    <th
                      class="invoice-title uppercase text-center"
                      [translate]="'name'"
                      [translateParams]="{
                        ar: 'مدة التأخير	',
                        en: 'Time Duration Late '
                      }"
                    ></th>
                  </tr>
                </thead>
                <tbody id="tabledetails">
                  <tr
                    class="text-black text-center"
                    *ngFor="let item of LateTasksByUserIdHome_Search"
                  >
                    <td>{{ item.orderNo }}</td>
                    <td>{{ item.required }}</td>
                    <td>{{ item.byUser }}</td>
                    <td>{{ item.customerName }}</td>
                    <td>{{ item.duration }}</td>
                    <td>{{ item.orderRemaining }}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </tab>
      </tabset>
    </div>

    <div class="model-footer px-4 mb-3 flex justify-end">
      <button
        type="button"
        class="btn btn-outline-secondary"
        (click)="modal.dismiss()"
      >
        {{ "close" | translate }}
      </button>
    </div>

    <!---------------------------print 1--------------------------------------->
    <div style="display: none">
      <div
        id="DoneTasksDGV"
        [ngStyle]="{ direction: lang == 'ar' ? 'rtl' : 'ltr' }"
      >
        <div
          class="report-header"
          style="
            display: flex;
            align-items: center;
            gap: 100px;
            padding: 3px 0px;
            margin-bottom: 20px;
          "
        >
          <div class="headerNe-right-side">
            <img
              *ngIf="logourl"
              src="{{ logourl }}"
              alt="logo"
              style="
                height: 200px;
                width: 200px;
                max-width: 200px;
                object-fit: fill;
              "
            />
          </div>

          <div class="headerNe-lefy-side" style="width: 100%">
            <h1
              style="
                letter-spacing: 0.25px;
                font-size: 23px;
                margin: 0;
                margin-bottom: 3px;
              "
            >
              {{ userG?.companyName }}
            </h1>
            <div class="line" style="position: relative; padding: 5px 0px 10px">
              <span
                style="
                  position: absolute;
                  right: 0;
                  width: 100%;
                  height: 2px;
                  background-color: #e5e5e5;
                  z-index: 1;
                "
              ></span>
              <span
                style="
                  position: absolute;
                  right: 0;
                  width: 70%;
                  height: 2px;
                  background-color: #ec1c24;
                  z-index: 2;
                "
              ></span>
            </div>

            <h1
              style="
                margin-bottom: 0;
                font-size: 34px;
                color: #0c8191;
                margin-bottom: 0;
                margin-top: 30px;
                font-weight: 500;
              "
              [translate]="'name'"
              [translateParams]="{
                ar: '  المهام المنجزه ',
                en: 'ُDone Tasks'
              }"
            ></h1>
          </div>
        </div>

        <div style="margin-bottom: 10px">
          <p>
            <span
              [translate]="'name'"
              [translateParams]="{
                ar: 'التاريخ: ',
                en: 'Date: '
              }"
            ></span>
            <span> {{ datePrintabcence }}</span>
          </p>
        </div>

        <div class="services" style="width: 100%; margin-bottom: 10px">
          <div class="content">
            <table
              style="
                text-align: center;
                vertical-align: middle;
                width: 100%;
                font-size: 12px;
              "
            >
              <thead>
                <td
                  style="
                    font-size: 16px;
                    background-color: #fff;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  المهمة
                </td>

                <td
                  style="
                    font-size: 16px;
                    background-color: #f7f7f7;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  المدة
                </td>
                <td
                  style="
                    font-size: 16px;
                    background-color: #f7f7f7;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  رقم المشروع
                </td>

                <td
                  style="
                    font-size: 16px;
                    background-color: #f7f7f7;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  العميل
                </td>
                <td
                  style="
                    font-size: 16px;
                    background-color: #fff;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  الي تاريخ
                </td>
                <td
                style="
                  font-size: 16px;
                  background-color: #fff;
                  padding: 14px 4px;
                  text-align: center;
                  color: #272727;
                  word-wrap: break-word;
                  border-inline-start: 1px dashed #0c8191;
                  border: 1px dashed #272727;
                  font-weight: 600;
                "
              >
              انجزت قبل/بعد الموعد
              </td>
              </thead>
              <tbody>
                <tr *ngFor="let employee of DoneTasksDGV">
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ employee.descriptionAr }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ employee.duration }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ employee.projectNo }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ employee.clientName }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                      border-left: 1px dashed #272727;
                    "
                  >
                    {{ employee.endDate }}
                  </td>
                  <td class="{{getAchievementStatusColor(employee)}}"
                  style="
                    background-color: #fff;
                    font-size: 15px;
                    font-weight: 500;
                    padding: 10px 0px;
                    border-inline-start: 1px dashed #272727;
                    border-bottom: 1px dashed #272727;
                    border-left: 1px dashed #272727;
                  "
                >
                  {{ getAchievementStatus(employee) }}
                </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!---------------------------print 2---------------------------------------->
    <div style="display: none">
      <div
        id="EmpDoneWOsDGV"
        [ngStyle]="{ direction: lang == 'ar' ? 'rtl' : 'ltr' }"
      >
        <div
          class="report-header"
          style="
            display: flex;
            align-items: center;
            gap: 100px;
            padding: 3px 0px;
            margin-bottom: 20px;
          "
        >
          <div class="headerNe-right-side">
            <img
              *ngIf="logourl"
              src="{{ logourl }}"
              alt="logo"
              style="
                height: 200px;
                width: 200px;
                max-width: 200px;
                object-fit: fill;
              "
            />
          </div>

          <div class="headerNe-lefy-side" style="width: 100%">
            <h1
              style="
                letter-spacing: 0.25px;
                font-size: 23px;
                margin: 0;
                margin-bottom: 3px;
              "
            >
              {{ userG?.companyName }}
            </h1>
            <div class="line" style="position: relative; padding: 5px 0px 10px">
              <span
                style="
                  position: absolute;
                  right: 0;
                  width: 100%;
                  height: 2px;
                  background-color: #e5e5e5;
                  z-index: 1;
                "
              ></span>
              <span
                style="
                  position: absolute;
                  right: 0;
                  width: 70%;
                  height: 2px;
                  background-color: #ec1c24;
                  z-index: 2;
                "
              ></span>
            </div>

            <h1
              style="
                margin-bottom: 0;
                font-size: 34px;
                color: #0c8191;
                margin-bottom: 0;
                margin-top: 30px;
                font-weight: 500;
              "
              [translate]="'name'"
              [translateParams]="{
                ar: '  المهام المنجزه ',
                en: 'ُDone Tasks'
              }"
            ></h1>
          </div>
        </div>

        <div style="margin-bottom: 10px">
          <p>
            <span
              [translate]="'name'"
              [translateParams]="{
                ar: 'التاريخ: ',
                en: 'Date: '
              }"
            ></span>
            <span> {{ datePrintabcence }}</span>
          </p>
        </div>

        <div class="services" style="width: 100%; margin-bottom: 10px">
          <div class="content">
            <table
              style="
                text-align: center;
                vertical-align: middle;
                width: 100%;
                font-size: 12px;
              "
            >
              <thead>
                <td
                  style="
                    font-size: 16px;
                    background-color: #fff;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  رقم الطلب
                </td>

                <td
                  style="
                    font-size: 16px;
                    background-color: #f7f7f7;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  المطلوب التكليف
                </td>
                <td
                  style="
                    font-size: 16px;
                    background-color: #f7f7f7;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  بواسطة
                </td>

                <td
                  style="
                    font-size: 16px;
                    background-color: #f7f7f7;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  العميل
                </td>
                <td
                  style="
                    font-size: 16px;
                    background-color: #f7f7f7;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  المدة
                </td>
                <td
                  style="
                    font-size: 16px;
                    background-color: #fff;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  تاريخ الانجاز
                </td>
              </thead>
              <tbody>
                <tr *ngFor="let employee of EmpDoneWOsDGV">
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ employee.workOrderId }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ employee.requiredOrder }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ employee.byUser }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ employee.customerName }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ employee.duration }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                      border-left: 1px dashed #272727;
                    "
                  >
                    {{ employee.endDate }}
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!---------------------------print 3 ----------------------------------------->

    <div style="display: none">
      <div
        id="InProgressProjectPhasesTasksHome_Search"
        [ngStyle]="{ direction: lang == 'ar' ? 'rtl' : 'ltr' }"
      >
        <div
          class="report-header"
          style="
            display: flex;
            align-items: center;
            gap: 100px;
            padding: 3px 0px;
            margin-bottom: 20px;
          "
        >
          <div class="headerNe-right-side">
            <img
              *ngIf="logourl"
              src="{{ logourl }}"
              alt="logo"
              style="
                height: 200px;
                width: 200px;
                max-width: 200px;
                object-fit: fill;
              "
            />
          </div>

          <div class="headerNe-lefy-side" style="width: 100%">
            <h1
              style="
                letter-spacing: 0.25px;
                font-size: 23px;
                margin: 0;
                margin-bottom: 3px;
              "
            >
              {{ userG?.companyName }}
            </h1>
            <div class="line" style="position: relative; padding: 5px 0px 10px">
              <span
                style="
                  position: absolute;
                  right: 0;
                  width: 100%;
                  height: 2px;
                  background-color: #e5e5e5;
                  z-index: 1;
                "
              ></span>
              <span
                style="
                  position: absolute;
                  right: 0;
                  width: 70%;
                  height: 2px;
                  background-color: #ec1c24;
                  z-index: 2;
                "
              ></span>
            </div>

            <h1
              style="
                margin-bottom: 0;
                font-size: 34px;
                color: #0c8191;
                margin-bottom: 0;
                margin-top: 30px;
                font-weight: 500;
              "
              [translate]="'name'"
              [translateParams]="{
                ar: '  المهام قيد الانجاز ',
                en: 'In progress Tasks'
              }"
            ></h1>
          </div>
        </div>

        <div style="margin-bottom: 10px">
          <p>
            <span
              [translate]="'name'"
              [translateParams]="{
                ar: 'التاريخ: ',
                en: 'Date: '
              }"
            ></span>
            <span> {{ datePrintabcence }}</span>
          </p>
        </div>

        <div class="services" style="width: 100%; margin-bottom: 10px">
          <div class="content">
            <table
              style="
                text-align: center;
                vertical-align: middle;
                width: 100%;
                font-size: 12px;
              "
            >
              <thead>
                <td
                  style="
                    font-size: 16px;
                    background-color: #fff;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  المهمة
                </td>

                <td
                  style="
                    font-size: 16px;
                    background-color: #f7f7f7;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  المدة
                </td>
                <td
                  style="
                    font-size: 16px;
                    background-color: #f7f7f7;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  رقم المشروع
                </td>

                <td
                  style="
                    font-size: 16px;
                    background-color: #f7f7f7;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  العميل
                </td>
                <td
                  style="
                    font-size: 16px;
                    background-color: #f7f7f7;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  من تاريخ
                </td>
                <td
                  style="
                    font-size: 16px;
                    background-color: #fff;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  الاهمية
                </td>
              </thead>
              <tbody>
                <tr
                  *ngFor="
                    let employee of InProgressProjectPhasesTasksHome_Search
                  "
                >
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ employee.descriptionAr }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ employee.timeStr }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ employee.projectNumber }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ employee.clientName }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{
                      employee.startDate == null && employee.status == 1
                        ? " "
                        : employee.startDate
                    }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                      border-left: 1px dashed #272727;
                    "
                  >
                    {{ GetPriortyStr(employee.phasePriority) }}
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <!---------------------------print 4 ------------------------------------------>

    <div style="display: none">
      <div
        id="EmpUnderGoingWOsDGV"
        [ngStyle]="{ direction: lang == 'ar' ? 'rtl' : 'ltr' }"
      >
        <div
          class="report-header"
          style="
            display: flex;
            align-items: center;
            gap: 100px;
            padding: 3px 0px;
            margin-bottom: 20px;
          "
        >
          <div class="headerNe-right-side">
            <img
              *ngIf="logourl"
              src="{{ logourl }}"
              alt="logo"
              style="
                height: 200px;
                width: 200px;
                max-width: 200px;
                object-fit: fill;
              "
            />
          </div>

          <div class="headerNe-lefy-side" style="width: 100%">
            <h1
              style="
                letter-spacing: 0.25px;
                font-size: 23px;
                margin: 0;
                margin-bottom: 3px;
              "
            >
              {{ userG?.companyName }}
            </h1>
            <div class="line" style="position: relative; padding: 5px 0px 10px">
              <span
                style="
                  position: absolute;
                  right: 0;
                  width: 100%;
                  height: 2px;
                  background-color: #e5e5e5;
                  z-index: 1;
                "
              ></span>
              <span
                style="
                  position: absolute;
                  right: 0;
                  width: 70%;
                  height: 2px;
                  background-color: #ec1c24;
                  z-index: 2;
                "
              ></span>
            </div>

            <h1
              style="
                margin-bottom: 0;
                font-size: 34px;
                color: #0c8191;
                margin-bottom: 0;
                margin-top: 30px;
                font-weight: 500;
              "
              [translate]="'name'"
              [translateParams]="{
                ar: '  اوامر عمل قيد الانجاز ',
                en: 'In progress Work Orders'
              }"
            ></h1>
          </div>
        </div>

        <div style="margin-bottom: 10px">
          <p>
            <span
              [translate]="'name'"
              [translateParams]="{
                ar: 'التاريخ: ',
                en: 'Date: '
              }"
            ></span>
            <span> {{ datePrintabcence }}</span>
          </p>
        </div>

        <div class="services" style="width: 100%; margin-bottom: 10px">
          <div class="content">
            <table
              style="
                text-align: center;
                vertical-align: middle;
                width: 100%;
                font-size: 12px;
              "
            >
              <thead>
                <td
                  style="
                    font-size: 16px;
                    background-color: #fff;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  رقم الطلب
                </td>

                <td
                  style="
                    font-size: 16px;
                    background-color: #f7f7f7;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  المطلوب التكليف
                </td>
                <td
                  style="
                    font-size: 16px;
                    background-color: #f7f7f7;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  بواسطة
                </td>

                <td
                  style="
                    font-size: 16px;
                    background-color: #f7f7f7;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  العميل
                </td>
                <td
                  style="
                    font-size: 16px;
                    background-color: #f7f7f7;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  المدة
                </td>
                <td
                  style="
                    font-size: 16px;
                    background-color: #fff;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  المدة المتبقية
                </td>
              </thead>
              <tbody>
                <tr *ngFor="let employee of EmpUnderGoingWOsDGV">
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ employee.workOrderId }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ employee.requiredOrder }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ employee.byUser }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ employee.customerName }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ employee.duration }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                      border-left: 1px dashed #272727;
                    "
                  >
                    {{ employee.leftDuration }}
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <!---------------------------print 5 ------------------------------------------->

    <div style="display: none">
      <div
        id="LateTasksByUserIdHome_Search"
        [ngStyle]="{ direction: lang == 'ar' ? 'rtl' : 'ltr' }"
      >
        <div
          class="report-header"
          style="
            display: flex;
            align-items: center;
            gap: 100px;
            padding: 3px 0px;
            margin-bottom: 20px;
          "
        >
          <div class="headerNe-right-side">
            <img
              *ngIf="logourl"
              src="{{ logourl }}"
              alt="logo"
              style="
                height: 200px;
                width: 200px;
                max-width: 200px;
                object-fit: fill;
              "
            />
          </div>

          <div class="headerNe-lefy-side" style="width: 100%">
            <h1
              style="
                letter-spacing: 0.25px;
                font-size: 23px;
                margin: 0;
                margin-bottom: 3px;
              "
            >
              {{ userG?.companyName }}
            </h1>
            <div class="line" style="position: relative; padding: 5px 0px 10px">
              <span
                style="
                  position: absolute;
                  right: 0;
                  width: 100%;
                  height: 2px;
                  background-color: #e5e5e5;
                  z-index: 1;
                "
              ></span>
              <span
                style="
                  position: absolute;
                  right: 0;
                  width: 70%;
                  height: 2px;
                  background-color: #ec1c24;
                  z-index: 2;
                "
              ></span>
            </div>

            <h1
              style="
                margin-bottom: 0;
                font-size: 34px;
                color: #0c8191;
                margin-bottom: 0;
                margin-top: 30px;
                font-weight: 500;
              "
              [translate]="'name'"
              [translateParams]="{
                ar: '  اوامر عمل  متاخره ',
                en: 'Late Work Orders'
              }"
            ></h1>
          </div>
        </div>

        <div style="margin-bottom: 10px">
          <p>
            <span
              [translate]="'name'"
              [translateParams]="{
                ar: 'التاريخ: ',
                en: 'Date: '
              }"
            ></span>
            <span> {{ datePrintabcence }}</span>
          </p>
        </div>

        <div class="services" style="width: 100%; margin-bottom: 10px">
          <div class="content">
            <table
              style="
                text-align: center;
                vertical-align: middle;
                width: 100%;
                font-size: 12px;
              "
            >
              <thead>
                <td
                  style="
                    font-size: 16px;
                    background-color: #fff;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  رقم الطلب
                </td>

                <td
                  style="
                    font-size: 16px;
                    background-color: #f7f7f7;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  المطلوب التكليف
                </td>
                <td
                  style="
                    font-size: 16px;
                    background-color: #f7f7f7;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  بواسطة
                </td>

                <td
                  style="
                    font-size: 16px;
                    background-color: #f7f7f7;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  العميل
                </td>
                <td
                  style="
                    font-size: 16px;
                    background-color: #f7f7f7;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  المدة
                </td>
                <td
                  style="
                    font-size: 16px;
                    background-color: #fff;
                    padding: 14px 4px;
                    text-align: center;
                    color: #272727;
                    word-wrap: break-word;
                    border-inline-start: 1px dashed #0c8191;
                    border: 1px dashed #272727;
                    font-weight: 600;
                  "
                >
                  مدة التاخير
                </td>
              </thead>
              <tbody>
                <tr *ngFor="let employee of LateTasksByUserIdHome_Search">
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ employee.descriptionAr }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ employee.timeStr }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ employee.projectNumber }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ employee.clientName }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                    "
                  >
                    {{ employee.startDate }}
                  </td>
                  <td
                    style="
                      background-color: #fff;
                      font-size: 15px;
                      font-weight: 500;
                      padding: 10px 0px;
                      color: #272727;
                      border-inline-start: 1px dashed #272727;
                      border-bottom: 1px dashed #272727;
                      border-left: 1px dashed #272727;
                    "
                  >
                    {{ getDelay(employee.remaining) }}
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </ng-template>

  <ng-template #changes let-modal>
    <div
      style="background-color: var(--base-color)"
      class="modal-header text-white flex justify-between items-center"
    >
      <h4 class="m-0">
        <span
          class="text-2xl"
          [translate]="'name'"
          [translateParams]="{
   ar: 'التغييرات على المخططات المعتمدة التي أقرها المكتب المصمم',
      en: 'Changes to the approved plans approved by the designing office',
                }"
        >
        </span>
      </h4>
      <button
        type="button"
        class="text-2xl text-white m-0"
        (click)="modal.dismiss()"
      >
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>
    <div class="modal-body">
      <form class="flex flex-col gap-2">
        <div class="flex items-center gap-2">
          <span>1. </span>
          <input
            type="text"
            name="outlineChangetxt1"
            [(ngModel)]="outlinechanges.outlineChangetxt1"
            class="form-control"
          />
        </div>
        <div class="flex items-center gap-2">
          <span>2. </span>
          <input
            type="text"
            name="outlineChangetxt2"
            [(ngModel)]="outlinechanges.outlineChangetxt2"
            class="form-control"
          />
        </div>
        <div class="flex items-center gap-2">
          <span>3. </span>
          <input
            type="text"
            name="outlineChangetxt3"
            [(ngModel)]="outlinechanges.outlineChangetxt3"
            class="form-control"
          />
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button class="btn btn-light" (click)="modal.dismiss()">
        {{ "Back" | translate }}
      </button>
      <button class="btn btn-primary" (click)="OutlineChangeSave()">
        {{ "Save" | translate }}
      </button>
    </div>
  </ng-template>

  <ng-template #Items let-modal>
    <div
      style="background-color: var(--base-color)"
      class="modal-header text-white flex justify-between items-center"
    >
      <h4 class="m-0">
        <span
          class="text-2xl"
          [translate]="'name'"
          [translateParams]="{
 ar: 'البنود التي لم تذكر في التقرير',
      en: 'Items not mentioned in the report',
                }"
        >
        </span>
      </h4>
      <button
        type="button"
        class="text-2xl text-white m-0"
        (click)="modal.dismiss()"
      >
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>
    <div class="modal-body">
      <form class="flex flex-col gap-2">
        <div class="flex items-center gap-2">
          <span>1. </span>
          <input
            type="text"
            name="pointsNotWrittentxt1"
            [(ngModel)]="outlinechanges.pointsNotWrittentxt1"
            class="form-control"
          />
        </div>
        <div class="flex items-center gap-2">
          <span>2. </span>
          <input
            type="text"
            name="pointsNotWrittentxt2"
            [(ngModel)]="outlinechanges.pointsNotWrittentxt2"
            class="form-control"
          />
        </div>
        <div class="flex items-center gap-2">
          <span>3. </span>
          <input
            type="text"
            name="pointsNotWrittentxt3"
            [(ngModel)]="outlinechanges.pointsNotWrittentxt3"
            class="form-control"
          />
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button class="btn btn-light" (click)="modal.dismiss()">
        {{ "Back" | translate }}
      </button>
      <button class="btn btn-primary" (click)="PointsNotWrittenSave()">
        {{ "Save" | translate }}
      </button>
    </div>
  </ng-template>

  <ng-template #reason let-modal>
    <div
      style="background-color: var(--base-color)"
      class="modal-header text-white flex justify-between items-center"
    >
      <h4 class="m-0">
        <span
          class="text-2xl"
          [translate]="'name'"
          [translateParams]="{
 ar: 'سبب عدم التوفر ؟',
      en: 'The reason for the unavailability?',
                }"
        >
        </span>
      </h4>
      <button
        type="button"
        class="text-2xl text-white m-0"
        (click)="modal.dismiss()"
      >
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>
    <div class="modal-body">
      <form>
        <div>
          <input
            type="text"
            [(ngModel)]="notavailablerefuse"
            name="notavailablerefuse"
            class="form-control"
          />
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button class="btn btn-light" (click)="modal.dismiss()">
        {{ "Back" | translate }}
      </button>
      <button class="btn btn-primary" (click)="NotFoundSuperDet()">
        {{ "Save" | translate }}
      </button>
    </div>
  </ng-template>

  <ng-template #reasonrefusesuperdet let-modal>
    <div
      style="background-color: var(--base-color)"
      class="modal-header text-white flex justify-between items-center"
    >
      <h4 class="m-0">
        <span
          class="text-2xl"
          [translate]="'name'"
          [translateParams]="{
 ar: 'سبب الرفض  ؟',
      en: 'The reason for the unavailability?',
                }"
        >
        </span>
      </h4>
      <button
        type="button"
        class="text-2xl text-white m-0"
        (click)="modal.dismiss()"
      >
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>
    <div class="modal-body">
      <form>
        <div>
          <input
            type="text"
            [(ngModel)]="reasonrefusedeyails"
            name="reasonrefusedeyails"
            class="form-control"
          />
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button class="btn btn-light" (click)="modal.dismiss()">
        {{ "Back" | translate }}
      </button>
      <button class="btn btn-primary" (click)="NotReciveSuperDet()">
        {{ "Save" | translate }}
      </button>
    </div>
  </ng-template>

  <ng-template #img let-modal>
    <div
      style="background-color: var(--base-color)"
      class="modal-header text-white flex justify-between items-center"
    >
      <h4 class="m-0">
        <span
          class="text-2xl"
          [translate]="'name'"
          [translateParams]="{
            ar: 'رفع صورة',
            en: 'Upload Image',
          }"
        >
        </span>
      </h4>
      <button
        type="button"
        class="text-2xl text-white m-0"
        (click)="modal.dismiss()"
      >
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>
    <div class="modal-body">
      <form>
        <div class="upload">
          <file-upload [control]="control" style="min-height: 240px">
            <ng-template
              let-isFileDragDropAvailable="isFileDragDropAvailable"
              #placeholder
            >
              <div *ngIf="control.size === 0">
                <div class="icon">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    height="1em"
                    viewBox="0 0 640 512"
                  >
                    <path
                      d="M144 480C64.5 480 0 415.5 0 336c0-62.8 40.2-116.2 96.2-135.9c-.1-2.7-.2-5.4-.2-8.1c0-88.4 71.6-160 160-160c59.3 0 111 32.2 138.7 80.2C409.9 102 428.3 96 448 96c53 0 96 43 96 96c0 12.2-2.3 23.8-6.4 34.6C596 238.4 640 290.1 640 352c0 70.7-57.3 128-128 128H144zm79-217c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l39-39V392c0 13.3 10.7 24 24 24s24-10.7 24-24V257.9l39 39c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-80-80c-9.4-9.4-24.6-9.4-33.9 0l-80 80z"
                    />
                  </svg>
                </div>
              </div>
            </ng-template>

            <ng-template
              let-i="index"
              let-file="file"
              let-control="control"
              #item
            >
              <div class="overlay">
                <span class="delete-button" (click)="control.removeFile(file)">
                  <svg viewBox="0 0 448 512">
                    <path
                      d="M32 464a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128H32zm272-256a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zM432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16z"
                    ></path>
                  </svg>
                </span>
                <img *ngIf="control.valid" [src]="uploadedFile | async" />
              </div>
            </ng-template>
          </file-upload>
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button class="btn btn-light" (click)="modal.dismiss()">
        {{ "Back" | translate }}
      </button>
      <button class="btn btn-primary" (click)="UploadImageSuperDet()">
        {{ "Save" | translate }}
      </button>
    </div>
  </ng-template>

  <ng-template #number let-modal>
    <div
      style="background-color: var(--base-color)"
      class="modal-header text-white flex justify-between items-center"
    >
      <h4 class="m-0">
        <span
          class="text-2xl"
          [translate]="'name'"
          [translateParams]="{
 ar: 'العدد ؟',
      en: 'The number ?',
                }"
        >
        </span>
      </h4>
      <button
        type="button"
        class="text-2xl text-white m-0"
        (click)="modal.dismiss()"
      >
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>
    <div class="modal-body">
      <form>
        <div>
          <input
            type="number"
            [(ngModel)]="nubersuperdet"
            name="nubersuperdet"
            class="form-control"
          />
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button class="btn btn-light" (click)="modal.dismiss()">
        {{ "Back" | translate }}
      </button>
      <button class="btn btn-primary" (click)="TheNumberSuperDet()">
        {{ "Save" | translate }}
      </button>
    </div>
  </ng-template>

  <ng-template #site let-modal>
    <div
      style="background-color: var(--base-color)"
      class="modal-header text-white flex justify-between items-center"
    >
      <h4 class="m-0">
        <span
          class="text-2xl"
          [translate]="'name'"
          [translateParams]="{
 ar: 'الموقع ؟',
      en: 'The site ?',
                }"
        >
        </span>
      </h4>
      <button
        type="button"
        class="text-2xl text-white m-0"
        (click)="modal.dismiss()"
      >
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>
    <div class="modal-body">
      <form>
        <div>
          <input
            type="text"
            [(ngModel)]="locationsuperdet"
            name="locationsuperdet"
            class="form-control"
          />
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button class="btn btn-light" (click)="modal.dismiss()">
        {{ "Back" | translate }}
      </button>
      <button class="btn btn-primary" (click)="TheLocationSuperDet()">
        {{ "Save" | translate }}
      </button>
    </div>
  </ng-template>

  <ng-template #alert let-modal>
    <div
      style="background-color: var(--base-color)"
      class="modal-header text-white flex justify-between items-center"
    >
      <h4 class="m-0">
        <span class="text-2xl">{{ "Circulars" | translate }} </span>
      </h4>
      <button
        type="button"
        class="text-2xl text-white m-0"
        (click)="modal.dismiss()"
      >
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>
    <div class="modal-body">
      <!-- <app-general-alert></app-general-alert> -->
      <div class="pb-4">
        <!-- <app-navigator [title]="title"></app-navigator> -->

        <div class="tables-data mt-3 overflow-hidden">
          <!-- buttons -->
          <div class="flex justify-between gap-2 items-center my-3 flex-wrap">
            <div class="w-fit">
              <input
                class="form-control"
                (keyup)="applyFilter($event)"
                placeholder="{{ 'search' | translate }}"
                #input
              />
            </div>
            <div
              class="flex justify-between gap-2 items-center my-3 flex-wrap"
              style="font-size: small"
            >
              <span
                class="p-3 rounded-lg bg-red-200"
                [translate]="'name'"
                [translateParams]="{
                  ar: 'بمجرد فتح هذه الشاشة يظهر للادارة أن المستخدم اطلع علي التنبيه / او التعميم،كذلك فان حذفك للتعميم يخفيه من شاشتك فقط،لكنه يبقي في شاشة الادارة ',
                  en: 'بمجرد فتح هذه الشاشة يظهر للادارة أن المستخدم اطلع علي التنبيه / او التعميم،كذلك فان حذفك للتعميم يخفيه من شاشتك فقط،لكنه يبقي في شاشة الادارة '
                }"
              >
              </span>

              <!-- <span>بمجرد فتح هذه الشاشة يظهر للادارة أن المستخدم اطلع علي التنبيه / او التعميم،كذلك فان حذفك للتعميم يخفيه من شاشتك فقط،لكنه يبقي في شاشة الادارة </span> -->
            </div>
            <!-- <div class="flex gap-2 controler">
              <button class="flex gap-1 btn btn-primary" (click)="open(addAlert,'edit','edit')">
                <span class="hidden md:block" [translate]="'name'" [translateParams]="{
                    ar: 'اضافة تنبيه ',
                    en: 'Add Alert'
                  }"></span>
                <i class="fa-solid fa-chart-simple"></i>
              </button>
            </div> -->
          </div>

          <!-- table -->
          <div class="overflow-auto">
            <table
              mat-table
              [dataSource]="dataalert.alerts"
              matSort
              class="mat-elevation-z8 rounded-t-lg overflow-hidden w-max"
            >
              <ng-container matColumnDef="Name">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>
                  <span
                    [translate]="'name'"
                    [translateParams]="{
                      ar: 'عنوان التنبيه',
                      en: 'Alert Title'
                    }"
                  ></span>
                </th>
                <td mat-cell *matCellDef="let element">
                  {{ element.name }}
                </td>
              </ng-container>

              <ng-container matColumnDef="Date">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>
                  <span
                    [translate]="'name'"
                    [translateParams]="{
                      ar: 'تاريخ التنبيه',
                      en: 'Alert Date'
                    }"
                  ></span>
                </th>
                <td mat-cell *matCellDef="let element">
                  {{ element.date }}
                </td>
              </ng-container>

              <ng-container matColumnDef="SendUserName">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>
                  <span
                    [translate]="'name'"
                    [translateParams]="{
                      ar: 'المرسل ',
                      en: 'Sent'
                    }"
                  ></span>
                </th>
                <td mat-cell *matCellDef="let element">
                  {{ element.sendUserName }}
                </td>
              </ng-container>

              <ng-container matColumnDef="Description">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>
                  <span
                    [translate]="'name'"
                    [translateParams]="{
                      ar: 'نص التنبيه ',
                      en: 'Alert Text'
                    }"
                  ></span>
                </th>
                <td mat-cell *matCellDef="let element">
                  <div
                    [innerHTML]="element.description"
                    style="text-align: right"
                  ></div>
                </td>
              </ng-container>

              <ng-container matColumnDef="operations">
                <th
                  mat-header-cell
                  *matHeaderCellDef
                  [translate]="'name'"
                  [translateParams]="{
                    ar: 'خيارات',
                    en: 'Operations'
                  }"
                ></th>
                <td mat-cell *matCellDef="let element">
                  <button
                    class="min-w-max p-2 bg-red-100 hover:bg-red-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
                    (click)="open(DeleteAlertModal); getRow(element)"
                  >
                    <i class="fa-solid fa-trash-can"></i>
                  </button>
                </td>
              </ng-container>
              <!-- <ng-container matColumnDef="IsRead">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>
                  <span [translate]="'name'" [translateParams]="{
                      ar: 'حالة التنبية',
                      en: 'Alert Status'
                    }"></span>
                </th>
                <td mat-cell *matCellDef="let element">
                  <span *ngIf="element.isRead" [translate]="'name'" [translateParams]="{
                      ar: 'تمت المشاهدة',
                      en: 'Read'
                    }"></span>
                  <span *ngIf="!element.isRead" [translate]="'name'" [translateParams]="{
                      ar: 'لم تتم المشاهدة',
                      en: 'Not Read'
                    }"></span>
                </td>
              </ng-container> -->

              <!-- Symbol Column -->

              <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>

              <tr
                mat-row
                *matRowDef="let row; columns: displayedColumns"
                class="duration-300 hover:bg-slate-100"
              ></tr>
              <!-- Row shown when there is no matching data. -->
              <tr class="mat-row" *matNoDataRow>
                <td class="mat-cell" colspan="4">
                  {{ "No result found for " }} "{{ input.value }}"
                </td>
              </tr>
            </table>
          </div>
          <mat-paginator [pageSizeOptions]="[10, 25]"> </mat-paginator>
        </div>
      </div>
    </div>
    <div class="model-footer px-4 mb-3 flex justify-end">
      <button
        type="button"
        class="btn btn-outline-secondary"
        (click)="modal.dismiss()"
      >
        {{ "close" | translate }}
      </button>
    </div>
  </ng-template>

  <!-- followVacationsModal -->
  <ng-template #followVacationsModal let-modal>
    <div
      style="background-color: var(--base-color)"
      class="modal-header text-white flex justify-between items-center"
    >
      <h4 class="modal-title mb-0" id="modal-basic-title">
        <span>{{ "followVacations" | translate }}</span>
      </h4>
      <button
        type="button"
        class="text-white m-0"
        aria-label="Close"
        (click)="modal.dismiss('Cross click')"
      >
        <i class="fa fa-close"></i>
      </button>
    </div>

    <div class="modal-body text-center">
      <div>
        <!-- wating table -->
        <div class="flex gap-3 justify-between items-end flex-wrap">
          <div class="text-start w-fit" *ngIf="role != 'vacationclient'">
            <label
              class="col-form-label"
              [translate]="'name'"
              [translateParams]="{
                ar: 'فرز حسب',
                en: 'Sort By'
              }"
            >
            </label>
            <ng-select
              class="w-full p-0"
              placeholder="{{ 'Chose' | translate }}"
              name="user"
              name="user"
              [(ngModel)]="watingvacationtype"
              (ngModelChange)="getwaitingvacation()"
            >
              <ng-option [value]="1">طلب جديد</ng-option>
              <ng-option [value]="2">تم الموافقة علي الطلب</ng-option>
              <ng-option [value]="3">تم رفض الطلب</ng-option>
              <ng-option [value]="4">مراجعه</ng-option>
              <ng-option [value]="5">تاجيل</ng-option>
            </ng-select>
          </div>
          <p
            class="mb-0 text-center fw-bold text-base"
            *ngIf="role == 'vacationclient'"
          >
            {{ "My vacation balance" | translate }}
            {{ vacatiocounts }}
          </p>
          <button
            *ngIf="role == 'vacationclient'"
            type="button"
            class="btn bg-base text-white"
            (click)="open(addNewVacation)"
          >
            {{ "new request" | translate }}
          </button>
        </div>
        <div class="my-4">
          <div class="row">
            <h4 class="text-start col-2">
              {{ "Requests pending approval" | translate }}
            </h4>
            <span
              *ngIf="role != 'vacationclient'"
              style="padding: 0.5rem !important"
              class="p-3 rounded-lg bg-red-200 col-10"
              [translate]="'name'"
              [translateParams]="{
                ar: 'يستحسن اتخاذ قرار بخصوص الطلبات المقدمة من الموظفين ،حيث يتم تحديث الطلب لدي الموظف بأن طلبه(تقديم طلب)',
                en: 'يستحسن اتخاذ قرار بخصوص الطلبات المقدمة من الموظفين ،حيث يتم تحديث الطلب لدي الموظف بأن طلبه(تقديم طلب)'
              }"
            >
            </span>
          </div>
          <div class="tables-data mt-3 overflow-hidden">
            <div class="overflow-auto">
              <table
                mat-table
                [dataSource]="dataSourceWaitingVacation"
                matSort
                class="mat-elevation-z8 rounded-t-lg overflow-hidden w-max"
              >
                <!-- employeName column -->
                <ng-container matColumnDef="date">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    <span>{{ "date" | translate }}</span>
                  </th>
                  <td mat-cell *matCellDef="let element">
                    <span>{{ element.date | date : "dd-MM-yyyy" }}</span>
                  </td>
                </ng-container>
                <!-- vacationType column -->
                <ng-container matColumnDef="employeeName">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    <span>{{ "Employee Name" | translate }}</span>
                  </th>
                  <td mat-cell *matCellDef="let element">
                    <span>{{ element.employeeName }}</span>
                  </td>
                </ng-container>
                <!-- vacationStatus column -->
                <ng-container matColumnDef="vacationType">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    <span>{{ "the kind of holiday" | translate }}</span>
                  </th>
                  <td mat-cell *matCellDef="let element">
                    <span>{{ element.vacationTypeName }}</span>
                  </td>
                </ng-container>
                <!-- manager column -->
                <ng-container matColumnDef="discoundType">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    <span>{{ "discound type" | translate }}</span>
                  </th>
                  <td mat-cell *matCellDef="let element">
                    <span *ngIf="element.isDiscount == true">
                      <i class="fa-solid fa-check text-green-500"></i>
                    </span>
                    <span *ngIf="element.isDiscount == false">
                      <i class="fa-solid fa-xmark text-red-500"></i>
                    </span>
                  </td>
                </ng-container>
                <!-- from column -->
                <ng-container matColumnDef="startDate">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    <span>
                      {{ "vacation start" | translate }}
                    </span>
                  </th>
                  <td mat-cell *matCellDef="let element">
                    <span>{{ element.startDate | date : "dd-MM-yyyy" }}</span>
                  </td>
                </ng-container>
                <!-- to column -->
                <ng-container matColumnDef="duration">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    {{ "duration" | translate }}
                  </th>
                  <td mat-cell *matCellDef="let element">
                    <span>{{ element.timeStr }}</span>
                  </td>
                </ng-container>
                <!-- deductionFromSalary column -->
                <ng-container matColumnDef="dicesion">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    <span>{{ "dicesion" | translate }}</span>
                  </th>
                  <td mat-cell *matCellDef="let element">
                    <div
                      *ngIf="role == 'vacationclient'"
                      class="flex items-center justify-center gap-4"
                    >
                      <!-- <span
                        [translate]="'name'"
                        [translateParams]="{
                          ar: 'تم قبول الطلب',
                          en: 'Accepted'
                        }"
                      ></span> -->
                      <span>{{ element.vacationStatusName }}</span>

                      <button
                        (click)="setdatatoprint(element); PrintVacation()"
                        class="p-2 bg-sky-100 hover:bg-sky-500 rounded-lg duration-300 hover:text-white w-10"
                      >
                        <i class="fa-solid fa-print"></i>
                      </button>
                    </div>
                    <select
                      *ngIf="role != 'vacationclient'"
                      class="w-full form-select"
                      name="user"
                      (change)="openModal($event, element, 'vacation')"
                    >
                      <option [value]="0">
                        {{ "Chose" | translate }}
                      </option>
                      <option [value]="2">
                        {{ "Acceptance" | translate }}
                      </option>
                      <option [value]="3">{{ "to reject" | translate }}</option>
                      <option [value]="4">{{ "review" | translate }}</option>
                      <option [value]="5">{{ "delayed" | translate }}</option>
                    </select>
                  </td>
                </ng-container>
                <ng-container matColumnDef="attachment">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    <span>{{ "Attachments" | translate }}</span>
                  </th>
                  <td mat-cell *matCellDef="let element">
                    <button
                      class="p-2 bg-blue-100 hover:bg-blue-500 rounded-lg duration-300 hover:text-white w-10"
                    >
                      <i class="fa-solid fa-eye"></i>
                    </button>
                  </td>
                </ng-container>

                <tr
                  mat-header-row
                  *matHeaderRowDef="displayedColumnsWaitingVacation"
                ></tr>

                <tr
                  mat-row
                  *matRowDef="let row; columns: displayedColumnsWaitingVacation"
                  class="duration-300 hover:bg-slate-100"
                ></tr>
              </table>
            </div>
          </div>

          <div style="display: none">
            <div
              id="reportholiday"
              [ngStyle]="{ direction: lang == 'ar' ? 'rtl' : 'ltr' }"
            >
              <div
                class="report-header"
                style="
                  display: flex;
                  align-items: center;
                  gap: 100px;
                  padding: 3px 0px;
                  margin-bottom: 20px;
                "
              >
                <div class="headerNe-right-side">
                  <img
                    *ngIf="logourl"
                    src="{{ logourl }}"
                    alt="logo"
                    style="
                      height: 200px;
                      width: 200px;
                      max-width: 200px;
                      object-fit: fill;
                    "
                  />
                </div>

                <div class="headerNe-lefy-side" style="width: 100%">
                  <h1
                    style="
                      letter-spacing: 0.25px;
                      font-size: 23px;
                      margin: 0;
                      margin-bottom: 3px;
                    "
                  >
                    {{ userG?.companyName }}
                  </h1>
                  <div
                    class="line"
                    style="position: relative; padding: 5px 0px 10px"
                  >
                    <span
                      style="
                        position: absolute;
                        right: 0;
                        width: 100%;
                        height: 2px;
                        background-color: #e5e5e5;
                        z-index: 1;
                      "
                    ></span>
                    <span
                      style="
                        position: absolute;
                        right: 0;
                        width: 70%;
                        height: 2px;
                        background-color: #ec1c24;
                        z-index: 2;
                      "
                    ></span>
                  </div>

                  <h1
                    style="
                      margin-bottom: 0;
                      font-size: 34px;
                      color: #0c8191;
                      margin-bottom: 0;
                      margin-top: 30px;
                      font-weight: 500;
                    "
                    [translate]="'name'"
                    [translateParams]="{
                      ar: ' طلب اجازه',
                      en: 'vacation Request'
                    }"
                  ></h1>
                </div>
              </div>

              <div style="margin-bottom: 10px">
                <p>
                  <span
                    [translate]="'name'"
                    [translateParams]="{
                      ar: 'التاريخ: ',
                      en: 'Date: '
                    }"
                  ></span>
                  <span> {{ datePrintabcence }}</span>
                </p>
              </div>

              <div class="services" style="width: 100%; margin-bottom: 10px">
                <div class="content">
                  <span style="font-size: 18px; font-weight: bold"
                    >بيانات الموظف</span
                  >
                  <table
                    style="
                      text-align: center;
                      vertical-align: middle;
                      width: 100%;
                    "
                  >
                    <thead>
                      <td
                        style="
                          font-size: 16px;
                          background-color: #fff;
                          padding: 14px 4px;
                          text-align: center;
                          color: #272727;
                          word-wrap: break-word;
                          border-inline-start: 1px dashed #0c8191;
                          border: 1px dashed #272727;
                          font-weight: 600;
                        "
                      >
                        رقم الموظف
                      </td>
                      <td
                        style="
                          font-size: 16px;
                          background-color: #fff;
                          padding: 14px 4px;
                          text-align: center;
                          color: #272727;
                          word-wrap: break-word;
                          border-inline-start: 1px dashed #0c8191;
                          border: 1px dashed #272727;
                          font-weight: 600;
                        "
                      >
                        اسم الموظف
                      </td>
                      <td
                        style="
                          font-size: 16px;
                          background-color: #f7f7f7;
                          padding: 14px 4px;
                          text-align: center;
                          color: #272727;
                          word-wrap: break-word;
                          border-inline-start: 1px dashed #0c8191;
                          border: 1px dashed #272727;
                          font-weight: 600;
                        "
                      >
                        الوظيفه
                      </td>
                      <td
                        style="
                          font-size: 16px;
                          background-color: #f7f7f7;
                          padding: 14px 4px;
                          text-align: center;
                          color: #272727;
                          word-wrap: break-word;
                          border-inline-start: 1px dashed #0c8191;
                          border: 1px dashed #272727;
                          font-weight: 600;
                        "
                      >
                        رقم الهويه
                      </td>
                      <td
                        style="
                          font-size: 16px;
                          background-color: #fff;
                          padding: 14px 4px;
                          text-align: center;
                          color: #272727;
                          word-wrap: break-word;
                          border-inline-start: 1px dashed #0c8191;
                          border: 1px dashed #272727;
                          font-weight: 600;
                        "
                      >
                        الفرع
                      </td>
                    </thead>
                    <tbody>
                      <tr>
                        <td
                          style="
                            background-color: #fff;
                            font-size: 15px;
                            font-weight: 500;
                            padding: 10px 0px;
                            color: #272727;
                            border-inline-start: 1px dashed #272727;
                            border-bottom: 1px dashed #272727;
                          "
                        >
                          {{ printmodel.employeeNo }}
                        </td>
                        <td
                          style="
                            background-color: #fff;
                            font-size: 15px;
                            font-weight: 500;
                            padding: 10px 0px;
                            color: #272727;
                            border-inline-start: 1px dashed #272727;
                            border-bottom: 1px dashed #272727;
                          "
                        >
                          {{ printmodel.employeeName }}
                        </td>
                        <td
                          style="
                            background-color: #fff;
                            font-size: 15px;
                            font-weight: 500;
                            padding: 10px 0px;
                            color: #272727;
                            border-inline-start: 1px dashed #272727;
                            border-bottom: 1px dashed #272727;
                          "
                        >
                          {{ printmodel.employeeJob }}
                        </td>
                        <td
                          style="
                            background-color: #fff;
                            font-size: 15px;
                            font-weight: 500;
                            padding: 10px 0px;
                            color: #272727;
                            border-inline-start: 1px dashed #272727;
                            border-bottom: 1px dashed #272727;
                          "
                        >
                          {{ printmodel.nationalitiId }}
                        </td>
                        <td
                          style="
                            background-color: #fff;
                            font-size: 15px;
                            font-weight: 500;
                            padding: 10px 0px;
                            color: #272727;
                            border-inline-start: 1px dashed #272727;
                            border-bottom: 1px dashed #272727;
                            border-left: 1px dashed #272727;
                          "
                        >
                          {{ printmodel.branchName }}
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <div class="services" style="width: 100%; margin-bottom: 10px">
                <div class="content">
                  <span style="font-size: 18px; font-weight: bold"
                    >بيانات الطلب</span
                  >
                  <table
                    style="
                      text-align: center;
                      vertical-align: middle;
                      width: 100%;
                    "
                  >
                    <thead>
                      <tr>
                        <td
                          style="
                            font-size: 16px;
                            background-color: #fff;
                            padding: 14px 4px;
                            text-align: center;
                            color: #272727;
                            word-wrap: break-word;
                            border-inline-start: 1px dashed #0c8191;
                            border: 1px dashed #272727;
                            font-weight: 600;
                          "
                        >
                          نوع الاجازه
                        </td>

                        <td
                          style="
                            font-size: 16px;
                            background-color: #fff;
                            padding: 14px 4px;
                            text-align: center;
                            color: #272727;
                            word-wrap: break-word;
                            border-inline-start: 1px dashed #0c8191;
                            border: 1px dashed #272727;
                            font-weight: 600;
                          "
                        >
                          {{ printmodel.vacatuinType }}
                        </td>
                      </tr>
                      <tr>
                        <td
                          style="
                            font-size: 16px;
                            background-color: #fff;
                            padding: 14px 4px;
                            text-align: center;
                            color: #272727;
                            word-wrap: break-word;
                            border-inline-start: 1px dashed #0c8191;
                            border: 1px dashed #272727;
                            font-weight: 600;
                          "
                        >
                          مدة الاجازه
                        </td>

                        <td
                          style="
                            font-size: 16px;
                            background-color: #fff;
                            padding: 14px 4px;
                            text-align: center;
                            color: #272727;
                            word-wrap: break-word;
                            border-inline-start: 1px dashed #0c8191;
                            border: 1px dashed #272727;
                            font-weight: 600;
                          "
                        >
                          {{ printmodel.timestr }}
                          <span> ، من {{ printmodel.from }}</span>
                          <span> - الي {{ printmodel.to }}</span>
                        </td>
                      </tr>
                      <tr>
                        <td
                          style="
                            font-size: 16px;
                            background-color: #fff;
                            padding: 14px 4px;
                            text-align: center;
                            color: #272727;
                            word-wrap: break-word;
                            border-inline-start: 1px dashed #0c8191;
                            border: 1px dashed #272727;
                            font-weight: 600;
                          "
                        >
                          حالة الاجازه
                        </td>

                        <td
                          style="
                            font-size: 16px;
                            background-color: #fff;
                            padding: 14px 4px;
                            text-align: center;
                            color: #272727;
                            word-wrap: break-word;
                            border-inline-start: 1px dashed #0c8191;
                            border: 1px dashed #272727;
                            font-weight: 600;
                          "
                        >
                          <span *ngIf="printmodel?.isDiscount == true"
                            >خصم من الراتب</span
                          >
                          <span *ngIf="printmodel?.isDiscount == false"
                            >لخصم من الرصيد</span
                          >
                        </td>
                      </tr>
                    </thead>
                  </table>
                </div>
              </div>

              <div class="services" style="width: 100%; margin-bottom: 10px">
                <div class="content">
                  <span style="font-size: 18px; font-weight: bold"
                    >قرار الادارة</span
                  >
                  <table
                    style="
                      text-align: center;
                      vertical-align: middle;
                      width: 100%;
                    "
                  >
                    <thead>
                      <tr>
                        <td
                          style="
                            font-size: 16px;
                            background-color: #fff;
                            padding: 14px 4px;
                            text-align: center;
                            color: #272727;
                            word-wrap: break-word;
                            border-inline-start: 1px dashed #0c8191;
                            border: 1px dashed #272727;
                            font-weight: 600;
                          "
                        >
                          قرار الادارة
                        </td>

                        <td
                          style="
                            font-size: 16px;
                            background-color: #fff;
                            padding: 14px 4px;
                            text-align: center;
                            color: #272727;
                            word-wrap: break-word;
                            border-inline-start: 1px dashed #0c8191;
                            border: 1px dashed #272727;
                            font-weight: 600;
                          "
                        >
                          {{ printmodel.status }}
                        </td>
                      </tr>

                      <tr>
                        <td
                          style="
                            font-size: 16px;
                            background-color: #fff;
                            padding: 14px 4px;
                            text-align: center;
                            color: #272727;
                            word-wrap: break-word;
                            border-inline-start: 1px dashed #0c8191;
                            border: 1px dashed #272727;
                            font-weight: 600;
                          "
                        >
                          مبرر القرار
                        </td>

                        <td
                          style="
                            font-size: 16px;
                            background-color: #fff;
                            padding: 14px 4px;
                            text-align: center;
                            color: #272727;
                            word-wrap: break-word;
                            border-inline-start: 1px dashed #0c8191;
                            border: 1px dashed #272727;
                            font-weight: 600;
                          "
                        >
                          {{ printmodel.vacationReason }}
                        </td>
                      </tr>
                    </thead>
                  </table>

                  <div
                    style="
                      display: grid;
                      grid-template-columns: auto auto auto auto;
                      padding-top: 20px;
                    "
                    class="text-center"
                  >
                    <div class="grid-item">
                      <p>
                        اعتماد الادارة<br />{{ printmodel.acceptedUser
                        }}<br />......................................
                        <br />
                        <br />
                        <span>التاريخ :</span> {{ printmodel.acceptedDate }}
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="mb-4" *ngIf="role != 'vacationclient'">
          <!-- accepted table -->
          <h4 class="text-start">
            {{ "Approved leave movement" | translate }}
          </h4>
          <div class="tables-data mt-3 overflow-hidden">
            <div class="overflow-auto">
              <table
                mat-table
                [dataSource]="dataSourceAcceptingVacation"
                matSort
                class="mat-elevation-z8 rounded-t-lg overflow-hidden w-max"
              >
                <!-- employeName column -->
                <ng-container matColumnDef="date">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    <span>{{ "Approval date" | translate }}</span>
                  </th>
                  <td mat-cell *matCellDef="let element">
                    <span>{{ element.date | date : "dd-MM-yyyy" }}</span>
                  </td>
                </ng-container>
                <!-- vacationType column -->
                <ng-container matColumnDef="employeeName">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    <span>{{ "Employee Name" | translate }}</span>
                  </th>
                  <td mat-cell *matCellDef="let element">
                    <span>{{ element?.employeeName }}</span>
                  </td>
                </ng-container>
                <!-- vacationStatus column -->
                <ng-container matColumnDef="vacationType">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    <span>{{ "the kind of holiday" | translate }}</span>
                  </th>
                  <td mat-cell *matCellDef="let element">
                    <span>{{ element?.vacationTypeName }}</span>
                  </td>
                </ng-container>
                <!-- manager column -->
                <ng-container matColumnDef="discoundType">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    <span>{{ "discound type" | translate }}</span>
                  </th>
                  <td mat-cell *matCellDef="let element">
                    <span *ngIf="element.isDiscount == true">
                      <i class="fa-solid fa-check text-green-500"></i>
                    </span>
                    <span *ngIf="element.isDiscount == false">
                      <i class="fa-solid fa-xmark text-red-500"></i>
                    </span>
                  </td>
                </ng-container>
                <!-- from column -->
                <ng-container matColumnDef="duration">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    <span>
                      {{ "duration" | translate }}
                    </span>
                  </th>
                  <td mat-cell *matCellDef="let element">
                    <span>{{ element?.timeStr }}</span>
                  </td>
                </ng-container>
                <!-- to column -->
                <ng-container matColumnDef="endDate">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    {{ "end date" | translate }}
                  </th>
                  <td mat-cell *matCellDef="let element">
                    <span>{{ element?.endDate | date : "dd-MM-yyyy" }}</span>
                  </td>
                </ng-container>

                <tr
                  mat-header-row
                  *matHeaderRowDef="displayedColumnsAcceptingVacation"
                ></tr>

                <tr
                  mat-row
                  *matRowDef="
                    let row;
                    columns: displayedColumnsAcceptingVacation
                  "
                  class="duration-300 hover:bg-slate-100"
                ></tr>
              </table>
            </div>
          </div>
        </div>
      </div>
      <div class="flex gap-2 justify-end">
        <button
          type="button"
          (click)="modal.dismiss()"
          class="btn btn-outline-secondary"
        >
          {{ "close" | translate }}
        </button>
      </div>
    </div>
  </ng-template>

  <!-- addNewVacation / edit -->
  <ng-template #addNewVacation let-modal>
    <div
      style="background-color: var(--base-color)"
      class="modal-header text-white flex justify-between items-center"
    >
      <h4 class="modal-title mb-0" id="modal-basic-title">
        <span>{{ "newVacationRequest" | translate }}</span>
      </h4>
      <button
        type="button"
        class="text-white m-0"
        aria-label="Close"
        (click)="modal.dismiss('Cross click')"
      >
        <i class="fa fa-close"></i>
      </button>
    </div>

    <div class="modal-body">
      <form #form="ngForm">
        <div class="row items-end">
          <!-- <div class="col-md-6 col-lg-4 mb-3">
          <div class="form-group">
            <label class="col-form-label">
              {{ "Employee Name" | translate }}</label
            >
            <ng-select
              class="w-full p-0"
              placeholder="{{ 'Chose' | translate }}"
              [(ngModel)]="modalvacationDetails.employeeId"
              [ngModelOptions]="{ standalone: true }"
              (ngModelChange)="Getemployeebyid()"

              name="user"
            >
              <ng-option *ngFor="let user of employeeworkerselect" [value]="user.id">{{
                user.name
              }}</ng-option>
            </ng-select>
          </div>
        </div> -->
          <div class="col-md-6 col-lg-4 mb-3">
            <div class="form-group">
              <label class="col-form-label">
                {{ "the kind of holiday" | translate }}</label
              >
              <ng-select
                class="w-full p-0"
                placeholder="{{ 'Chose' | translate }}"
                [(ngModel)]="modalvacationDetails.vacationType"
                [ngModelOptions]="{ standalone: true }"
                name="user"
              >
                <ng-option
                  *ngFor="let user of vacationtypeselect"
                  [value]="user.id"
                  >{{ user.name }}</ng-option
                >
              </ng-select>
            </div>
          </div>
          <div class="col-md-6 col-lg-4 mb-3">
            <div class="form-group">
              <label class="text-right col-form-label block">
                {{ "request Date Vacation" | translate }}
              </label>
              <div class="form-group timeInput">
                <input
                  [(ngModel)]="modalvacationDetails.date"
                  name="date"
                  type="text"
                  class="form-control"
                  bsDatepicker
                />
              </div>
            </div>
          </div>
          <div class="col-md-6 col-lg-4 mb-3">
            <div class="form-group">
              <label class="text-right col-form-label block">
                {{ "request Date Vacaion From" | translate }}
              </label>
              <div class="form-group timeInput">
                <input
                  [(ngModel)]="modalvacationDetails.from"
                  (ngModelChange)="Checkfromdate()"
                  name="from"
                  type="text"
                  class="form-control"
                  bsDatepicker
                />
              </div>
            </div>
          </div>
          <div class="col-md-6 col-lg-4 mb-3">
            <div class="form-group">
              <label class="text-right col-form-label block">
                {{ "request Date Vacaion To" | translate }}
              </label>
              <div class="form-group timeInput">
                <input
                  [(ngModel)]="modalvacationDetails.to"
                  (ngModelChange)="Checktodate()"
                  name="to"
                  type="text"
                  class="form-control"
                  bsDatepicker
                />
              </div>
            </div>
          </div>
          <div class="col-md-6 col-lg-4 mb-3">
            <div class="form-check form-switch me-3">
              <label
                class="form-check-label"
                for="discound"
                style="width: max-content"
              >
                {{ "Deduction from salary?" | translate }}
              </label>
              <input
                [(ngModel)]="modalvacationDetails.discound"
                (ngModelChange)="isdiscountchange()"
                class="form-check-input"
                type="checkbox"
                role="switch"
                id="discound"
                name="discound"
              />
            </div>
          </div>

          <div
            *ngIf="modalvacationDetails.vacationbalance"
            class="col-md-6 col-lg-4 mb-3"
          >
            <div class="form-group">
              <label class="text-right col-form-label block">
                {{ "vacation balance" | translate }}
              </label>
              <div class="form-group timeInput">
                <input
                  [(ngModel)]="modalvacationDetails.vacationbalance"
                  name="vacationbalance"
                  type="text"
                  class="form-control"
                />
              </div>
            </div>
          </div>

          <div
            *ngIf="modalvacationDetails.discountamount"
            class="col-md-6 col-lg-4 mb-3"
          >
            <div class="form-group">
              <label class="text-right col-form-label block">
                {{ "discount amount" | translate }}
              </label>
              <div class="form-group timeInput">
                <input
                  [(ngModel)]="modalvacationDetails.discountamount"
                  name="amount"
                  type="text"
                  class="form-control"
                />
              </div>
            </div>
          </div>

          <!-- <div class="col-md-6 col-lg-4 mb-3">
          <div class="upload">
            <file-upload class="h-full" [control]="control">
              <ng-template
                let-isFileDragDropAvailable="isFileDragDropAvailable"
                #placeholder
              >
                <div *ngIf="control.size === 0">
                  <div class="icon">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      height="1em"
                      viewBox="0 0 640 512"
                    >
                      <path
                        d="M144 480C64.5 480 0 415.5 0 336c0-62.8 40.2-116.2 96.2-135.9c-.1-2.7-.2-5.4-.2-8.1c0-88.4 71.6-160 160-160c59.3 0 111 32.2 138.7 80.2C409.9 102 428.3 96 448 96c53 0 96 43 96 96c0 12.2-2.3 23.8-6.4 34.6C596 238.4 640 290.1 640 352c0 70.7-57.3 128-128 128H144zm79-217c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l39-39V392c0 13.3 10.7 24 24 24s24-10.7 24-24V257.9l39 39c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-80-80c-9.4-9.4-24.6-9.4-33.9 0l-80 80z"
                      />
                    </svg>
                  </div>

                  <div class="upload-text">
                    {{ "Add Image" | translate }}
                  </div>
                </div>
              </ng-template>

              <ng-template
                let-i="index"
                let-file="file"
                let-control="control"
                #item
              >
                <div class="overlay">
                  <span
                    class="delete-button"
                    (click)="control.removeFile(file)"
                  >
                    <svg viewBox="0 0 448 512">
                      <path
                        d="M32 464a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128H32zm272-256a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zM432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16z"
                      ></path>
                    </svg>
                  </span>
                  <img
                    class="max-h-44"
                    *ngIf="control.valid"
                    [src]="uploadedFile | async"
                  />
                </div>
              </ng-template>
            </file-upload>
          </div>
        </div> -->
        </div>
      </form>
      <div class="d-flex items-center justify-end gap-3 mt-4">
        <button
          type="button"
          class="btn bg-base text-white"
          [disabled]="form.invalid"
          (click)="SaveVacationWorkers()"
        >
          {{ "add" | translate }}
        </button>

        <button (click)="modal?.dismiss()" class="btn btn-outline-secondary">
          {{ "close" | translate }}
        </button>
      </div>
    </div>
  </ng-template>

  <!-- followLoanModal -->
  <ng-template #followLoanModal let-modal>
    <div
      style="background-color: var(--base-color)"
      class="modal-header text-white flex justify-between items-center"
    >
      <h4 class="modal-title mb-0" id="modal-basic-title">
        <span>{{ "Follow up on imprest" | translate }}</span>
      </h4>
      <button
        type="button"
        class="text-white m-0"
        aria-label="Close"
        (click)="modal.dismiss('Cross click')"
      >
        <i class="fa fa-close"></i>
      </button>
    </div>

    <div class="modal-body text-center">
      <div>
        <!-- wating table -->
        <div class="flex gap-3 justify-between items-center flex-wrap">
          <div class="text-start w-fit" *ngIf="role != 'client'">
            <label
              class="col-form-label"
              [translate]="'name'"
              [translateParams]="{
                ar: 'فرز حسب',
                en: 'Sort By'
              }"
            >
            </label>
            <ng-select
              class="w-full p-0"
              placeholder="{{ 'Chose' | translate }}"
              name="user"
              [(ngModel)]="watingimpresttype"
              (ngModelChange)="getwaitingImprests()"
            >
              <ng-option [value]="1">طلب جديد</ng-option>
              <ng-option [value]="2">تم الموافقة علي السلفه</ng-option>
              <ng-option [value]="3">تم رفض السلفه</ng-option>
              <ng-option [value]="4">مراجعه</ng-option>
              <ng-option [value]="5">تاجيل</ng-option>
            </ng-select>
          </div>
          <button
            *ngIf="role == 'client'"
            type="button"
            class="btn bg-base text-white"
            (click)="open(addNewLoan)"
          >
            {{ "new request" | translate }}
          </button>
        </div>
        <div class="my-4">
          <div class="row">
            <h4 class="text-start col-2">
              {{ "Requests pending approval" | translate }}
            </h4>

            <span
              *ngIf="role != 'client'"
              style="padding: 0.5rem !important"
              class="p-3 rounded-lg bg-red-200 col-10"
              [translate]="'name'"
              [translateParams]="{
                ar: 'يستحسن اتخاذ قرار بخصوص الطلبات المقدمة من الموظفين ،حيث يتم تحديث الطلب لدي الموظف بأن طلبه(تقديم طلب)',
                en: 'يستحسن اتخاذ قرار بخصوص الطلبات المقدمة من الموظفين ،حيث يتم تحديث الطلب لدي الموظف بأن طلبه(تقديم طلب)'
              }"
            >
            </span>
          </div>
          <div class="tables-data mt-3">
            <div
              style="
                overflow-x: auto !important;
                overflow-y: visible !important;
              "
            >
              <table
                mat-table
                [dataSource]="dataSourceWaitingImprest"
                matSort
                class="rounded-t-lg w-max"
              >
                <!-- employeName column -->
                <ng-container matColumnDef="date">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    <span>{{ "date" | translate }}</span>
                  </th>
                  <td
                    mat-cell
                    *matCellDef="let element"
                    (click)="GetAllLoanDetails(element.loanId, element.monthNo)"
                  >
                    <span>{{ element.date | date : "dd-MM-yyyy" }}</span>
                  </td>
                </ng-container>
                <!-- vacationType column -->
                <ng-container matColumnDef="employeeName">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    <span>{{ "Employee Name" | translate }}</span>
                  </th>
                  <td
                    mat-cell
                    *matCellDef="let element"
                    (click)="GetAllLoanDetails(element.loanId, element.monthNo)"
                  >
                    <span>{{ element.employeeName }}</span>
                  </td>
                </ng-container>
                <!-- branch column -->
                <ng-container matColumnDef="branch">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    <span>{{ "branch" | translate }}</span>
                  </th>
                  <td
                    mat-cell
                    *matCellDef="let element"
                    (click)="GetAllLoanDetails(element.loanId, element.monthNo)"
                  >
                    <span>{{ element.branchName }}</span>
                  </td>
                </ng-container>
                <!-- amount column -->
                <ng-container matColumnDef="amount">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    <span>{{ "amount" | translate }}</span>
                  </th>
                  <td
                    mat-cell
                    *matCellDef="let element"
                    (click)="GetAllLoanDetails(element.loanId, element.monthNo)"
                  >
                    <span>{{ element.amount }}</span>
                  </td>
                </ng-container>
                <!-- installmentNumber column -->
                <ng-container matColumnDef="installmentNumber">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    <span>
                      {{ "Number of installment" | translate }}
                    </span>
                  </th>
                  <td
                    mat-cell
                    *matCellDef="let element"
                    (click)="GetAllLoanDetails(element.loanId, element.monthNo)"
                  >
                    <span>{{ element.monthNo }}</span>
                  </td>
                </ng-container>
                <!-- startDate column -->
                <ng-container matColumnDef="startDate">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    {{ "The start date of the withholding" | translate }}
                  </th>
                  <td
                    mat-cell
                    *matCellDef="let element"
                    (click)="GetAllLoanDetails(element.loanId, element.monthNo)"
                  >
                    <span>{{ element.startDate | date : "dd-MM-yyyy" }}</span>
                  </td>
                </ng-container>
                <!-- dicesion column -->
                <ng-container matColumnDef="dicesion">
                  <th
                    mat-header-cell
                    *matHeaderCellDef
                    mat-sort-header
                    colspan="2"
                  >
                    <span>{{ "dicesion" | translate }}</span>
                  </th>
                  <td mat-cell *matCellDef="let element">
                    <div
                      *ngIf="role == 'client'"
                      class="flex items-center justify-center gap-4"
                    >
                      <!-- <span
                        [translate]="'name'"
                        [translateParams]="{
                          ar: 'تم قبول الطلب',
                          en: 'Accepted'
                        }"
                      ></span> -->
                      <span>{{ element.loanStatusName }}</span>

                      <button
                        (click)="setdataprint(element); Printloan()"
                        class="p-2 bg-sky-100 hover:bg-sky-500 rounded-lg duration-300 hover:text-white w-10"
                      >
                        <i class="fa-solid fa-print"></i>
                      </button>
                    </div>
                    <select
                      *ngIf="role != 'client'"
                      class="w-full form-select"
                      name="user"
                      (change)="openModal($event, element, 'loan')"
                    >
                      <option [value]="0">
                        {{ "Chose" | translate }}
                      </option>
                      <option [value]="2">
                        {{ "Acceptance" | translate }}
                      </option>
                      <option [value]="3">{{ "to reject" | translate }}</option>
                      <option [value]="4">{{ "review" | translate }}</option>
                      <option [value]="5">{{ "delayed" | translate }}</option>
                    </select>
                  </td>
                  <td>dawd</td>
                </ng-container>

                <tr
                  mat-header-row
                  *matHeaderRowDef="displayedColumnsWaitingImprest"
                ></tr>

                <tr
                  mat-row
                  *matRowDef="let row; columns: displayedColumnsWaitingImprest"
                  class="duration-300 hover:bg-slate-100"
                ></tr>
              </table>
            </div>
          </div>

          <div style="display: none">
            <div
              id="reportloan"
              [ngStyle]="{ direction: lang == 'ar' ? 'rtl' : 'ltr' }"
            >
              <div
                class="report-header"
                style="
                  display: flex;
                  align-items: center;
                  gap: 100px;
                  padding: 3px 0px;
                  margin-bottom: 20px;
                "
              >
                <div class="headerNe-right-side">
                  <img
                    *ngIf="logourl"
                    src="{{ logourl }}"
                    alt="logo"
                    style="
                      height: 200px;
                      width: 200px;
                      max-width: 200px;
                      object-fit: fill;
                    "
                  />
                </div>

                <div class="headerNe-lefy-side" style="width: 100%">
                  <h1
                    style="
                      letter-spacing: 0.25px;
                      font-size: 23px;
                      margin: 0;
                      margin-bottom: 3px;
                    "
                  >
                    {{ userG?.companyName }}
                  </h1>
                  <div
                    class="line"
                    style="position: relative; padding: 5px 0px 10px"
                  >
                    <span
                      style="
                        position: absolute;
                        right: 0;
                        width: 100%;
                        height: 2px;
                        background-color: #e5e5e5;
                        z-index: 1;
                      "
                    ></span>
                    <span
                      style="
                        position: absolute;
                        right: 0;
                        width: 70%;
                        height: 2px;
                        background-color: #ec1c24;
                        z-index: 2;
                      "
                    ></span>
                  </div>

                  <h1
                    style="
                      margin-bottom: 0;
                      font-size: 34px;
                      color: #0c8191;
                      margin-bottom: 0;
                      margin-top: 30px;
                      font-weight: 500;
                    "
                    [translate]="'name'"
                    [translateParams]="{
                      ar: ' طلب سلفه',
                      en: 'Loan Request'
                    }"
                  ></h1>
                </div>
              </div>

              <div style="margin-bottom: 10px">
                <p>
                  <span
                    [translate]="'name'"
                    [translateParams]="{
                      ar: 'التاريخ: ',
                      en: 'Date: '
                    }"
                  ></span>
                  <span> {{ datePrintabcence }}</span>
                </p>
              </div>

              <div class="services" style="width: 100%; margin-bottom: 10px">
                <div class="content">
                  <span style="font-size: 18px; font-weight: bold"
                    >بيانات الموظف</span
                  >
                  <table
                    style="
                      text-align: center;
                      vertical-align: middle;
                      width: 100%;
                    "
                  >
                    <thead>
                      <td
                        style="
                          font-size: 16px;
                          background-color: #fff;
                          padding: 14px 4px;
                          text-align: center;
                          color: #272727;
                          word-wrap: break-word;
                          border-inline-start: 1px dashed #0c8191;
                          border: 1px dashed #272727;
                          font-weight: 600;
                        "
                      >
                        رقم الموظف
                      </td>
                      <td
                        style="
                          font-size: 16px;
                          background-color: #fff;
                          padding: 14px 4px;
                          text-align: center;
                          color: #272727;
                          word-wrap: break-word;
                          border-inline-start: 1px dashed #0c8191;
                          border: 1px dashed #272727;
                          font-weight: 600;
                        "
                      >
                        اسم الموظف
                      </td>
                      <td
                        style="
                          font-size: 16px;
                          background-color: #f7f7f7;
                          padding: 14px 4px;
                          text-align: center;
                          color: #272727;
                          word-wrap: break-word;
                          border-inline-start: 1px dashed #0c8191;
                          border: 1px dashed #272727;
                          font-weight: 600;
                        "
                      >
                        الوظيفه
                      </td>
                      <td
                        style="
                          font-size: 16px;
                          background-color: #f7f7f7;
                          padding: 14px 4px;
                          text-align: center;
                          color: #272727;
                          word-wrap: break-word;
                          border-inline-start: 1px dashed #0c8191;
                          border: 1px dashed #272727;
                          font-weight: 600;
                        "
                      >
                        رقم الهويه
                      </td>

                      <td
                        style="
                          font-size: 16px;
                          background-color: #f7f7f7;
                          padding: 14px 4px;
                          text-align: center;
                          color: #272727;
                          word-wrap: break-word;
                          border-inline-start: 1px dashed #0c8191;
                          border: 1px dashed #272727;
                          font-weight: 600;
                        "
                      >
                        القسم
                      </td>
                      <td
                        style="
                          font-size: 16px;
                          background-color: #fff;
                          padding: 14px 4px;
                          text-align: center;
                          color: #272727;
                          word-wrap: break-word;
                          border-inline-start: 1px dashed #0c8191;
                          border: 1px dashed #272727;
                          font-weight: 600;
                        "
                      >
                        الفرع
                      </td>
                    </thead>
                    <tbody>
                      <tr>
                        <td
                          style="
                            background-color: #fff;
                            font-size: 15px;
                            font-weight: 500;
                            padding: 10px 0px;
                            color: #272727;
                            border-inline-start: 1px dashed #272727;
                            border-bottom: 1px dashed #272727;
                          "
                        >
                          {{ printmodelloan.employeeNo }}
                        </td>
                        <td
                          style="
                            background-color: #fff;
                            font-size: 15px;
                            font-weight: 500;
                            padding: 10px 0px;
                            color: #272727;
                            border-inline-start: 1px dashed #272727;
                            border-bottom: 1px dashed #272727;
                          "
                        >
                          {{ printmodelloan.employeeName }}
                        </td>
                        <td
                          style="
                            background-color: #fff;
                            font-size: 15px;
                            font-weight: 500;
                            padding: 10px 0px;
                            color: #272727;
                            border-inline-start: 1px dashed #272727;
                            border-bottom: 1px dashed #272727;
                          "
                        >
                          {{ printmodelloan.employeeJob }}
                        </td>
                        <td
                          style="
                            background-color: #fff;
                            font-size: 15px;
                            font-weight: 500;
                            padding: 10px 0px;
                            color: #272727;
                            border-inline-start: 1px dashed #272727;
                            border-bottom: 1px dashed #272727;
                          "
                        >
                          {{ printmodelloan.nationalitiId }}
                        </td>
                        <td
                          style="
                            background-color: #fff;
                            font-size: 15px;
                            font-weight: 500;
                            padding: 10px 0px;
                            color: #272727;
                            border-inline-start: 1px dashed #272727;
                            border-bottom: 1px dashed #272727;
                          "
                        >
                          {{ printmodelloan.departmentName }}
                        </td>
                        <td
                          style="
                            background-color: #fff;
                            font-size: 15px;
                            font-weight: 500;
                            padding: 10px 0px;
                            color: #272727;
                            border-inline-start: 1px dashed #272727;
                            border-bottom: 1px dashed #272727;
                            border-left: 1px dashed #272727;
                          "
                        >
                          {{ printmodelloan.branchName }}
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <div class="services" style="width: 100%; margin-bottom: 10px">
                <div class="content">
                  <span style="font-size: 18px; font-weight: bold"
                    >بيانات الطلب</span
                  >
                  <table
                    style="
                      text-align: center;
                      vertical-align: middle;
                      width: 100%;
                    "
                  >
                    <thead>
                      <tr>
                        <td
                          style="
                            font-size: 16px;
                            background-color: #fff;
                            padding: 14px 4px;
                            text-align: center;
                            color: #272727;
                            word-wrap: break-word;
                            border-inline-start: 1px dashed #0c8191;
                            border: 1px dashed #272727;
                            font-weight: 600;
                          "
                        >
                          تاريخ تقديم الطلب
                        </td>

                        <td
                          style="
                            font-size: 16px;
                            background-color: #fff;
                            padding: 14px 4px;
                            text-align: center;
                            color: #272727;
                            word-wrap: break-word;
                            border-inline-start: 1px dashed #0c8191;
                            border: 1px dashed #272727;
                            font-weight: 600;
                          "
                        >
                          {{ printmodelloan.date }}
                        </td>
                      </tr>
                      <tr>
                        <td
                          style="
                            font-size: 16px;
                            background-color: #fff;
                            padding: 14px 4px;
                            text-align: center;
                            color: #272727;
                            word-wrap: break-word;
                            border-inline-start: 1px dashed #0c8191;
                            border: 1px dashed #272727;
                            font-weight: 600;
                          "
                        >
                          المبلغ
                        </td>

                        <td
                          style="
                            font-size: 16px;
                            background-color: #fff;
                            padding: 14px 4px;
                            text-align: center;
                            color: #272727;
                            word-wrap: break-word;
                            border-inline-start: 1px dashed #0c8191;
                            border: 1px dashed #272727;
                            font-weight: 600;
                          "
                        >
                          {{ printmodelloan.amount }}
                        </td>
                      </tr>
                      <tr>
                        <td
                          style="
                            font-size: 16px;
                            background-color: #fff;
                            padding: 14px 4px;
                            text-align: center;
                            color: #272727;
                            word-wrap: break-word;
                            border-inline-start: 1px dashed #0c8191;
                            border: 1px dashed #272727;
                            font-weight: 600;
                          "
                        >
                          عدد الاقساط
                        </td>

                        <td
                          style="
                            font-size: 16px;
                            background-color: #fff;
                            padding: 14px 4px;
                            text-align: center;
                            color: #272727;
                            word-wrap: break-word;
                            border-inline-start: 1px dashed #0c8191;
                            border: 1px dashed #272727;
                            font-weight: 600;
                          "
                        >
                          {{ printmodelloan.monthNo }}
                        </td>
                      </tr>

                      <tr>
                        <td
                          style="
                            font-size: 16px;
                            background-color: #fff;
                            padding: 14px 4px;
                            text-align: center;
                            color: #272727;
                            word-wrap: break-word;
                            border-inline-start: 1px dashed #0c8191;
                            border: 1px dashed #272727;
                            font-weight: 600;
                          "
                        >
                          تاريخ بداية الاستقطاع
                        </td>

                        <td
                          style="
                            font-size: 16px;
                            background-color: #fff;
                            padding: 14px 4px;
                            text-align: center;
                            color: #272727;
                            word-wrap: break-word;
                            border-inline-start: 1px dashed #0c8191;
                            border: 1px dashed #272727;
                            font-weight: 600;
                          "
                        >
                          {{ printmodelloan.startDate }}
                        </td>
                      </tr>
                    </thead>
                  </table>
                </div>
              </div>

              <div class="services" style="width: 100%; margin-bottom: 10px">
                <div class="content">
                  <span style="font-size: 18px; font-weight: bold"
                    >قرار الادارة</span
                  >
                  <table
                    style="
                      text-align: center;
                      vertical-align: middle;
                      width: 100%;
                    "
                  >
                    <thead>
                      <tr>
                        <td
                          style="
                            font-size: 16px;
                            background-color: #fff;
                            padding: 14px 4px;
                            text-align: center;
                            color: #272727;
                            word-wrap: break-word;
                            border-inline-start: 1px dashed #0c8191;
                            border: 1px dashed #272727;
                            font-weight: 600;
                          "
                        >
                          قرار الادارة
                        </td>

                        <td
                          style="
                            font-size: 16px;
                            background-color: #fff;
                            padding: 14px 4px;
                            text-align: center;
                            color: #272727;
                            word-wrap: break-word;
                            border-inline-start: 1px dashed #0c8191;
                            border: 1px dashed #272727;
                            font-weight: 600;
                          "
                        >
                          {{ printmodelloan.loanStatusName }}
                        </td>
                      </tr>

                      <tr>
                        <td
                          style="
                            font-size: 16px;
                            background-color: #fff;
                            padding: 14px 4px;
                            text-align: center;
                            color: #272727;
                            word-wrap: break-word;
                            border-inline-start: 1px dashed #0c8191;
                            border: 1px dashed #272727;
                            font-weight: 600;
                          "
                        >
                          مبرر القرار
                        </td>

                        <td
                          style="
                            font-size: 16px;
                            background-color: #fff;
                            padding: 14px 4px;
                            text-align: center;
                            color: #272727;
                            word-wrap: break-word;
                            border-inline-start: 1px dashed #0c8191;
                            border: 1px dashed #272727;
                            font-weight: 600;
                          "
                        >
                          {{ printmodelloan.note }}
                        </td>
                      </tr>
                    </thead>
                  </table>

                  <div
                    style="
                      display: grid;
                      grid-template-columns: auto auto auto auto;
                      padding-top: 20px;
                    "
                    class="text-center"
                  >
                    <div class="grid-item">
                      <p>
                        اعتماد الادارة<br />{{ printmodelloan.acceptUser
                        }}<br />......................................
                        <br />
                        <br />
                        <span>التاريخ :</span> {{ printmodelloan.acceptedDate }}
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <hr class="my-3" />

        <div class="mb-4">
          <!-- accepted table -->
          <div
            class="flex items-center justify-start flex-wrap"
            style="gap: 7rem"
          >
            <h4 class="mb-0 text-start">
              {{ "imprestMovement" | translate }}
            </h4>
            <p class="mb-0 text-blue-500">
              <span>{{ "Number of installment" | translate }}:</span>
              <span>{{ statisticLoan.MonthNo }}</span>
            </p>
            <p class="mb-0 text-green-500">
              <span>{{ "TotalPayments" | translate }}:</span>
              <span>{{ statisticLoan.AmountPayed }}</span>
            </p>
            <p class="mb-0 text-red-500">
              <span>{{ "Remaining Amount" | translate }}:</span>
              <span>{{ statisticLoan.AmountNotPayed }}</span>
            </p>
          </div>
          <div class="tables-data mt-3 overflow-hidden">
            <div class="overflow-auto">
              <table
                mat-table
                [dataSource]="dataSourceAcceptingImprest"
                matSort
                class="mat-elevation-z8 rounded-t-lg overflow-hidden w-max"
              >
                <ng-container matColumnDef="imprestNo">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    <span>
                      {{ "imprest No" | translate }}
                    </span>
                  </th>
                  <td mat-cell *matCellDef="let element">
                    <span>{{ element?.loanId }}</span>
                  </td>
                </ng-container>
                <ng-container matColumnDef="date">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    <span>
                      {{ "Approval date" | translate }}
                    </span>
                  </th>
                  <td mat-cell *matCellDef="let element">
                    <span>{{ element?.date | date : "dd-MM-yyyy" }}</span>
                  </td>
                </ng-container>
                <ng-container matColumnDef="imprestStatus">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    <span>
                      {{ "imprest status" | translate }}
                    </span>
                  </th>
                  <td mat-cell *matCellDef="let element">
                    <span>{{ element?.finished }}</span>
                  </td>
                </ng-container>
                <ng-container matColumnDef="employeeName">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    <span>
                      {{ "Employee Name" | translate }}
                    </span>
                  </th>
                  <td mat-cell *matCellDef="let element">
                    <span>{{ element?.employeeName }}</span>
                  </td>
                </ng-container>
                <ng-container matColumnDef="amount">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    <span>
                      {{ "the amount" | translate }}
                    </span>
                  </th>
                  <td mat-cell *matCellDef="let element">
                    <span>{{ element?.amount }}</span>
                  </td>
                </ng-container>

                <tr
                  mat-header-row
                  *matHeaderRowDef="displayedColumnsAcceptingImprest"
                ></tr>

                <tr
                  mat-row
                  *matRowDef="
                    let row;
                    columns: displayedColumnsAcceptingImprest
                  "
                  class="duration-300 hover:bg-slate-100"
                ></tr>
              </table>
            </div>
          </div>
        </div>
      </div>
      <div class="flex gap-2 justify-end">
        <button
          type="button"
          (click)="modal.dismiss()"
          class="btn btn-outline-secondary"
        >
          {{ "close" | translate }}
        </button>
      </div>
    </div>
  </ng-template>

  <ng-template #addNewLoan let-modal>
    <div
      style="background-color: var(--base-color)"
      class="modal-header text-white flex justify-between items-center"
    >
      <h4 class="modal-title mb-0" id="modal-basic-title">
        <span
          [translate]="'name'"
          [translateParams]="{
            ar: 'طلب سلفة جديد',
            en: 'Predecessor Application '
          }"
        >
        </span>
      </h4>
      <button
        type="button"
        class="text-white m-0"
        aria-label="Close"
        (click)="modal.dismiss('Cross click')"
      >
        <i class="fa fa-close"></i>
      </button>
    </div>

    <div class="modal-body">
      <form #form="ngForm">
        <div class="row items-end">
          <!-- <div class="col-md-6 col-lg-4 mb-3">
            <div class="form-group">
              <label class="col-form-label">
                {{ "Employee Name" | translate }}</label
              >

              <ng-select #EmployeeIdW  [items]="EmployeeWorker" bindLabel="name" bindValue="id" [clearable]="true"
              class="w-full p-0" ngModel id="employeeIdw" name="employeeIdw" placeholder="{{ 'Chose' | translate }}"
              >
              </ng-select>
            </div>
          </div> -->

          <div class="col-md-6 col-lg-4 mb-3">
            <div class="form-group">
              <label class="text-right col-form-label block">
                {{ "Chose Date" | translate }}
              </label>
              <div class="form-group timeInput">
                <input
                  [(ngModel)]="modalDetails.date"
                  name="date"
                  type="text"
                  class="form-control"
                  bsDatepicker
                />
              </div>
            </div>
          </div>

          <div class="col-md-6 col-lg-4 mb-3">
            <div class="form-group">
              <label class="text-right col-form-label block">
                {{ "amount" | translate }}
              </label>
              <div class="form-group timeInput">
                <input
                  [(ngModel)]="modalDetails.amount"
                  name="amount"
                  type="text"
                  class="form-control"
                />
              </div>
            </div>
          </div>

          <div class="col-md-6 col-lg-4 mb-3">
            <div class="form-group">
              <label class="text-right col-form-label block">
                {{ "Number of installment" | translate }}
              </label>
              <div class="form-group timeInput">
                <input
                  [(ngModel)]="modalDetails.monthNos"
                  name="monthNo"
                  type="text"
                  class="form-control"
                />
              </div>
            </div>
          </div>

          <div class="col-md-6 col-lg-4 mb-3">
            <div class="form-group">
              <label class="text-right col-form-label block">
                {{ "start from" | translate }}
              </label>

              <ng-select
                #startMonths
                [items]="Months"
                bindLabel="Name"
                bindValue="id"
                [clearable]="true"
                class="w-full p-0"
                ngModel
                name="startMonths"
                id="startMonths"
                placeholder="{{ 'Chose' | translate }}"
              >
              </ng-select>
              <!-- <ng-select [(ngModel)]="modalDetails.from" name="from">
                <ng-option *ngFor="let item of users" [value]="item.id">
                  {{ item.Name }}
                </ng-option>
              </ng-select> -->
            </div>
          </div>

          <div class="col-md-12 mb-3">
            <div class="form-group">
              <label class="text-right col-form-label block">
                {{ "details" | translate }}
              </label>
              <textarea
                class="form-control"
                name="note"
                [(ngModel)]="modalDetails.note"
                style="min-height: 50px"
              ></textarea>
            </div>
          </div>
        </div>
      </form>
      <div class="d-flex items-center justify-end gap-3 mt-4">
        <button
          type="button"
          class="btn bg-base text-white"
          [disabled]="form.invalid"
          (click)="
            AddImprestRequest(form.value); modal.close('Save click', 'end')
          "
        >
          {{ modalDetails?.id ? ("edit" | translate) : ("add" | translate) }}
        </button>

        <button (click)="modal?.dismiss()" class="btn btn-outline-secondary">
          {{ "close" | translate }}
        </button>
      </div>
    </div>
  </ng-template>

  <!-- taskDetailsModal -->
  <ng-template #taskDetailsModal let-modal>
    <div
      style="background-color: var(--base-color)"
      class="modal-header text-white flex justify-between items-center"
    >
      <h4 class="modal-title mb-0" id="modal-basic-title">
        <span
          [translate]="'name'"
          [translateParams]="{
            ar: 'تفاصيل المهمة',
            en: 'Task Details'
          }"
        >
        </span>
        <span style="margin-right: 10px" *ngIf="!TaskData.Obj?.settingId"
          >مهمة يدوية بواسطة :
        </span>
        <span *ngIf="!TaskData.Obj?.settingId">
          {{ TaskData.Obj?.addedTaskName }}</span
        >
        <span style="margin-right: 10px" *ngIf="TaskData.Obj?.settingId">{{
          TaskData.Obj?.settingName
        }}</span>
      </h4>
      <button
        type="button"
        class="text-white m-0"
        aria-label="Close"
        (click)="modal.dismiss('Cross click')"
      >
        <i class="fa fa-close"></i>
      </button>
    </div>

    <div class="modal-body">
      <div *ngIf="selectedTask" class="tasks-page custome-task">
        <p class="mb-4">
          <span style="margin-inline-end: 20px"
            >{{ "taskName" | translate }}
          </span>
          <!-- <span>{{ selectedTask?.customer }}</span> -->
          <span>{{ TaskData.Obj?.descriptionAr }}</span>
        </p>

        <div class="d-flex items-center justify-between flex-wrap gap-8 fs-6">
          <p class="mb-3">
            <span style="margin-inline-end: 20px"
              >{{ "status" | translate }}
            </span>
            <span>{{ TaskData.Obj?.statusName }}</span>
          </p>
          <p class="mb-4">
            <span style="margin-inline-end: 20px"
              >{{ "Duration" | translate }}
            </span>
            <span>{{ TaskData.Obj?.timeStr }}</span>

            <span style="margin-inline-end: 20px"
              >{{ "Project name/description" | translate }}
            </span>
            <span>{{ TaskData.Obj?.projectDescription }}</span>
          </p>
          <!-- <div class="chart mb-4" style="max-width: 150px">
            <ngx-gauge
              type="full"
              value="{{ percentage }}"
              label="progress"
              append="%"
              thick="10"
              foregroundColor="#2980b9"
            ></ngx-gauge>
          </div> -->
        </div>

        <!-- <div class="mb-4">
          <mat-progress-bar
            mode="determinate"
            value="41"
            style="height: 12px"
          ></mat-progress-bar>
        </div> -->

        <div class="table">
          <div class="date flex items-center justify-between">
            <p>
              <span>{{ "From" | translate }}</span>
              <span>{{ TaskData.TaskTimeFrom_Merge }}</span>
            </p>
            <p *ngIf="TaskData.notesStrVac"
            style="text-align: center;color: red;" class="p-1 bg-red-100">
              <span>{{ TaskData.notesStrVac }}</span>
            </p>
            <p>
              <span>{{ "To" | translate }}</span>
              <span>{{ TaskData.TaskTimeTo_Merge }}</span>
            </p>
          </div>

          <table
            class="table table-responsive table-striped table-bordered text-center"
            style="vertical-align: middle; font-size: 14px"
          >
            <thead
              class="bg-base text-white"
              style="line-height: 30px; font-size: 13px"
            >
              <tr>
                <th>{{ "Assigned to" | translate }}</th>
                <th>{{ "Project Number" | translate }}</th>
                <th>{{ "اسم المرحلة" | translate }}</th>
                <th>{{ "Customer Name" | translate }}</th>
                <th>{{ "task status" | translate }}</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>{{ TaskData.Obj?.userName }}</td>
                <td>{{ TaskData.Obj?.projectNumber }}</td>
                <!-- <td>{{ TaskData.Obj?.mainPhaseName }}</td> -->
                <td>{{ TaskData.Obj?.subPhaseName }}</td>

                <td>{{ TaskData.Obj?.clientName }}</td>
                <td>{{ TaskData.priorty }}</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="my-2 flex items-center justify-between flex-wrap">
          <div class="flex justify-start items-center gap-4">
            <button
              [disabled]="
                TaskData.Obj?.status == 1 || TaskData.Obj?.status == 3
              "
              type="button"
              mat-button
              mat-raise-button
              class="bg-success text-white px-4 py-2"
              style="
                padding: 2px 14px !important;
                width: max-content;
                height: auto;
              "
              (click)="
                open(endTaskModal, null, null, null, 'task'); setpopup(modal)
              "
            >
              {{ "end task" | translate }}
            </button>
            <p class="flex items-center mb-0 relative">
              {{ "Mission Completion Ratio" | translate }}
              <input
                [disabled]="
                  TaskData.Obj?.status == 1 || TaskData.Obj?.status == 3
                "
                type="number"
                max
                name="missionRatio"
                class="form-control"
                (keyup)="disablesavingpercentage()"
                [(ngModel)]="percentage"
              />
              <span class="percent absolute">%</span>
            </p>

            <button
              [disabled]="
                TaskData.Obj?.status == 1 ||
                TaskData.Obj?.status == 3 ||
                isdisabled == 0 ||
                percentage == '' ||
                percentage == null
              "
              type="button"
              mat-button
              mat-raise-button
              class="bg-success text-white px-4 py-2"
              style="
                padding: 2px 14px !important;
                width: max-content;
                height: auto;
              "
              (click)="
                open(PercentageTaskModal, 'savepercentage', null, null, 'task')
              "
            >
              حفظ النسبه
            </button>
          </div>
          <div class="flex justify-end items-center gap-2 taskBtns">

            <button [disabled]="!userG?.userPrivileges.includes(1124)"
                                  type="button"
                                  mat-button
                                  mat-raise-button
                                  class="bg-sky-100 px-4 py-2"
                                  style="
                                    padding: 2px 14px !important;
                                    width: max-content;
                                    height: auto;
                                  "
                                  (click)="
                                     open(
                                      projectDetailsModal,
                                      null,
                                      TaskData.Obj,
                                      null,
                                      'details2'
                                    )
                                  "
                                >
                                  استمارة المشروع
                                </button>

            <button
              [disabled]="
                TaskData.Obj?.status == 1 || TaskData.Obj?.status == 3
              "
              class="btn btn-outline-success"
              (click)="open(mapModal, null, null, null, 'task')"
            >
              <i class="fa fa-map-marker"></i>
            </button>

            <button
              *ngIf="TaskData.Obj?.status == 2"
              type="button"
              class="btn btn-outline-secondary rounded-lg"
              (click)="open(stopTaskModal, null, null, null, 'task')"
            >
              <i class="fa fa-pause"></i>
            </button>
            <button
              *ngIf="TaskData.Obj?.status != 2"
              type="button"
              class="btn btn-outline-secondary p-2 rounded-lg w-10"
              (click)="open(playTaskModal, null, null, null, 'task')"
            >
              <i class="fa fa-play"></i>
            </button>

            <button
              *ngIf="TaskFilesCount > 0"
              type="button"
              class="min-w-max p-2 bg-sky-100 hover:bg-sky-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
              (click)="
                GetAllProjectRequirementByTaskId(TaskData.Obj);
                open(showtasksfiles, null, null, null, 'openfile')
              "
            >
              <i class="fa-solid fa-eye"></i>
            </button>

            <button
              [disabled]="
                TaskData.Obj?.status == 1 || TaskData.Obj?.status == 3
              "
              type="button"
              class="t-Uploading-Project btn btn-sm waves-effect p-0"
              (click)="open(uploadFileModal, null, null, null, 'task')"
              style="filter: grayscale(1)"
            >
              <img
                src="/assets/icons/upload-cloud-line@2x.png"
                alt="upload icon"
                class="uploadingIcon"
              />
            </button>

            <!-- <button
              type="button"
              class="btn btn-outline-secondary rounded-lg"
              (click)="open(deleteTaskModal, 'infoAction')"
            >
              <i class="fa fa-trash"></i>
            </button> -->
            <button
              *ngIf="IsadminTask == 0"
              [disabled]="
                TaskData.Obj?.status == 1 || TaskData.Obj?.status == 3
              "
              type="button"
              class="btn btn-outline-secondary rounde mx-1d-lg"
              (click)="open(requestextendTaskModal, null, null, null, 'task')"
            >
              <i class="fa fa-clock"></i>
            </button>
            <button
              *ngIf="IsadminTask == 1"
              [disabled]="
                TaskData.Obj?.status == 1 || TaskData.Obj?.status == 3
              "
              type="button"
              class="btn btn-outline-secondary rounde mx-1d-lg"
              (click)="open(extendTaskModal, null, null, null, 'task')"
            >
              <i class="fa fa-clock"></i>
            </button>
            <!--Convert Modal-->
            <button
              *ngIf="IsadminTask == 0"
              [disabled]="
                TaskData.Obj?.status == 1 || TaskData.Obj?.status == 3
              "
              type="button"
              class="btn btn-outline-secondary rounded-lg mx-1"
              (click)="
                open(requestconvertTaskModal, null, null, null, 'task');
                Fillcustomerhavingoffer()
              "
            >
              <i class="fa fa-backward"></i>
            </button>

            <button
              *ngIf="IsadminTask == 1"
              [disabled]="
                TaskData.Obj?.status == 1 || TaskData.Obj?.status == 3
              "
              type="button"
              class="btn btn-outline-secondary rounded-lg mx-1"
              (click)="
                open(assignTaskModal, null, null, null, 'task');
                Fillcustomerhavingoffer()
              "
            >
              <i class="fa fa-backward"></i>
            </button>
          </div>
        </div>
        <div class="mt-3 flex items-center gap-8 flex-wrap">
          <!-- <div style="max-width: 150px">
            <div class="form-check form-switch">
              <input
                class="form-check-input"
                type="checkbox"
                role="switch"
                id="flexSwitchCheckDefault"
              />
              <label
                class="form-check-label"
                for="flexSwitchCheckDefault"
                style="width: max-content"
              >
                {{ "achieve the goal" | translate }}
              </label>
            </div>
          </div> -->

          <!-- <div class="periority">
            <mat-radio-group
              aria-label="Select an option"
              name="status"
              style="display: flex; gap: 16px; align-items: center"
            >
              <mat-radio-button value="1" class="text-warning">{{
                "low" | translate
              }}</mat-radio-button>
              <mat-radio-button value="2" class="text-success">{{
                "middle" | translate
              }}</mat-radio-button>
              <mat-radio-button value="3" class="text-base">{{
                "high" | translate
              }}</mat-radio-button>
              <mat-radio-button value="4" class="text-danger">{{
                "urgent" | translate
              }}</mat-radio-button>
            </mat-radio-group>
          </div> -->
        </div>
        <div class="info mt-2">
          <label class="fs-6">{{
            "Job Details Required for Mission" | translate
          }}</label>
          <textarea
            [disabled]="TaskData.Obj?.status == 1 || TaskData.Obj?.status == 3"
            name="info"
            style="width: 100%; height: 50px; padding: 10px 15px"
            placeholder="{{ 'task statement' | translate }}"
            >{{ TaskData.Obj?.taskLongDesc }}</textarea
          >
        </div>

        <div class="users flex items-center justify-between flex-wrap mt-2">
          <div>
            <img
              [src]="ShowImgAdded()"
              alt="img"
              class="img-fluid"
              style="
                width: 80px;
                height: 80px;
                border-radius: 50%;
                margin-inline-end: 10px;
              "
            />
            <span style="margin-inline-end: 10px">{{
              "Created by" | translate
            }}</span>
            <span *ngIf="!TaskData.Obj?.settingId">{{
              TaskData.Obj?.addedTaskName
            }}</span>
            <span *ngIf="TaskData.Obj?.settingId" title="مهمة في سير"
              ><i class="fa fa-signal fa-2xl" aria-hidden="true"></i
            ></span>
          </div>
          <div>
            <img
              [src]="ShowImgManager()"
              alt="img"
              class="img-fluid"
              style="
                width: 80px;
                height: 80px;
                border-radius: 50%;
                margin-inline-end: 10px;
              "
            />
            <span style="margin-inline-end: 10px">{{
              "project manager" | translate
            }}</span>
            <span>{{ TaskData.Obj?.projectMangerName }}</span>
          </div>
        </div>
      </div>
      <div class="d-flex items-center justify-end gap-3 mt-4">
        <button (click)="modal?.dismiss()" class="btn btn-outline-secondary">
          {{ "close" | translate }}
        </button>
      </div>
    </div>
  </ng-template>

  <!-- Order DetailsModal -->
  <ng-template #OrderDetailsModal let-modal>
    <div
      style="background-color: var(--base-color)"
      class="modal-header text-white flex justify-between items-center"
    >
      <h4 class="modal-title mb-0" id="modal-basic-title">
        <span
          [translate]="'name'"
          [translateParams]="{
            ar: 'تفاصيل الطلب',
            en: 'Task Details'
          }"
        >
        </span>
      </h4>
      <button
        type="button"
        class="text-white m-0"
        aria-label="Close"
        (click)="modal.dismiss('Cross click')"
      >
        <i class="fa fa-close"></i>
      </button>
    </div>

    <div class="modal-body">
      <div class="tasks-page custome-task">
        <p class="mb-4">
          <span style="margin-inline-end: 20px">رقم امر العمل </span>
          <!-- <span>{{ selectedTask?.customer }}</span> -->
          <span>{{ OrderData.Obj?.orderNo }}</span>
        </p>

        <!-- <div class="d-flex items-center justify-between flex-wrap gap-8 fs-6">
            <p class="mb-3">
              <span style="margin-inline-end: 20px"
                >{{ "status" | translate }}
              </span>
              <span>{{ selectedTask?.statusName }}</span>
            </p>
            <p class="mb-4">
              <span style="margin-inline-end: 20px"
                >{{ "Duration" | translate }}
              </span>
              <span>{{ selectedTask?.timeStr }}</span>

              <span style="margin-inline-end: 20px"
                >{{ "Project name/description" | translate }}
              </span>
              <span>{{ selectedTask?.projectDescription }}</span>
            </p> -->

        <!-- <div class="chart mb-4" style="max-width: 150px">
              <ngx-gauge
                type="full"
                value="{{ percentage }}"
                label="progress"
                append="%"
                thick="10"
                foregroundColor="#2980b9"
              ></ngx-gauge>
            </div> -->
      </div>

      <!-- <div class="mb-4">
            <mat-progress-bar
              mode="determinate"
              value="41"
              style="height: 12px"
            ></mat-progress-bar>
          </div> -->

      <div class="table">
        <div class="date flex items-center justify-between">
          <p>
            <span>{{ "From" | translate }}</span>
            <span>{{ OrderData.Obj?.orderDate | date : "dd-MM-yyyy" }}</span>
          </p>
          <p>
            <span>{{ "To" | translate }}</span>
            <span>{{ OrderData.Obj?.endDate | date : "dd-MM-yyyy" }}</span>
          </p>
        </div>

        <table
          class="table table-responsive table-striped table-bordered text-center"
          style="vertical-align: middle; font-size: 14px"
        >
          <thead
            class="bg-base text-white"
            style="line-height: 30px; font-size: 13px"
          >
            <tr>
              <th>رقم امر العمل</th>
              <th>المطلوب</th>
              <th>رقم المشروع</th>
              <th>المدة</th>
            </tr>
          </thead>
          <tbody>
            <td>{{ OrderData.Obj?.orderNo }}</td>
            <td>{{ OrderData.Obj?.required }}</td>
            <td>{{ OrderData.Obj?.projectNo }}</td>
            <td>{{ OrderData.Obj?.strTime }}</td>
          </tbody>
        </table>
      </div>
      <div class="my-2 flex items-center justify-between flex-wrap">
        <div class="flex justify-start items-center gap-4">
          <button
            type="button"
            mat-button
            mat-raise-button
            class="bg-success text-white px-4 py-2"
            style="
              padding: 2px 14px !important;
              width: max-content;
              height: auto;
            "
            (click)="open(endWorkOrder, 'infoAction')"
          >
            {{ "end task" | translate }}
          </button>
          <p class="flex items-center mb-0 relative">
            {{ "Mission Completion Ratio" | translate }}
            <input
              type="text"
              name="missionRatio"
              class="form-control"
              id="execPercentage"
              name="execPercentage"
              [(ngModel)]="OrderData.percentComplete"
            />
            <span class="percent absolute">%</span>
          </p>
          <button
            type="button"
            mat-button
            mat-raise-button
            class="bg-success text-white px-4 py-2"
            style="
              padding: 2px 14px !important;
              width: max-content;
              height: auto;
            "
            (click)="open(PercentageModal, 'infoAction')"
          >
            حفظ النسبه
          </button>
        </div>
        <div class="flex justify-end items-center gap-2 taskBtns">
          <!-- <button
            class="btn btn-outline-success"
            (click)="open(mapModal, null, 'mapModal')"
          >
            <i class="fa fa-map-marker"></i>
          </button> -->

          <!-- <button
                type="button"
                class="btn btn-outline-secondary rounded-lg"
                (click)="open(stopTaskModal, 'infoAction')"
              >
                <i class="fa fa-pause"></i>
              </button>-->
          <button
            *ngIf="OrderFilesCount > 0"
            type="button"
            class="min-w-max p-2 bg-sky-100 hover:bg-sky-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
            (click)="
              GetAllProjectRequirementByOrderId(OrderData.Obj);
              open(showOrdersfiles, null, null, null, 'openfile')
            "
          >
            <i class="fa-solid fa-eye"></i>
          </button>
          <button
            (click)="downloadFileWorkOrder(OrderData.Obj)"
            *ngIf="
              OrderData?.Obj?.projectId == null && OrderData.Obj?.attatchmentUrl
            "
            class="min-w-max p-2 bg-sky-100 hover:bg-sky-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
          >
            <i class="fa-solid fa-eye"></i>
          </button>

          <button
            type="button"
            class="t-Uploading-Project btn btn-sm waves-effect p-0"
            (click)="open(uploadFileModal, 'infoAction')"
            style="filter: grayscale(1)"
          >
            <img
              src="/assets/icons/upload-cloud-line@2x.png"
              alt="upload icon"
              class="uploadingIcon"
            />
          </button>

          <!-- <button
                type="button"
                class="btn btn-outline-secondary rounded-lg"
                (click)="open(deleteTaskModal, 'infoAction')"
              >
                <i class="fa fa-trash"></i>
              </button> -->
          <!-- <button
                type="button"
                class="btn btn-outline-secondary rounde mx-1d-lg"
                (click)="open(extendTaskModal, 'infoAction')"
              >
                <i class="fa fa-clock"></i>
              </button>
              <button
                type="button"
                class="btn btn-outline-secondary rounded-lg mx-1"
                (click)="open(assignTaskModal, 'infoAction')"
              >
                <i class="fa fa-backward"></i>
              </button> -->
        </div>
      </div>
      <!--   <div class="mt-3 flex items-center gap-8 flex-wrap">
           <div style="max-width: 150px">
              <div class="form-check form-switch">
                <input
                  class="form-check-input"
                  type="checkbox"
                  role="switch"
                  id="flexSwitchCheckDefault"
                />
                <label
                  class="form-check-label"
                  for="flexSwitchCheckDefault"
                  style="width: max-content"
                >
                  {{ "achieve the goal" | translate }}
                </label>
              </div>
            </div> -->

      <!-- <div class="periority">
              <mat-radio-group
                aria-label="Select an option"
                name="status"
                style="display: flex; gap: 16px; align-items: center"
              >
                <mat-radio-button value="1" class="text-warning">{{
                  "low" | translate
                }}</mat-radio-button>
                <mat-radio-button value="2" class="text-success">{{
                  "middle" | translate
                }}</mat-radio-button>
                <mat-radio-button value="3" class="text-base">{{
                  "high" | translate
                }}</mat-radio-button>
                <mat-radio-button value="4" class="text-danger">{{
                  "urgent" | translate
                }}</mat-radio-button>
              </mat-radio-group>
            </div>

          </div>-->
      <div class="info mt-2">
        <label class="fs-6">{{
          "Job Details Required for Mission" | translate
        }}</label>
        <textarea
          disabled
          name="info"
          style="width: 100%; height: 50px; padding: 10px 15px"
          [(ngModel)]="OrderData.required"
        ></textarea>
      </div>

      <!-- <div class="users flex items-center justify-between flex-wrap mt-2">
            <div>
              <img
                src="{{ selectedTask?.addedTaskImg }}"
                alt="img"
                class="img-fluid"
                style="
                  width: 80px;
                  height: 80px;
                  border-radius: 50%;
                  margin-inline-end: 10px;
                "
              />
              <span style="margin-inline-end: 10px">{{
                "Created by" | translate
              }}</span>
              <span>{{ selectedTask?.addedTaskName }}</span>
            </div>
            <div>
              <img
                src="{{ promanager.imgUrl }}"
                alt="img"
                class="img-fluid"
                style="
                  width: 80px;
                  height: 80px;
                  border-radius: 50%;
                  margin-inline-end: 10px;
                "
              />
              <span style="margin-inline-end: 10px">{{
                "project manager" | translate
              }}</span>
              <span>{{ selectedTask?.projectMangerName }}</span>
            </div>
          </div>
        </div>-->
      <div class="d-flex items-center justify-end gap-3 mt-4">
        <button (click)="modal?.dismiss()" class="btn btn-outline-secondary">
          {{ "close" | translate }}
        </button>
      </div>
    </div>
  </ng-template>

  <!-- endTaskModal -->
  <ng-template #endTaskModal let-modal>
    <div class="modal-body text-center">
      <p>{{ "Do you want to finish the task?" | translate }}</p>
      <div class="flex gap-2 justify-center mt-3">
        <button
          type="button"
          mat-raised-button
          color="warn"
          (click)="confirm_endtask(modal); modal.dismiss()"
        >
          {{ "Yes" | translate }}
        </button>
        <button
          type="button"
          (click)="modal.dismiss()"
          mat-raised-button
          color="basic"
        >
          {{ "No" | translate }}
        </button>
      </div>
    </div>
  </ng-template>

  <!-- stopTaskModal -->
  <ng-template #stopTaskModal let-modal>
    <div class="modal-body text-center">
      <p>{{ "Do you want to stop the task?" | translate }}</p>
      <div class="flex gap-2 justify-center mt-3">
        <button
          type="button"
          mat-raised-button
          color="warn"
          (click)="confirm_playandstoptask(3, modal); modal.dismiss()"
        >
          {{ "Yes" | translate }}
        </button>
        <button
          type="button"
          (click)="modal.dismiss()"
          mat-raised-button
          color="basic"
        >
          {{ "No" | translate }}
        </button>
      </div>
    </div>
  </ng-template>

  <!-- stopTaskModal -->
  <ng-template #playTaskModal let-modal>
    <div class="modal-body text-center">
      <p>{{ "Do you want to play the task?" | translate }}</p>
      <div class="flex gap-2 justify-center mt-3">
        <button
          type="button"
          mat-raised-button
          color="warn"
          (click)="confirm_playandstoptask(2, modal); modal.dismiss()"
        >
          {{ "Yes" | translate }}
        </button>
        <button
          type="button"
          (click)="modal.dismiss()"
          mat-raised-button
          color="basic"
        >
          {{ "No" | translate }}
        </button>
      </div>
    </div>
  </ng-template>

  <!--Delete AlertModal-->
  <ng-template #DeleteAlertModal let-modal>
    <div class="modal-body text-center">
      <p
        [translate]="'name'"
        [translateParams]="{
          ar: 'هل تريد الحذف',
          en: 'Do you want to Delete ?'
        }"
      ></p>
      <div class="flex gap-2 justify-center">
        <button
          type="button"
          mat-raised-button
          class="bg-base text-white"
          (click)="DeleteAlert(); modal.dismiss('Cross click')"
        >
          {{ "Yes" | translate }}
        </button>
        <button
          type="button"
          (click)="modal.dismiss('Cross click')"
          mat-raised-button
          color="basic"
        >
          {{ "No" | translate }}
        </button>
      </div>
    </div>
  </ng-template>

  <!-- deleteTaskModal -->
  <ng-template #deleteTaskModal let-modal>
    <div class="modal-body text-center">
      <p
        [translate]="'name'"
        [translateParams]="{
          ar: 'هل تريد بالتأكيد حذف هذا الصف',
          en: 'Are you sure to delete this row ?'
        }"
      ></p>
      <div class="flex gap-2 justify-center mt-3">
        <button
          type="button"
          mat-raised-button
          color="warn"
          (click)="confirm(); modal.dismiss()"
        >
          {{ "Yes" | translate }}
        </button>
        <button
          type="button"
          (click)="modal.dismiss()"
          mat-raised-button
          color="basic"
        >
          {{ "No" | translate }}
        </button>
      </div>
    </div>
  </ng-template>

  <!-- extendTaskModal -->
  <ng-template #extendTaskModal let-modal>
    <div class="modal-header bg-base text-white">
      <h4
        class="modal-title mb-0"
        id="modal-basic-title"
        [translate]="'name'"
        [translateParams]="{ ar: 'تمديد المهمة', en: '  extended Task' }"
      ></h4>
      <button type="button" class="m-0" (click)="modal.dismiss('Cross click')">
        <i class="fa fa-close"></i>
      </button>
    </div>

    <div class="modal-body">
      <div class="row">
        <div class="col-lg-6 col-lg-4 mb-3 mb-lg-0">
          <div class="form-group">
            <label class="col-form-label"> {{ "Duration" | translate }}</label>
            <ng-select
              class="w-full p-0"
              placeholder="{{ 'Chose' | translate }}"
              [(ngModel)]="extendedData.selectedTaskType"
              [ngModelOptions]="{ standalone: true }"
              [clearable]="false"
            >
              <ng-option
                *ngFor="let type of TaskType"
                [value]="type.id"
                [translate]="'name'"
                [translateParams]="{ ar: type.name?.ar, en: type.name?.en }"
              >
              </ng-option>
            </ng-select>
          </div>
        </div>

        <div
          class="col-lg-6 col-lg-4 mb-3 mb-lg-0"
          *ngIf="extendedData.selectedTaskType == 1"
        >
          <div class="form-group">
            <label for="to234" class="text-right col-form-label block">
              {{ "Time" | translate }}
            </label>
            <input
              #to234="ngModel"
              [(ngModel)]="extendedData.TimeH"
              ngModel
              class="form-control"
              type="number"
              id="to234"
              name="to234"
              (keyup)="TimeHChange()"
            />
          </div>
        </div>

        <div
          class="col-lg-6 col-lg-4 mb-3 mb-lg-0"
          *ngIf="extendedData.selectedTaskType == 2"
        >
          <div class="form-group">
            <label class="text-right col-form-label block">
              {{ "From" | translate }} {{ " " }}{{ "Date" | translate }}
            </label>
            <div class="form-group timeInput">
              <input
                ngModel
                name="from"
                type="text"
                class="form-control"
                bsDatepicker
                [(ngModel)]="extendedData.DateFrom"
                disabled="disabled"
              />
            </div>
          </div>
        </div>
        <div
          class="col-lg-6 col-lg-4"
          *ngIf="extendedData.selectedTaskType == 2"
        >
          <div class="form-group">
            <label class="text-right col-form-label block">
              {{ "To" | translate }} {{ " " }}{{ "Date" | translate }}
            </label>
            <div class="form-group timeInput">
              <input
                ngModel
                name="to"
                type="text"
                class="form-control"
                bsDatepicker
                [(ngModel)]="extendedData.DateTo"
              />
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="modal-footer justify-content-end" style="border-top: none">
      <button
        type="button"
        class="btn py-2 px-3 mt-0 bg-base text-white"
        (click)="modal.dismiss('Cross click'); confirm_changeTaskTime()"
      >
        {{ "confirem" | translate }}
      </button>
    </div>
  </ng-template>

  <!-- assignTaskModal -->
  <ng-template #assignTaskModal let-modal>
    <div class="modal-header bg-base text-white">
      <h4
        class="modal-title mb-0"
        id="modal-basic-title"
        [translate]="'name'"
        [translateParams]="{
          ar: 'تحويل المهمة      ',
          en: '    Task Transformation '
        }"
      ></h4>
      <button type="button" class="m-0" (click)="modal.dismiss('Cross click')">
        <i class="fa fa-close"></i>
      </button>
    </div>

    <div class="modal-body">
      <div class="row">
        <div class="col-12">
          <div class="form-group">
            <label class="col-form-label"> {{ "userName" | translate }}</label>
            <ng-select
              class="w-full p-0"
              placeholder="{{ 'Chose' | translate }}"
              [(ngModel)]="UsersSelectConvert"
              [ngModelOptions]="{ standalone: true }"
              [dropdownPosition]="'bottom'"
            >
              <ng-option
                *ngFor="let user of load_UsersSelectConvert"
                [value]="user.id"
                >{{ user.name }}</ng-option
              >
            </ng-select>
          </div>
        </div>
      </div>
    </div>

    <div class="modal-footer justify-content-end" style="border-top: none">
      <button
        type="button"
        class="btn py-2 px-3 mt-0 bg-base text-white"
        (click)="modal.dismiss('Cross click'); confirm_converttask()"
      >
        {{ "confirem" | translate }}
      </button>
    </div>
  </ng-template>

  <ng-template #acceptModal let-modal>
    <div class="model-body" style="padding: 30px; text-align: center">
      <p class="mb-3">
        {{ "Are you sure you want to accept the request?" | translate }}
      </p>
      <div class="form-group">
        <label for="" class="col-form-label">{{ "reason" | translate }}</label>
        <input
          type="text"
          [(ngModel)]="acceptreason"
          name="reason"
          id="reason"
          class="form-control"
        />
      </div>
      <div class="flex justify-center gap-3 mt-3">
        <button mat-raised-button color="warn" (click)="modal.dismiss()">
          {{ "close" | translate }}
        </button>
        <button
          mat-raised-button
          class="bg-base text-white"
          (click)="CheckLoan(modal)"
        >
          {{ "confirem" | translate }}
        </button>
      </div>
    </div>
  </ng-template>

  <ng-template #rejectModal let-modal>
    <div class="model-body" style="padding: 30px; text-align: center">
      <p class="mb-3">
        {{ "Are you sure you want to decline the request?" | translate }}
      </p>
      <div class="form-group">
        <label for="" class="col-form-label">{{ "reason" | translate }}</label>
        <input type="text" name="reason" id="reason" class="form-control" />
      </div>
      <div class="flex justify-center gap-3 mt-3">
        <button mat-raised-button color="warn" (click)="modal.dismiss()">
          {{ "close" | translate }}
        </button>
        <button
          mat-raised-button
          class="bg-base text-white"
          (click)="updatevacation(modal)"
        >
          {{ "confirem" | translate }}
        </button>
      </div>
    </div>
  </ng-template>

  <ng-template #reviewModal let-modal>
    <div class="model-body" style="padding: 30px; text-align: center">
      <p class="mb-3">
        {{ "Are you sure you want to review the application?" | translate }}
      </p>
      <div class="form-group">
        <label for="" class="col-form-label">{{ "reason" | translate }}</label>
        <input type="text" name="reason" id="reason" class="form-control" />
      </div>
      <div class="flex justify-center gap-3 mt-3">
        <button mat-raised-button color="warn" (click)="modal.dismiss()">
          {{ "close" | translate }}
        </button>
        <button
          mat-raised-button
          class="bg-base text-white"
          (click)="updatevacation(modal)"
        >
          {{ "confirem" | translate }}
        </button>
      </div>
    </div>
  </ng-template>

  <ng-template #delayModal let-modal>
    <div class="model-body" style="padding: 30px; text-align: center">
      <p class="mb-3">
        {{ "Are you sure you want to defer the request?" | translate }}
      </p>
      <div class="form-group">
        <label for="" class="col-form-label">{{ "reason" | translate }}</label>
        <input type="text" name="reason" id="reason" class="form-control" />
      </div>
      <div class="flex justify-center gap-3 mt-3">
        <button mat-raised-button color="warn" (click)="modal.dismiss()">
          {{ "close" | translate }}
        </button>
        <button
          mat-raised-button
          class="bg-base text-white"
          (click)="updatevacation(modal)"
        >
          {{ "confirem" | translate }}
        </button>
      </div>
    </div>
  </ng-template>
</div>

<ng-template #uploadFileModal let-modal>
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4 class="m-0">
      <span
        class="text-2xl"
        [translate]="'name'"
        [translateParams]="{
          ar: '  اضافة ملفات',
          en: 'Add Files',
        }"
      >
      </span>
    </h4>
    <button
      type="button"
      class="text-2xl text-white m-0"
      (click)="modal.dismiss()"
    >
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>
  <div class="modal-body">
    <form>
      <p class="w-max p-1 bg-red-100 mx-auto mb-3">
        {{ "Verification service depends only on pdf files" | translate }}
      </p>
      <div class="upload">
        <file-upload [control]="controlTask" style="min-height: 240px">
          <ng-template
            let-isFileDragDropAvailable="isFileDragDropAvailable"
            #placeholder
          >
            <div *ngIf="controlTask.size === 0">
              <div class="icon">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  height="1em"
                  viewBox="0 0 640 512"
                >
                  <path
                    d="M144 480C64.5 480 0 415.5 0 336c0-62.8 40.2-116.2 96.2-135.9c-.1-2.7-.2-5.4-.2-8.1c0-88.4 71.6-160 160-160c59.3 0 111 32.2 138.7 80.2C409.9 102 428.3 96 448 96c53 0 96 43 96 96c0 12.2-2.3 23.8-6.4 34.6C596 238.4 640 290.1 640 352c0 70.7-57.3 128-128 128H144zm79-217c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l39-39V392c0 13.3 10.7 24 24 24s24-10.7 24-24V257.9l39 39c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-80-80c-9.4-9.4-24.6-9.4-33.9 0l-80 80z"
                  />
                </svg>
              </div>
              <div class="upload-text">{{ "Upload File" | translate }} 😶</div>
            </div>
          </ng-template>

          <ng-template
            let-i="index"
            let-file="file"
            let-control="control"
            #item
          >
            <div *ngIf="file">
              <span
                class="delete-button"
                style="display: flex"
                (click)="controlTask.removeFile(file)"
              >
                <span> حذف ❌ </span>
                <svg viewBox="0 0 448 512">
                  <path
                    d="M32 464a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128H32zm272-256a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zM432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16z"
                  ></path>
                </svg>
              </span>
              <img
                class="max-h-44"
                *ngIf="controlTask.valid"
                [src]="uploadedFile | async"
              />

              <section class="file-info">
                <span style="font-size: 16px; font-weight: 700"
                  >تفاصيل الملف</span
                >
                <hr />
                <ul>
                  <li><span style="color: red">Name: </span>{{ file.name }}</li>
                  <li><span style="color: red">Type: </span>{{ file.type }}</li>
                  <li>
                    <span style="color: red">Size: </span>{{ file.size }} bytes
                  </li>
                </ul>
              </section>
              <section *ngIf="!(controlTask.size === 0)">
                <p>
                  تم تحديد الملف بنجاح، ولرفع الملف علي المشروع اضغط زر حفظ ✅
                </p>
              </section>
            </div>
          </ng-template>
        </file-upload>
      </div>
      <mat-progress-bar
        style="height: 12px"
        mode="determinate"
        value="{{ progress }}"
      ></mat-progress-bar>
      <p style="text-align: center; color: #950101" *ngIf="uploading">
        جاري التحميل ... ⏳
      </p>
      <p style="font-weight: 700">يرجي الانتباه للاتي عند رفع ملف :</p>
      <p>
        <span style="color: red">أولا</span> : تأكد من فحص الملف بواسطة مكافح
        الفيروسات والتأكد منه قبل رفعه علي النظام
      </p>
      <p>
        <span style="color: red">ثانيا</span> : لا تقم برفع الملفات التي لا تخص
        المشروع لتوفير مساحة تخزين علي السيرفر الخاص بك
      </p>
      <p>
        <span style="color: red">ثالثا</span> : خدمة التحقق من الوثائق والتي
        توفر للعميل معرفة مصدر الملف تتوفر بصيغة PDF فقط
      </p>
    </form>
  </div>
  <div class="modal-footer">
    <button class="btn btn-light" (click)="modal.dismiss()">
      {{ "Back" | translate }}
    </button>
    <button
      [disabled]="controlTask.size === 0 || disableButtonSave_File"
      (click)="confirm_SaveFiles(modal)"
      class="btn btn-primary"
    >
      {{ "Save" | translate }}
    </button>
  </div>
</ng-template>

<ng-template #mapModal let-modal>
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4 class="m-0">
      <span class="text-2xl">{{ "Location" | translate }} </span>
    </h4>
    <button
      type="button"
      class="text-2xl text-white m-0"
      (click)="modal.dismiss()"
    >
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>
  <div class="modal-body">
    <div class="relative rounded-lg overflow-hidden">
      <agm-map
        (mapReady)="onMapReady($event)"
        style="height: 60vh"
        [latitude]="latitude"
        [longitude]="longitude"
        [zoom]="zoom"
      >
        <agm-marker
          [markerDraggable]="true"
          [latitude]="latitude"
          [longitude]="longitude"
          (dragEnd)="markerDragEnd($event)"
        ></agm-marker>
      </agm-map>
      <button
        class="bottom-[120px] right-[10px] shadow rounded-sm border-neutral-400 text-neutral-500 absolute h-10 w-10 bg-white flex justify-center items-center z-20"
        (click)="setCurrentLocation()"
      >
        <i class="fa fa-map-marker"></i>
      </button>
    </div>
    <div class="text-end mt-2">
      <button (click)="modal?.dismiss()" class="btn btn-secondary">
        {{ "close" | translate }}
      </button>
    </div>
  </div>
</ng-template>
<!-- endWorkOrder -->
<ng-template #endWorkOrder let-modal>
  <div class="modal-body text-center">
    <p>{{ "Do you want to finish the task?" | translate }}</p>
    <div class="flex gap-2 justify-center mt-3">
      <button
        type="button"
        mat-raised-button
        color="warn"
        (click)="FinishOrder(modal); modal.dismiss()"
      >
        {{ "Yes" | translate }}
      </button>
      <button
        type="button"
        (click)="modal.dismiss()"
        mat-raised-button
        color="basic"
      >
        {{ "No" | translate }}
      </button>
    </div>
  </div>
</ng-template>

<!-- endWorkOrder -->
<ng-template #PercentageModal let-modal>
  <div class="modal-body text-center">
    <p>هل تريد حفظ النسبة</p>
    <div class="flex gap-2 justify-center mt-3">
      <button
        type="button"
        mat-raised-button
        color="warn"
        (click)="SavePercentage(modal); modal.dismiss()"
      >
        {{ "Yes" | translate }}
      </button>
      <button
        type="button"
        (click)="modal.dismiss()"
        mat-raised-button
        color="basic"
      >
        {{ "No" | translate }}
      </button>
    </div>
  </div>
</ng-template>

<!-- endTask -->
<ng-template #PercentageTaskModal let-modal>
  <div class="modal-body text-center">
    <p>هل تريد حفظ النسبة</p>
    <div class="flex gap-2 justify-center mt-3">
      <button
        type="button"
        mat-raised-button
        color="warn"
        (click)="finishTask(modal); modal.dismiss()"
      >
        {{ "Yes" | translate }}
      </button>
      <button
        type="button"
        (click)="modal.dismiss()"
        mat-raised-button
        color="basic"
      >
        {{ "No" | translate }}
      </button>
    </div>
  </div>
</ng-template>

<!-- endTask -->
<ng-template #requestextendTaskModal let-modal>
  <div class="modal-body text-center">
    <p>هل تريد تمديد المهمة</p>
    <div class="flex gap-2 justify-center mt-3">
      <button
        type="button"
        mat-raised-button
        color="warn"
        (click)="confirm_changeTaskTime2(modal); modal.dismiss()"
      >
        {{ "Yes" | translate }}
      </button>
      <button
        type="button"
        (click)="modal.dismiss()"
        mat-raised-button
        color="basic"
      >
        {{ "No" | translate }}
      </button>
    </div>
  </div>
</ng-template>

<!-- endTask -->
<ng-template #requestconvertTaskModal let-modal>
  <div class="modal-body text-center">
    <p>هل تريد تحويل المهمة</p>
    <div class="flex gap-2 justify-center mt-3">
      <button
        type="button"
        mat-raised-button
        color="warn"
        (click)="confirm_converttask2(modal); modal.dismiss()"
      >
        {{ "Yes" | translate }}
      </button>
      <button
        type="button"
        (click)="modal.dismiss()"
        mat-raised-button
        color="basic"
      >
        {{ "No" | translate }}
      </button>
    </div>
  </div>
</ng-template>

<!-- projectDetailsModal -->
<ng-template #projectDetailsModal let-modal>
  <div class="modal-header bg-base text-white">
    <h4
      class="modal-title mb-0"
      id="modal-basic-title"
      [translate]="'name'"
      [translateParams]="{ ar: 'تفاصيل المشروع      ', en: 'Project Details' }"
    ></h4>
    <div class="flex items-center gap-12">
      <p class="mb-0">
        <span style="margin-inline-end: 10px">{{
          "ProjectNumber" | translate
        }}</span>
        <span>{{ projDet?.settingNoP }}</span>
      </p>
      <p class="mb-0">
        <span style="margin-inline-end: 10px">{{
          "projectDescription" | translate
        }}</span>
        <span>{{ projDet?.settingNoteP }}</span>
      </p>
    </div>
    <button type="button" class="m-0" (click)="modal.dismiss('Cross click')">
      <i class="fa fa-close"></i>
    </button>
  </div>
  <div class="modal-body">
    <app-project-details
      [projectDetails]="projectDetails"
    ></app-project-details>
  </div>
  <div class="modal-footer justify-content-end" style="border-top: none">
    <button
      type="button"
      class="btn btn-light py-2 px-3 mt-0"
      (click)="modal.dismiss('Cross click')"
    >
      {{ "close" | translate }}
    </button>
  </div>
</ng-template>

<!-- عرض القيد المحاسبي  -->
<!-- accountingentry -->
<ng-template #accountingentry let-modal>
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4 class="m-0">
      <span class="text-2xl">{{ "View_accounting_entry" | translate }}</span>
    </h4>
    <button
      type="button"
      class="text-2xl text-white m-0"
      (click)="modal.dismiss()"
    >
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>
  <div class="max-h-100 overflow-x-scroll overflow-y-scroll p-4">
    <table
      class="border border-gray-500"
      style="width: 100%; text-align: center"
    >
      <thead>
        <tr>
          <th class="w-1/9 px-1 py-2">{{ "date" | translate }}</th>
          <th class="w-1/9 px-1 py-2">{{ "Bond number" | translate }}</th>
          <th class="w-1/9 px-1 py-2">{{ "Bond type" | translate }}</th>
          <th class="w-1/9 px-1 py-2">
            {{ "Registration number" | translate }}
          </th>
          <th class="w-1/9 px-1 py-2">{{ "account code" | translate }}</th>
          <th class="w-1/9 px-1 py-2">{{ "account name" | translate }}</th>
          <th class="w-1/9 px-1 py-2">{{ "Statement" | translate }}</th>
          <th class="w-1/9 px-1 py-2">{{ "debtor" | translate }}</th>
          <th class="w-1/9 px-1 py-2">{{ "Creditor" | translate }}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let entry of FilterLoadData?.AllJournalEntries">
          <td class="w-1/9 border px-1 py-2">{{ entry.transactionDate }}</td>
          <td class="w-1/9 border px-1 py-2">{{ entry.invoiceNumber }}</td>
          <td class="w-1/9 border px-1 py-2">{{ entry.typeName }}</td>
          <td class="w-1/9 border px-1 py-2">{{ entry.journalNo }}</td>
          <td class="w-1/9 border px-1 py-2">{{ entry.accountCode }}</td>
          <td class="w-1/9 border px-1 py-2">{{ entry.accountName }}</td>
          <td class="w-1/9 border px-1 py-2">{{ entry.notes }}</td>
          <td class="w-1/9 border px-1 py-2">{{ entry.depit }}</td>
          <td class="w-1/9 border px-1 py-2">{{ entry.credit }}</td>
        </tr>
        <tr>
          <td class="w-1/9 border px-1 py-2">{{ "total" | translate }}</td>
          <td class="w-1/9 border px-1 py-2"></td>
          <td class="w-1/9 border px-1 py-2"></td>
          <td class="w-1/9 border px-1 py-2"></td>
          <td class="w-1/9 border px-1 py-2"></td>
          <td class="w-1/9 border px-1 py-2"></td>
          <td class="w-1/9 border px-1 py-2"></td>
          <td class="w-1/9 border px-1 py-2 bg-green-500">{{ totaldepit }}</td>
          <td class="w-1/9 border px-1 py-2 bg-red-500">{{ totalcredit }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="flex justify-end p-3">
    <button
      class="btn text-white me-2"
      style="background-color: var(--base-color)"
      (click)="PrintJournalsVyInvIdRetPurchase()"
    >
      {{ "Print" | translate }}
    </button>

    <button (click)="modal?.dismiss()" class="btn btn-secondary">
      {{ "close" | translate }}
    </button>
  </div>
</ng-template>

<ng-template #showtasksfiles let-modal>
  <div class="model-body" style="padding: 30px; text-align: center">
    <table
      class="table table-responsive table-striped table-bordered text-center"
      style="vertical-align: middle; font-size: 14px"
    >
      <thead
        class="bg-base text-white"
        style="line-height: 30px; font-size: 13px"
      >
        <tr>
          <th>اسم الملف</th>
          <th>خيارات</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of TaskFiles">
          <td>{{ item.nameAr }}</td>
          <td>
            <button
              type="button"
              class="min-w-max p-2 bg-sky-100 hover:bg-sky-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
              (click)="downloadFile(item.attachmentUrl)"
            >
              <i class="fa-solid fa-eye"></i>
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <div class="flex justify-center gap-3 mt-3">
      <button mat-raised-button color="warn" (click)="modal.dismiss()">
        {{ "close" | translate }}
      </button>
    </div>
  </div>
</ng-template>

<ng-template #showOrdersfiles let-modal>
  <div class="model-body" style="padding: 30px; text-align: center">
    <table
      class="table table-responsive table-striped table-bordered text-center"
      style="vertical-align: middle; font-size: 14px"
    >
      <thead
        class="bg-base text-white"
        style="line-height: 30px; font-size: 13px"
      >
        <tr>
          <th>اسم الملف</th>
          <th>خيارات</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of OrderFiles">
          <td>{{ item.nameAr }}</td>
          <td>
            <button
              type="button"
              class="min-w-max p-2 bg-sky-100 hover:bg-sky-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
              (click)="downloadFile(item.attachmentUrl)"
            >
              <i class="fa-solid fa-eye"></i>
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <div class="flex justify-center gap-3 mt-3">
      <button mat-raised-button color="warn" (click)="modal.dismiss()">
        {{ "close" | translate }}
      </button>
    </div>
  </div>
</ng-template>

<ng-template #confirmModal let-modal>
  <div class="model-body" style="padding: 30px; text-align: center">
    <p class="mb-3">
      {{ "Are you sure you want to review the application?" | translate }}
    </p>
    <div class="form-group">
      <label for="" class="col-form-label">{{ "reason" | translate }}</label>
      <input type="text" name="reason" id="reason" class="form-control" />
    </div>
    <div class="flex justify-center gap-3 mt-3">
      <button mat-raised-button color="warn" (click)="modal.dismiss()">
        {{ "close" | translate }}
      </button>
      <button
        mat-raised-button
        class="bg-base text-white"
        (click)="updatevacation(modal)"
      >
        {{ "confirem" | translate }}
      </button>
    </div>
  </div>
</ng-template>

<ng-template #confirmloanModal let-modal>
  <div class="model-body" style="padding: 30px; text-align: center">
    <p class="mb-3">هل تريد تاكيد الطلب</p>
    <div class="form-group">
      <label for="" class="col-form-label">{{ "reason" | translate }}</label>
      <input
        type="text"
        name="reason"
        [(ngModel)]="loanreason"
        id="reason"
        class="form-control"
      />
    </div>
    <div class="flex justify-center gap-3 mt-3">
      <button mat-raised-button color="warn" (click)="modal.dismiss()">
        {{ "close" | translate }}
      </button>
      <button
        mat-raised-button
        class="bg-base text-white"
        (click)="UpdateStatus(modal)"
      >
        {{ "confirem" | translate }}
      </button>
    </div>
  </div>
</ng-template>

<ng-template #printDivModal let-modal>
  <div class="modal-body">
    <div
      id="divHtml_a"
      class="divHtml"
      style="width: 100% !important; margin: 0px auto !important"
    >
      <div>
        <img
          *ngIf="CustomData.headerurl"
          src="{{ CustomData.headerurl }}"
          alt="headerurl"
          style="height: 60px; width: 100%; max-width: 100%; object-fit: fill"
        />
      </div>
      <div class="invoiceNe-wrapper" style="direction: rtl !important">
        <!--Header-->
        <div class="invoiceNe-header">
          <div class="headerNe-right-side">
            <img
              *ngIf="CustomData.OrgImg"
              src="{{ CustomData.OrgImg }}"
              alt="logo"
              style="
                height: 80px;
                width: 140px;
                max-width: 200px;
                object-fit: fill;
              "
            />
          </div>
          <div class="headerNe-lefy-side" style="width: 100%">
            <p>{{ InvPrintData?.org_VD?.nameAr }}</p>
            <p>{{ InvPrintData?.org_VD?.nameEn }}</p>
            <div class="line" style="position: relative; padding: 5px 0px 10px">
              <span
                style="
                  position: absolute;
                  right: 0;
                  width: 100%;
                  height: 2px;
                  background-color: #e5e5e5;
                  z-index: 1;
                "
              ></span>
              <span
                style="
                  position: absolute;
                  right: 0;
                  width: 70%;
                  height: 2px;
                  background-color: #ec1c24;
                  z-index: 2;
                "
              ></span>
            </div>
            <h1 style="margin-bottom: 0">فاتورة ضريبية</h1>
          </div>
        </div>
        <!--/Header-->

        <!--invoiceNe-content-->
        <div class="invoiceNe-content">
          <div class="firstNe-table-main-heading" style="display: flex">
            <div class="firstNe-table" style="margin-left: 5px; width: 50%">
              <table
                class="tableI"
                style="
                  margin-bottom: 5px;
                  vertical-align: middle;
                  text-align: center;
                "
              >
                <thead>
                  <tr>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      رقم الفاتورة
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      {{ InvPrintData?.invoicesVM_VD?.invoiceNumber }}
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      Invoice No
                    </th>
                  </tr>
                  <tr>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      تاريخ الفاتورة
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      {{ InvPrintData?.invoicesVM_VD?.date }}
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      Invoice Date
                    </th>
                  </tr>

                  <tr>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      تاريخ التوريد
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      {{ InvPrintData?.invoicesVM_VD?.date }}
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      Date of supply
                    </th>
                  </tr>
                </thead>
              </table>
            </div>
            <div class="firstNe-table" style="margin-right: 5px; width: 50%">
              <table
                of
                supplyable
                class="tableI"
                style="
                  margin-bottom: 5px;
                  vertical-align: middle;
                  text-align: center;
                "
              >
                <thead>
                  <tr>
                    <th
                      style="
                        background-color: #faebd7;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      فاتورة ضريبية
                    </th>
                    <th
                      style="
                        background-color: #faebd7;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      {{ InvPrintData?.invoicesVM_VD?.payTypeName }}
                    </th>
                    <th
                      style="
                        background-color: #faebd7;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      Tax Invoice
                    </th>
                  </tr>
                  <tr>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      رقم المشروع
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      {{ InvPrintData?.invoicesVM_VD?.projectNo }}
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      Project No
                    </th>
                  </tr>

                  <tr>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      رقم العقد
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      {{ CustomData.ContractNo }}
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      Contract No
                    </th>
                  </tr>
                </thead>
              </table>
            </div>
          </div>

          <!--Details-->
          <div
            class="invoiceNe-details"
            style="margin-bottom: 0px; display: flex"
          >
            <!--second table-->
            <div class="secondNe-table" style="margin-left: 5px; width: 50%">
              <h4
                class="tableNe-heading"
                style="
                  background-color: #dceefd !important;
                  font-size: 15px;
                  letter-spacing: 0px;
                  font-weight: 700;
                  padding: 1px 10px;
                "
              >
                <span>بيانات المورد </span>
                <span>Seller</span>
              </h4>
              <table style="vertical-align: middle; text-align: center">
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الاسم
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.branch_VD?.isPrintInvoice == true
                        ? InvPrintData?.branch_VD?.nameAr
                        : InvPrintData?.org_VD?.nameAr
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Name
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    العنوان
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.address
                        : InvPrintData?.branch_VD?.address
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Address
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    ر.المبنى
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.buildingNumber
                        : InvPrintData?.branch_VD?.buildingNumber
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Build.No
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الشارع
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.streetName
                        : InvPrintData?.branch_VD?.streetName
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Street
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الحي
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.neighborhood
                        : InvPrintData?.branch_VD?.neighborhood
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Area
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    المدينة
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.cityName
                        : InvPrintData?.branch_VD?.cityName
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    City
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الدولة
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.country
                        : InvPrintData?.branch_VD?.country
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Country
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    ر.البريدى
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.postalCodeFinal
                        : InvPrintData?.branch_VD?.postalCodeFinal
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    P.Code
                  </th>
                </tr>

                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    ر.الاضافي
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.externalPhone
                        : InvPrintData?.branch_VD?.externalPhone
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Addit. No
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الرقم الضريبي
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.taxCode
                        : InvPrintData?.branch_VD?.taxCode
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    VAT Number
                  </th>
                </tr>
                <tr></tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الفرع
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.branch_VD?.isPrintInvoice == true
                        ? InvPrintData?.branch_VD?.nameAr
                        : "--"
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Branch
                  </th>
                </tr>
              </table>
            </div>
            <!--second table-->
            <!--third table-->
            <div class="thirdNe-table" style="margin-right: 5px; width: 50%">
              <h4
                class="tableNe-heading"
                style="
                  background-color: #faebd7 !important;
                  font-size: 15px;
                  letter-spacing: 0px;
                  font-weight: 700;
                  padding: 1px 10px;
                "
              >
                <span>بيانات العميل </span>
                <span>Customer</span>
              </h4>
              <table style="vertical-align: middle; text-align: center">
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الاسم
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.customerVM_VD?.customerNameAr }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Name
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    العنوان
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.customerVM_VD?.customerAddress }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Address
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    ر.المبنى
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.customerVM_VD?.buildingNumber }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Build.No
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الشارع
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.customerVM_VD?.streetName }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Street
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الحي
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.customerVM_VD?.neighborhood }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Area
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    المدينة
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.customerVM_VD?.cityName }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    City
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الدولة
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.customerVM_VD?.country }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Country
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    ر.البريدى
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.customerVM_VD?.postalCodeFinal }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    P.Code
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    ر.الاضافي
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.customerVM_VD?.externalPhone }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Addit.No
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    ر.الضريبي
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.customerVM_VD?.commercialRegInvoice }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    VAT
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    معرف اخر
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.customerVM_VD?.commercialRegister }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    A.SellerID
                  </th>
                </tr>
              </table>
            </div>
            <!--third table-->
          </div>

          <!--totalNe-invoice-->
          <div class="totalNe-invoice" style="margin-bottom: 0px">
            <table
              style="
                max-width: 100%;
                vertical-align: middle;
                text-align: center;
              "
            >
              <thead>
                <tr>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 2px 0px;
                    "
                  >
                    م <br />
                    .No
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 2px 0px;
                    "
                  >
                    اسم الخدمة <br />
                    Item Name
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 2px 0px;
                    "
                  >
                    الوحدة <br />
                    Unit
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 2px 0px;
                    "
                  >
                    الكمية <br />
                    .Qty
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 2px 0px;
                    "
                  >
                    السعر <br />
                    Price
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 2px 0px;
                    "
                  >
                    الخصم <br />
                    Discount
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 2px 0px;
                    "
                  >
                    نسبة الخصم <br />
                    discount percent
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 2px 0px;
                    "
                  >
                    الصافي<br />
                    Net
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 2px 0px;
                    "
                  >
                    ض.ق.المضافة <br />
                    VAT
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 2px 0px;
                    "
                  >
                    الصافي + الضريبة <br />
                    Net + VAT
                  </th>
                </tr>
              </thead>
              <tbody style="line-height: 1.2em">
                <tr
                  *ngFor="
                    let item of InvPrintData?.voucherDetailsVM_VD;
                    let i = index
                  "
                >
                  <td>{{ i + 1 }}</td>
                  <td>
                    <span style="font-size: 13px; font-weight: 700">{{
                      item.servicesPriceName
                    }}</span>
                    <ul
                      *ngFor="
                        let det of item?.servicesPricesOffer;
                        let i = index
                      "
                      style="
                        list-style: none;
                        padding: 0px;
                        margin-inline-start: 10px;
                        text-align: right;
                        margin-top: 3px;
                        line-height: 16px;
                        font-size: 12px;
                      "
                    >
                      <hr style="margin: 6px" />
                      <li>
                        <span style="font-size: 12px; font-weight: 800">-</span>
                        {{ det.name }}
                      </li>
                    </ul>
                  </td>
                  <!-- <td>{{ item.servicesPriceName }}</td> -->
                  <td>{{ item.serviceTypeName }}</td>
                  <td>{{ item.qty }}</td>
                  <td>{{ GetAccualValue(item) }}</td>
                  <td>{{ item.discountValue_Det }}</td>
                  <td>{{ item.discountPercentage_Det }}</td>
                  <td>{{ GetDiff(item) }}</td>
                  <td>{{ item.taxAmount }}</td>
                  <td>{{ item.totalAmount }}</td>
                </tr>
              </tbody>
            </table>
          </div>

          <!--totalNe-invoice-->
          <!--invoice value-->
          <div
            class="invoiceNe-value"
            style="display: block !important; margin-bottom: 3px"
          >
            <div class="invoiceNe-divided">
              <div class="invoiceNe-value-right-side">
                <p style="margin-bottom: 2px">
                  <span> الإجمالي : </span>
                  <span>{{ CustomData.Total }}</span>
                </p>
                <p style="margin-bottom: 2px">
                  <span> الخصم : </span>
                  <span>{{ CustomData.DiscPer }} % {{ CustomData.Disc }}</span>
                </p>
                <p style="margin-bottom: 2px">
                  <span> الإجمالي بعد الخصم : </span>
                  <span>{{ CustomData.TotalAfterDisc }}</span>
                </p>
                <p style="margin-bottom: 2px">
                  <span> الصافي : </span>
                  <span>{{ CustomData.netVal }}</span>
                </p>
                <p style="margin-bottom: 2px">
                  <span> ضريبة القيمة المضافة (15%) : </span>
                  <span>{{ InvPrintData?.invoicesVM_VD.taxAmount ?? 0 }}</span>
                </p>
                <p
                  style="
                    margin-bottom: 3px;
                    background-color: #dceefd;
                    padding: 1px;
                    min-width: 637px;
                    max-width: 637px;
                  "
                >
                  <span>إجمايل المبلغ المطلوب سداده: </span>
                  <span>{{ InvPrintData?.invoicesVM_VD.totalValue ?? 0 }}</span>
                  <span style="margin-right: 6%"
                    >({{ InvPrintData?.valueNumString }})</span
                  >
                </p>
                <p
                  style="
                    margin-bottom: 3px;
                    background-color: #dceefd;
                    padding: 1dvh;
                    min-width: 637px;
                    max-width: 637px;
                  "
                >
                  <span>الملاحظات:</span>
                  <span>{{ InvPrintData?.invoicesVM_VD.notes }}</span>
                </p>
                <p
                  style="
                    margin-bottom: 3px;
                    background-color: #dceefd;
                    padding: 1px;
                    min-width: 637px;
                    max-width: 637px;
                    font-size: 15px !important;
                  "
                >
                  <span>وسائل الدفع:</span>
                  <span></span>
                </p>
              </div>
              <div class="invoiceNe-value-right-side">
                <p style="margin-bottom: 2px">
                  <span>المدفوع :</span>
                  <span>{{ InvPrintData?.invoicesVM_VD.paidValue ?? 0 }}</span>
                </p>
                <p style="margin-bottom: 2px">
                  <span>المتبقي :</span>
                  <span>{{
                    (InvPrintData?.invoicesVM_VD.totalValue ?? 0) -
                      (InvPrintData?.invoicesVM_VD.paidValue ?? 0)
                  }}</span>
                </p>
                <p
                  style="margin-top: 120%; color: red"
                  *ngIf="CustomData?.PrintType != 1"
                >
                  <span>{{ CustomData?.PrintTypeName }}</span>
                </p>
                <p style="color: red" *ngIf="CustomData?.PrintType != 1">
                  <span>{{ "رقم الإشعار : "  }}</span>
                  </p>
                  <p style="color: red" *ngIf="CustomData?.PrintType != 1">
                    <span>{{ InvPrintData?.invoicesVM_VD?.invoiceRetId }}</span>
                    </p>
              </div>
            </div>
          </div>

          <!--invoice -bank-account-->
          <!--invoiceNe-footer-->
          <div
            class="invoiceNe-footer"
            style="
              display: flex !important;
              justify-content: space-between;
              align-items: start;
            "
          >
            <div>
              <img
                *ngIf="CustomData.Account1Img"
                src="{{ CustomData.Account1Img }}"
                alt=""
                style="
                  display: block !important;
                  width: 100px;
                  height: 70px;
                  object-fit: fill;
                  margin-bottom: 5px;
                "
              />
              <img
                *ngIf="CustomData.Account2Img"
                src="{{ CustomData.Account2Img }}"
                alt=""
                style="
                  display: block !important;
                  width: 100px;
                  height: 70px;
                  object-fit: fill;
                "
              />
            </div>

            <div>
              <h4>{{ CustomData.Account1Bank }}</h4>
              <h4>{{ CustomData.Account2Bank }}</h4>
              <h4 *ngIf="InvPrintData?.invoicesVM_VD.appearUser == 1">
                {{ InvPrintData?.invoicesVM_VD.addUser }}
              </h4>
            </div>

            <div class="qrNe-code">
              <img
                #conditionimg
                src="{{ InvPrintData?.qrCodeString_VD }}"
                alt="QRCode"
                style="height: 140px; width: 180px"
              />
            </div>
          </div>

          <!--invoiceNe-footer-->
          <!--Details-->
        </div>
        <!--invoiceNe-content-->
        <div>
          <img
            *ngIf="CustomData.footerurl"
            src="{{ CustomData.footerurl }}"
            alt="footerurl"
            style="height: 60px; width: 100%; max-width: 100%; object-fit: fill"
          />
        </div>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button
      (click)="printDiv('divHtml_a')"
      class="min-w-max p-2 bg-sky-100 hover:bg-sky-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
    >
      <i class="fa fa-print"></i>
    </button>
    <button
      type="button"
      (click)="modal.dismiss()"
      mat-raised-button
      color="basic"
    >
      {{ "No" | translate }}
    </button>
  </div>
</ng-template>

<ng-template #printDivModalPurchase let-modal>
  <div class="modal-body">
    <div
      id="divHtml_aPurchase"
      class="divHtml"
      style="width: 100% !important; margin: 0px auto !important"
    >
      <div>
        <img
          *ngIf="CustomData.headerurl"
          src="{{ CustomData.headerurl }}"
          alt="headerurl"
          style="height: 60px; width: 100%; max-width: 100%; object-fit: fill"
        />
      </div>
      <div class="invoiceNe-wrapper" style="direction: rtl !important">
        <!--Header-->
        <div class="invoiceNe-header">
          <div class="headerNe-right-side">
            <img
              *ngIf="CustomData.OrgImg"
              src="{{ CustomData.OrgImg }}"
              alt="logo"
              style="
                height: 80px;
                width: 140px;
                max-width: 200px;
                object-fit: fill;
              "
            />
          </div>
          <div class="headerNe-lefy-side" style="width: 100%">
            <p>{{ InvPrintData?.org_VD?.nameAr }}</p>
            <p>{{ InvPrintData?.org_VD?.nameEn }}</p>
            <div class="line" style="position: relative; padding: 5px 0px 10px">
              <span
                style="
                  position: absolute;
                  right: 0;
                  width: 100%;
                  height: 2px;
                  background-color: #e5e5e5;
                  z-index: 1;
                "
              ></span>
              <span
                style="
                  position: absolute;
                  right: 0;
                  width: 70%;
                  height: 2px;
                  background-color: #ec1c24;
                  z-index: 2;
                "
              ></span>
            </div>
            <h1 style="margin-bottom: 0">فاتورة مشتريات</h1>
          </div>
        </div>
        <!--/Header-->

        <!--invoiceNe-content-->
        <div class="invoiceNe-content">
          <div class="firstNe-table-main-heading" style="display: flex">
            <div class="firstNe-table" style="margin-left: 5px; width: 50%">
              <table
                class="tableI"
                style="
                  margin-bottom: 5px;
                  vertical-align: middle;
                  text-align: center;
                "
              >
                <thead>
                  <tr>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      رقم الفاتورة
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      {{ InvPrintData?.invoicesVM_VD?.invoiceNumber }}
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      Invoice No
                    </th>
                  </tr>
                  <tr>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      تاريخ الفاتورة
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      {{ InvPrintData?.invoicesVM_VD?.date }}
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      Invoice Date
                    </th>
                  </tr>

                  <tr>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      تاريخ التوريد
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      {{ InvPrintData?.invoicesVM_VD?.date }}
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      Date of supply
                    </th>
                  </tr>
                </thead>
              </table>
            </div>
            <div class="firstNe-table" style="margin-right: 5px; width: 50%">
              <table
                of
                supplyable
                class="tableI"
                style="
                  margin-bottom: 5px;
                  vertical-align: middle;
                  text-align: center;
                "
              >
                <thead>
                  <tr>
                    <th
                      style="
                        background-color: #faebd7;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      فاتورة ضريبية
                    </th>
                    <th
                      style="
                        background-color: #faebd7;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      {{ InvPrintData?.invoicesVM_VD?.payTypeName }}
                    </th>
                    <th
                      style="
                        background-color: #faebd7;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      Tax Invoice
                    </th>
                  </tr>
                  <tr>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      رقم المشروع
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      {{ InvPrintData?.invoicesVM_VD?.projectNo }}
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      Project No
                    </th>
                  </tr>

                  <tr>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      رقم العقد
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      {{ InvPrintData?.invoicesVM_VD?.contractNo ?? "بدون" }}
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      Contract No
                    </th>
                  </tr>
                </thead>
              </table>
            </div>
          </div>

          <!--Details-->
          <div
            class="invoiceNe-details"
            style="margin-bottom: 0px; display: flex"
          >
            <!--second table-->
            <div class="secondNe-table" style="margin-left: 5px; width: 50%">
              <h4
                class="tableNe-heading"
                style="
                  background-color: #dceefd !important;
                  font-size: 15px;
                  letter-spacing: 0px;
                  font-weight: 700;
                  padding: 1px 10px;
                "
              >
                <span>بيانات المورد </span>
                <span>Seller</span>
              </h4>
              <table style="vertical-align: middle; text-align: center">
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الاسم
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.suppliersVM_VD?.nameAr }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Name
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    العنوان
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.suppliersVM_VD?.compAddress }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Address
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    ر.المبنى
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.suppliersVM_VD?.buildingNumber }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Build.No
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الشارع
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.suppliersVM_VD?.streetName }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Street
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الحي
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.suppliersVM_VD?.neighborhood }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Area
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    المدينة
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.suppliersVM_VD?.cityName }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    City
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الدولة
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.suppliersVM_VD?.country }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Country
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    ر.البريدى
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.suppliersVM_VD?.postalCodeFinal }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    P.Code
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    ر.الاضافي
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.suppliersVM_VD?.externalPhone }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Addit.No
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    ر.الضريبي
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.suppliersVM_VD?.taxNo }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    VAT
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    معرف اخر
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.suppliersVM_VD?.commercialRegister }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    A.SellerID
                  </th>
                </tr>
              </table>
            </div>
            <!--second table-->
            <!--third table-->
            <div class="thirdNe-table" style="margin-right: 5px; width: 50%">
              <h4
                class="tableNe-heading"
                style="
                  background-color: #faebd7 !important;
                  font-size: 15px;
                  letter-spacing: 0px;
                  font-weight: 700;
                  padding: 1px 10px;
                "
              >
                <span>بيانات العميل </span>
                <span>Customer</span>
              </h4>
              <table style="vertical-align: middle; text-align: center">
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الاسم
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.branch_VD?.isPrintInvoice == true
                        ? InvPrintData?.branch_VD?.nameAr
                        : InvPrintData?.org_VD?.nameAr
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Name
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    العنوان
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.address
                        : InvPrintData?.branch_VD?.address
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Address
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    ر.المبنى
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.buildingNumber
                        : InvPrintData?.branch_VD?.buildingNumber
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Build.No
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الشارع
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.streetName
                        : InvPrintData?.branch_VD?.streetName
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Street
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الحي
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.neighborhood
                        : InvPrintData?.branch_VD?.neighborhood
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Area
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    المدينة
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.cityName
                        : InvPrintData?.branch_VD?.cityName
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    City
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الدولة
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.country
                        : InvPrintData?.branch_VD?.country
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Country
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    ر.البريدى
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.postalCodeFinal
                        : InvPrintData?.branch_VD?.postalCodeFinal
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    P.Code
                  </th>
                </tr>

                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    ر.الاضافي
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.externalPhone
                        : InvPrintData?.branch_VD?.externalPhone
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Addit.No
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    ر.الضريبي
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.taxCode
                        : InvPrintData?.branch_VD?.taxCode
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    VAT
                  </th>
                </tr>
                <tr></tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الفرع
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.branch_VD?.isPrintInvoice == true
                        ? InvPrintData?.branch_VD?.nameAr
                        : "--"
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Branch
                  </th>
                </tr>
              </table>
            </div>
            <!--third table-->
          </div>

          <!--totalNe-invoice-->
          <div class="totalNe-invoice" style="margin-bottom: 0px">
            <table
              style="
                max-width: 100%;
                vertical-align: middle;
                text-align: center;
              "
            >
              <thead>
                <tr>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 5px 0px;
                    "
                  >
                    م <br />
                    .No
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 5px 0px;
                    "
                  >
                    اسم الخدمة <br />
                    Item Name
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 5px 0px;
                    "
                  >
                    الوحدة <br />
                    Unit
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 5px 0px;
                    "
                  >
                    الكمية <br />
                    .Qty
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 5px 0px;
                    "
                  >
                    السعر <br />
                    Price
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 5px 0px;
                    "
                  >
                    الخصم <br />
                    Discount
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 5px 0px;
                    "
                  >
                    نسبة الخصم <br />
                    discount percent
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 5px 0px;
                    "
                  >
                    الصافي<br />
                    Net
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 5px 0px;
                    "
                  >
                    ض.ق.المضافة <br />
                    VAT
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 5px 0px;
                    "
                  >
                    الصافي + الضريبة <br />
                    Net + VAT
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr
                  *ngFor="
                    let item of InvPrintData?.voucherDetailsVM_VD;
                    let i = index
                  "
                >
                  <td>{{ i + 1 }}</td>
                  <td>{{ item.categoryName }}</td>
                  <td>{{ item.categoryTypeName }}</td>
                  <td>{{ item.qty }}</td>
                  <td>{{ GetAccualValue(item) }}</td>
                  <td>{{ item.discountValue_Det }}</td>
                  <td>{{ item.discountPercentage_Det }}</td>
                  <td>{{ GetDiff(item) }}</td>
                  <td>{{ item.taxAmount }}</td>
                  <td>{{ item.totalAmount }}</td>
                </tr>
              </tbody>
            </table>
          </div>

          <!--totalNe-invoice-->
          <!--invoice value-->
          <div
            class="invoiceNe-value"
            style="display: block !important; margin-bottom: 3px"
          >
            <div class="invoiceNe-divided">
              <div class="invoiceNe-value-right-side">
                <p style="margin-bottom: 2px">
                  <span> الإجمالي : </span>
                  <span>{{ CustomData.Total }}</span>
                </p>
                <p style="margin-bottom: 2px">
                  <span> الخصم : </span>
                  <span>{{ CustomData.DiscPer }} % {{ CustomData.Disc }}</span>
                </p>
                <p style="margin-bottom: 2px">
                  <span> الإجمالي بعد الخصم : </span>
                  <span>{{ CustomData.TotalAfterDisc }}</span>
                </p>
                <p style="margin-bottom: 2px">
                  <span> الصافي : </span>
                  <span>{{ CustomData.netVal }}</span>
                </p>
                <p style="margin-bottom: 2px">
                  <span> ضريبة القيمة المضافة (15%) : </span>
                  <span>{{ InvPrintData?.invoicesVM_VD.taxAmount ?? 0 }}</span>
                </p>
                <p
                  style="
                    margin-bottom: 7px;
                    background-color: #dceefd;
                    padding: 2px;
                    min-width: 560px;
                    max-width: 560px;
                  "
                >
                  <span>إجمايل المبلغ المطلوب سداده: </span>
                  <span>{{ InvPrintData?.invoicesVM_VD.totalValue ?? 0 }}</span>
                  <span style="margin-right: 6%"
                    >({{ InvPrintData?.valueNumString }})</span
                  >
                </p>
                <p
                  style="
                    margin-bottom: 7px;
                    background-color: #dceefd;
                    padding: 2dvh;
                    min-width: 560px;
                    max-width: 560px;
                  "
                >
                  <span>الملاحظات:</span>
                  <span>{{ InvPrintData?.invoicesVM_VD.notes }}</span>
                </p>
                <p
                  style="
                    margin-bottom: 7px;
                    background-color: #dceefd;
                    padding: 2px;
                    min-width: 560px;
                    max-width: 560px;
                    font-size: 15px !important;
                  "
                >
                  <span>وسائل الدفع:</span>
                  <span></span>
                </p>
              </div>
              <div class="invoiceNe-value-right-side">
                <p style="margin-bottom: 2px">
                  <span>المدفوع :</span>
                  <span>{{ InvPrintData?.invoicesVM_VD.paidValue ?? 0 }}</span>
                </p>
                <p style="margin-bottom: 2px">
                  <span>المتبقي :</span>
                  <span>{{
                    (InvPrintData?.invoicesVM_VD.totalValue ?? 0) -
                      (InvPrintData?.invoicesVM_VD.paidValue ?? 0)
                  }}</span>
                </p>
                <p
                  style="margin-top: 120%; color: red"
                  *ngIf="CustomData?.PrintType != 1"
                >
                  <span>{{ CustomData?.PrintTypeName }}</span>
                </p>
                <p style="color: red" *ngIf="CustomData?.PrintType != 1">
                  <span>{{ "رقم الإشعار : "  }}</span>
                  </p>
                  <p style="color: red" *ngIf="CustomData?.PrintType != 1">
                    <span>{{ InvPrintData?.invoicesVM_VD?.invoiceRetId }}</span>
                    </p>
              </div>
            </div>
          </div>

          <!--invoice -bank-account-->
          <!--invoiceNe-footer-->
          <div
            class="invoiceNe-footer"
            style="
              display: flex !important;
              justify-content: space-between;
              align-items: start;
            "
          >
            <div>
              <img
                *ngIf="CustomData.Account1Img"
                src="{{ CustomData.Account1Img }}"
                alt=""
                style="
                  display: block !important;
                  width: 100px;
                  height: 70px;
                  object-fit: fill;
                  margin-bottom: 5px;
                "
              />
              <img
                *ngIf="CustomData.Account2Img"
                src="{{ CustomData.Account2Img }}"
                alt=""
                style="
                  display: block !important;
                  width: 100px;
                  height: 70px;
                  object-fit: fill;
                "
              />
            </div>

            <div>
              <h4>{{ CustomData.Account1Bank }}</h4>
              <h4>{{ CustomData.Account2Bank }}</h4>
              <h4>{{ InvPrintData?.invoicesVM_VD.addUser }}</h4>
            </div>

            <div class="qrNe-code">
              <img
                #conditionimg
                src="{{ InvPrintData?.qrCodeString_VD }}"
                alt="QRCode"
                style="height: 140px; width: 180px"
              />
            </div>
          </div>

          <!--invoiceNe-footer-->
          <!--Details-->
        </div>
        <!--invoiceNe-content-->
        <div>
          <img
            *ngIf="CustomData.footerurl"
            src="{{ CustomData.footerurl }}"
            alt="footerurl"
            style="height: 60px; width: 100%; max-width: 100%; object-fit: fill"
          />
        </div>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button
      (click)="printDiv('divHtml_aPurchase')"
      class="min-w-max p-2 bg-sky-100 hover:bg-sky-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
    >
      <i class="fa fa-print"></i>
    </button>
    <button
      type="button"
      (click)="modal.dismiss()"
      mat-raised-button
      color="basic"
    >
      {{ "No" | translate }}
    </button>
  </div>
</ng-template>

<ng-template #printDivModalRC let-modal>
  <div class="modal-body">
    <div
      id="reportprintDivModalRC"
      [ngStyle]="{ direction: lang == 'ar' ? 'rtl' : 'ltr' }"
    >
      <!--Header-->
      <div
        class="report-header"
        style="
          display: flex;
          align-items: center;
          gap: 100px;
          padding: 3px 0px;
          margin-bottom: 20px;
        "
      >
        <div class="headerNe-right-side">
          <img
            *ngIf="CustomDataCR"
            src="{{ CustomDataCR }}"
            alt="logo"
            style="
              height: 200px;
              width: 200px;
              max-width: 200px;
              object-fit: fill;
            "
          />
        </div>

        <div class="headerNe-lefy-side" style="width: 100%">
          <h1
            style="
              letter-spacing: 0.25px;
              font-size: 23px;
              margin: 0;
              margin-bottom: 5px;
            "
          >
            {{ EntryVoucherPrintData?.org_VD?.nameAr }}
          </h1>
          <h1
            style="
              letter-spacing: 0.25px;
              font-size: 23px;
              margin: 0;
              margin-bottom: 5px;
            "
          >
            {{ EntryVoucherPrintData?.org_VD?.nameEn }}
          </h1>
          <div class="line" style="position: relative; padding: 5px 0px 10px">
            <span
              style="
                position: absolute;
                right: 0;
                width: 100%;
                height: 2px;
                background-color: #e5e5e5;
                z-index: 1;
              "
            ></span>
            <span
              style="
                position: absolute;
                right: 0;
                width: 70%;
                height: 2px;
                background-color: #ec1c24;
                z-index: 2;
              "
            ></span>
          </div>

          <h1
            style="
              margin-bottom: 0;
              font-size: 34px;
              color: #0c8191;
              margin-bottom: 0;
              margin-top: 30px;
              font-weight: 500;
            "
            [translate]="'name'"
            [translateParams]="{
              ar: ' سند قبض',
              en: ' Catch Receipt'
            }"
          ></h1>
        </div>
      </div>
      <!--/Header-->

      <div style="margin-bottom: 10px">
        <p>
          <span
            [translate]="'name'"
            [translateParams]="{
              ar: 'التاريخ: ',
              en: 'Date: '
            }"
          ></span>
          <span> {{ EntryVoucherPrintData?.dateTimeNow }}</span>
          <span
            *ngIf="CustomDataNoteInvoice"
            style="margin-right: 18%; color: red"
          >
            {{ CustomDataNoteInvoice }}</span
          >
        </p>
      </div>

      <div class="info" style="overflow: auto; margin-bottom: 20px">
        <table
          class="table table-bordered m-0"
          style="
            width: 100%;
            color: white;
            text-align: center;
            vertical-align: middle;
            min-width: max-content;
          "
        >
          <tr>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
            >
              ريال .S.R
            </td>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
            >
              {{ "Bond number" | translate }}
            </td>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
            >
              {{ "Invoice Number" | translate }}
            </td>
            <td
              style="
                line-height: 0 !important;
                padding: 0px !important;
                background-color: #f7f7f7;
                border: 1px solid #dce0e4;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
              colspan="2"
            >
              <span
                style="
                  border: none;
                  display: inline-block;
                  padding: 10px 0px;
                  border: 1px solid #dce0e4;
                  width: 100%;

                  line-height: 24px;
                "
                [translate]="'name'"
                [translateParams]="{ ar: 'تاريخ السند', en: 'Vouvher Date' }"
              ></span>
            </td>
          </tr>
          <tr>
            <td
              style="
                width: 25%;
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 500;
                border: 1px solid #dce0e4;
                padding: 10px 0px;
              "
            >
              {{ EntryVoucherPrintData?.voucherVM[0].totalValue }}
            </td>
            <td
              style="
                width: 25%;
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 500;
                border: 1px solid #dce0e4;
                padding: 10px 0px;
              "
            >
              {{ EntryVoucherPrintData?.voucherVM[0].invoiceNumber }}
            </td>
            <td
              style="
                width: 20%;
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 500;
                border: 1px solid #dce0e4;
                padding: 10px 0px;
              "
            >
              {{ CustomDatatoInvoice }}
            </td>
            <td
              style="
                width: 15%;
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 500;
                border: 1px solid #dce0e4;
                padding: 10px 0px;
              "
            >
              {{ EntryVoucherPrintData?.voucherVM[0].date }}
            </td>
            <td
              style="
                width: 15%;
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 500;
                border: 1px solid #dce0e4;
                padding: 10px 0px;
              "
            >
              {{ EntryVoucherPrintData?.voucherVM[0].hijriDate }}
            </td>
          </tr>
        </table>
      </div>
      <div class="services" style="width: 100%; margin-bottom: 20px">
        <div class="content">
          <table
            style="text-align: center; vertical-align: middle; width: 100%"
          >
            <!-- <thead>
              <td
                style="
                  font-size: 16px;
                  background-color: #fff;
                  padding: 14px 4px;
                  text-align: center;
                  color: #272727;
                  word-wrap: break-word;
                  border-inline-start: 1px dashed #0c8191;
                  border: 1px dashed #272727;
                  font-weight: 600;
                "
              >{{"account code"|translate}}</td>
              <td
                style="
                  font-size: 16px;
                  background-color: #fff;
                  padding: 14px 4px;
                  text-align: center;
                  color: #272727;
                  word-wrap: break-word;
                  border-inline-start: 1px dashed #0c8191;
                  border: 1px dashed #272727;
                  font-weight: 600;
                "
              >{{"account name"|translate}}</td>
              <td
                style="
                  font-size: 16px;
                  background-color: #f7f7f7;
                  padding: 14px 4px;
                  text-align: center;
                  color: #272727;
                  word-wrap: break-word;
                  border-inline-start: 1px dashed #0c8191;
                  border: 1px dashed #272727;
                  font-weight: 600;
                "
               >{{"Debit"|translate}}</td>
              <td
                style="
                  font-size: 16px;
                  background-color: #f7f7f7;
                  padding: 14px 4px;
                  text-align: center;
                  color: #272727;
                  word-wrap: break-word;
                  border-inline-start: 1px dashed #0c8191;
                  border: 1px dashed #272727;
                  font-weight: 600;
                "
               >{{"Credit"|translate}}</td>
               <td
                style="
                  font-size: 16px;
                  background-color: #fff;
                  padding: 14px 4px;
                  text-align: center;
                  color: #272727;
                  word-wrap: break-word;
                  border-inline-start: 1px dashed #0c8191;
                  border: 1px dashed #272727;
                  font-weight: 600;
                "
               >{{"Statement"|translate}}</td>
              <td
                style="
                  font-size: 16px;
                  background-color: #fff;
                  padding: 14px 4px;
                  text-align: center;
                  color: #272727;
                  word-wrap: break-word;
                  border-inline-start: 1px dashed #0c8191;
                  border: 1px dashed #272727;
                  font-weight: 600;
                "
               >{{"costCenter"|translate}}</td>
            </thead> -->
            <tbody>
              <tr
                *ngFor="let item of EntryVoucherPrintData?.voucherVM"
                style="display: flex; flex-direction: column"
              >
                <td
                  style="
                    background-color: #fff;
                    font-size: 15px;
                    font-weight: 500;
                    padding: 10px 50px;
                    color: #272727;
                    display: flex;
                    justify-content: space-between;
                  "
                >
                  <span> استلمنا من السيد / السادة</span>
                  <span>{{ item.recevierTxt }} </span>
                  <span>Received From Mr/Messrs</span>
                </td>
                <td
                  style="
                    background-color: #fff;
                    font-size: 15px;
                    font-weight: 500;
                    padding: 10px 50px;
                    color: #272727;
                    display: flex;
                    justify-content: space-between;
                  "
                >
                  <span> مبلغ و قدره</span>
                  <span>{{ item.invoiceValueText }} </span>
                  <span>The sum of S.R</span>
                </td>
                <td
                  style="
                    background-color: #fff;
                    font-size: 15px;
                    font-weight: 500;
                    padding: 10px 50px;
                    color: #272727;
                    display: flex;
                    justify-content: space-between;
                  "
                >
                  <span> نوع السند </span>
                  <span>{{ getpayType(item.payType) }} </span>
                  <span>Voucher</span>
                </td>
                <td
                  style="
                    background-color: #fff;
                    font-size: 15px;
                    font-weight: 500;
                    padding: 10px 50px;
                    color: #272727;
                    display: flex;
                    justify-content: space-between;
                  "
                >
                  <span> تاريخ</span>
                  <span>{{ item.checkDate }} </span>
                  <span> Date</span>
                </td>
                <td
                  style="
                    background-color: #fff;
                    font-size: 15px;
                    font-weight: 500;
                    padding: 10px 50px;
                    color: #272727;
                    display: flex;
                    justify-content: space-between;
                  "
                >
                  <span> المسحوب علي بنك</span>
                  <span>{{ item.bankName }} </span>
                  <span>Bank</span>
                </td>
                <td
                  style="
                    background-color: #fff;
                    font-size: 15px;
                    font-weight: 500;
                    padding: 10px 50px;
                    color: #272727;
                    display: flex;
                    justify-content: space-between;
                  "
                >
                  <span> وذلك مقابل</span>
                  <span>{{ item.description }} </span>
                  <span>And That For</span>
                </td>
                <td
                  style="
                    background-color: #fff;
                    font-size: 15px;
                    font-weight: 500;
                    padding: 10px 50px;
                    color: #272727;
                    display: flex;
                    justify-content: space-between;
                  "
                >
                  <span>مركز التكلفة </span>
                  <span>{{ item.costCenterName }} </span>
                  <span>Cost center</span>
                </td>
                <td
                  style="
                    background-color: #fff;
                    font-size: 15px;
                    font-weight: 500;
                    padding: 10px 50px;
                    color: #272727;
                    display: flex;
                    justify-content: space-between;
                  "
                >
                  <span> ملاحظات</span>
                  <span>{{ item.notes }} </span>
                  <span>Notes</span>
                </td>
              </tr>
            </tbody>
          </table>

          <div
            style="
              display: grid;
              grid-template-columns: auto auto auto auto;
              padding-top: 20px;
            "
            class="text-center"
          >
            <div class="grid-item">
              <p>
                المستلم<br />Receiver<br />......................................
              </p>
            </div>
            <div class="grid-item">
              <p>
                المحاسب<br />Accountant<br />......................................
              </p>
            </div>
            <div class="grid-item">
              <p>الختم<br />Seal<br />......................................</p>
            </div>
            <div class="grid-item">
              <p>
                المدير المالي واالاداري<br />Manger<br />......................................
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button
      (click)="printDiv('reportprintDivModalRC')"
      class="min-w-max p-2 bg-sky-100 hover:bg-sky-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
    >
      <i class="fa fa-print"></i>
    </button>
    <button
      type="button"
      (click)="modal.dismiss()"
      mat-raised-button
      color="basic"
    >
      {{ "No" | translate }}
    </button>
  </div>
</ng-template>

<ng-template #printDivModalR let-modal>
  <div class="modal-body">
    <div
      id="reportprintDivModalR"
      [ngStyle]="{ direction: lang == 'ar' ? 'rtl' : 'ltr' }"
    >
      <!--Header-->
      <div
        class="report-header"
        style="
          display: flex;
          align-items: center;
          gap: 100px;
          padding: 3px 0px;
          margin-bottom: 20px;
        "
      >
        <div class="headerNe-right-side">
          <img
            *ngIf="CustomDataR"
            src="{{ CustomDataR }}"
            alt="logo"
            style="
              height: 200px;
              width: 200px;
              max-width: 200px;
              object-fit: fill;
            "
          />
        </div>

        <div class="headerNe-lefy-side" style="width: 100%">
          <h1
            style="
              letter-spacing: 0.25px;
              font-size: 23px;
              margin: 0;
              margin-bottom: 5px;
            "
          >
            {{ EntryVoucherPrintData?.org_VD?.nameAr }}
          </h1>
          <h1
            style="
              letter-spacing: 0.25px;
              font-size: 23px;
              margin: 0;
              margin-bottom: 5px;
            "
          >
            {{ EntryVoucherPrintData?.org_VD?.nameEn }}
          </h1>
          <div class="line" style="position: relative; padding: 5px 0px 10px">
            <span
              style="
                position: absolute;
                right: 0;
                width: 100%;
                height: 2px;
                background-color: #e5e5e5;
                z-index: 1;
              "
            ></span>
            <span
              style="
                position: absolute;
                right: 0;
                width: 70%;
                height: 2px;
                background-color: #ec1c24;
                z-index: 2;
              "
            ></span>
          </div>

          <h1
            style="
              margin-bottom: 0;
              font-size: 34px;
              color: #0c8191;
              margin-bottom: 0;
              margin-top: 30px;
              font-weight: 500;
            "
            [translate]="'name'"
            [translateParams]="{
              ar: ' سند صرف',
              en: ' PayVoucher'
            }"
          ></h1>
        </div>
      </div>
      <!--/Header-->

      <div style="margin-bottom: 10px">
        <p>
          <span
            [translate]="'name'"
            [translateParams]="{
              ar: 'التاريخ: ',
              en: 'Date: '
            }"
          ></span>
          <span> {{ EntryVoucherPrintData?.dateTimeNow }}</span>
        </p>
      </div>

      <div class="info" style="overflow: auto; margin-bottom: 20px">
        <table
          class="table table-bordered m-0"
          style="
            width: 100%;
            color: white;
            text-align: center;
            vertical-align: middle;
            min-width: max-content;
          "
        >
          <tr>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
            >
              ريال .S.R
            </td>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
            >
              {{ "Bond number" | translate }}
            </td>
            <td
              style="
                line-height: 0 !important;
                padding: 0px !important;
                background-color: #f7f7f7;
                border: 1px solid #dce0e4;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
              colspan="2"
            >
              <span
                style="
                  border: none;
                  display: inline-block;
                  padding: 10px 0px;
                  border: 1px solid #dce0e4;
                  width: 100%;

                  line-height: 24px;
                "
                [translate]="'name'"
                [translateParams]="{ ar: 'تاريخ السند', en: 'Vouvher Date' }"
              ></span>
            </td>
          </tr>
          <tr>
            <td
              style="
                width: 25%;
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 500;
                border: 1px solid #dce0e4;
                padding: 10px 0px;
              "
            >
              {{ EntryVoucherPrintData?.voucherVM[0].totalValue }}
            </td>
            <td
              style="
                width: 25%;
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 500;
                border: 1px solid #dce0e4;
                padding: 10px 0px;
              "
            >
              {{ EntryVoucherPrintData?.voucherVM[0].invoiceNumber }}
            </td>
            <td
              style="
                width: 25%;
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 500;
                border: 1px solid #dce0e4;
                padding: 10px 0px;
              "
            >
              {{ EntryVoucherPrintData?.voucherVM[0].date }}
            </td>
            <td
              style="
                width: 25%;
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 500;
                border: 1px solid #dce0e4;
                padding: 10px 0px;
              "
            >
              {{ EntryVoucherPrintData?.voucherVM[0].hijriDate }}
            </td>
          </tr>
        </table>
      </div>
      <div class="services" style="width: 100%; margin-bottom: 20px">
        <div class="content">
          <table
            style="text-align: center; vertical-align: middle; width: 100%"
          >
            <!-- <thead>
              <td
                style="
                  font-size: 16px;
                  background-color: #fff;
                  padding: 14px 4px;
                  text-align: center;
                  color: #272727;
                  word-wrap: break-word;
                  border-inline-start: 1px dashed #0c8191;
                  border: 1px dashed #272727;
                  font-weight: 600;
                "
              >{{"account code"|translate}}</td>
              <td
                style="
                  font-size: 16px;
                  background-color: #fff;
                  padding: 14px 4px;
                  text-align: center;
                  color: #272727;
                  word-wrap: break-word;
                  border-inline-start: 1px dashed #0c8191;
                  border: 1px dashed #272727;
                  font-weight: 600;
                "
              >{{"account name"|translate}}</td>
              <td
                style="
                  font-size: 16px;
                  background-color: #f7f7f7;
                  padding: 14px 4px;
                  text-align: center;
                  color: #272727;
                  word-wrap: break-word;
                  border-inline-start: 1px dashed #0c8191;
                  border: 1px dashed #272727;
                  font-weight: 600;
                "
               >{{"Debit"|translate}}</td>
              <td
                style="
                  font-size: 16px;
                  background-color: #f7f7f7;
                  padding: 14px 4px;
                  text-align: center;
                  color: #272727;
                  word-wrap: break-word;
                  border-inline-start: 1px dashed #0c8191;
                  border: 1px dashed #272727;
                  font-weight: 600;
                "
               >{{"Credit"|translate}}</td>
               <td
                style="
                  font-size: 16px;
                  background-color: #fff;
                  padding: 14px 4px;
                  text-align: center;
                  color: #272727;
                  word-wrap: break-word;
                  border-inline-start: 1px dashed #0c8191;
                  border: 1px dashed #272727;
                  font-weight: 600;
                "
               >{{"Statement"|translate}}</td>
              <td
                style="
                  font-size: 16px;
                  background-color: #fff;
                  padding: 14px 4px;
                  text-align: center;
                  color: #272727;
                  word-wrap: break-word;
                  border-inline-start: 1px dashed #0c8191;
                  border: 1px dashed #272727;
                  font-weight: 600;
                "
               >{{"costCenter"|translate}}</td>
            </thead> -->
            <tbody>
              <tr
                *ngFor="let item of EntryVoucherPrintData?.voucherVM"
                style="display: flex; flex-direction: column"
              >
                <td
                  style="
                    background-color: #fff;
                    font-size: 15px;
                    font-weight: 500;
                    padding: 10px 50px;
                    color: #272727;
                    display: flex;
                    justify-content: space-between;
                  "
                >
                  <span> اصرفوا الي السيد / السيدة</span>
                  <span>{{ item.supplierName }} </span>
                  <span>Received From Mr/Messrs</span>
                </td>
                <td
                  style="
                    background-color: #fff;
                    font-size: 15px;
                    font-weight: 500;
                    padding: 10px 50px;
                    color: #272727;
                    display: flex;
                    justify-content: space-between;
                  "
                >
                  <span> مبلغ و قدره</span>
                  <span>{{ item.invoiceValueText }} </span>
                  <span>The sum of S.R</span>
                </td>
                <td
                  style="
                    background-color: #fff;
                    font-size: 15px;
                    font-weight: 500;
                    padding: 10px 50px;
                    color: #272727;
                    display: flex;
                    justify-content: space-between;
                  "
                >
                  <span> نوع السند </span>
                  <span>{{ getpayType(item.payType) }} </span>
                  <span>Voucher</span>
                </td>
                <td
                  style="
                    background-color: #fff;
                    font-size: 15px;
                    font-weight: 500;
                    padding: 10px 50px;
                    color: #272727;
                    display: flex;
                    justify-content: space-between;
                  "
                >
                  <span> تاريخ</span>
                  <span>{{ item.checkDate }} </span>
                  <span> Date</span>
                </td>
                <td
                  style="
                    background-color: #fff;
                    font-size: 15px;
                    font-weight: 500;
                    padding: 10px 50px;
                    color: #272727;
                    display: flex;
                    justify-content: space-between;
                  "
                >
                  <span> المسحوب علي بنك</span>
                  <span>{{ item.bankName }} </span>
                  <span>Bank</span>
                </td>
                <td
                  style="
                    background-color: #fff;
                    font-size: 15px;
                    font-weight: 500;
                    padding: 10px 50px;
                    color: #272727;
                    display: flex;
                    justify-content: space-between;
                  "
                >
                  <span> وذلك مقابل</span>
                  <span>{{ item.description }} </span>
                  <span>And That For</span>
                </td>
                <td
                  style="
                    background-color: #fff;
                    font-size: 15px;
                    font-weight: 500;
                    padding: 10px 50px;
                    color: #272727;
                    display: flex;
                    justify-content: space-between;
                  "
                >
                  <span>مركز التكلفة </span>
                  <span>{{ item.costCenterName }} </span>
                  <span>Cost center</span>
                </td>
                <td
                  style="
                    background-color: #fff;
                    font-size: 15px;
                    font-weight: 500;
                    padding: 10px 50px;
                    color: #272727;
                    display: flex;
                    justify-content: space-between;
                  "
                >
                  <span> ملاحظات</span>
                  <span>{{ item.notes }} </span>
                  <span>Notes</span>
                </td>
              </tr>
            </tbody>
          </table>

          <div
            style="
              display: grid;
              grid-template-columns: auto auto auto auto;
              padding-top: 20px;
            "
            class="text-center"
          >
            <div class="grid-item">
              <p>
                المستلم<br />Receiver<br />......................................
              </p>
            </div>
            <div class="grid-item">
              <p>
                المحاسب<br />Accountant<br />......................................
              </p>
            </div>
            <div class="grid-item">
              <p>الختم<br />Seal<br />......................................</p>
            </div>
            <div class="grid-item">
              <p>
                المدير المالي واالاداري<br />Manger<br />......................................
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button
      (click)="printDiv('reportprintDivModalR')"
      class="min-w-max p-2 bg-sky-100 hover:bg-sky-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
    >
      <i class="fa fa-print"></i>
    </button>
    <button
      type="button"
      (click)="modal.dismiss()"
      mat-raised-button
      color="basic"
    >
      {{ "No" | translate }}
    </button>
  </div>
</ng-template>
<ng-template #PrintSupervisionBaseModal let-modal>
  <div class="modal-body">
    <div id="report" [ngStyle]="{ direction: 'rtl' }">
      <!--Header-->
      <div
        class="report-header"
        style="
          display: flex;
          align-items: center;
          gap: 100px;
          padding: 3px 0px;
          margin-bottom: 20px;
        "
      >
        <div class="headerNe-right-side">
          <img
            *ngIf="CustomDataPrintBase.OrgImg"
            src="{{ CustomDataPrintBase.OrgImg }}"
            alt="logo"
            style="
              height: 150px;
              width: 200px;
              max-width: 200px;
              object-fit: fill;
            "
          />
        </div>

        <div class="headerNe-lefy-side" style="width: 100%">
          <h1
            style="
              letter-spacing: 0.25px;
              font-size: 20px;
              margin: 0;
              margin-bottom: 1px;
            "
          >
            {{ SupervisionPrintBase?.org_VD?.nameAr }}
          </h1>
          <h1
            style="
              letter-spacing: 0.25px;
              font-size: 20px;
              margin: 0;
              margin-bottom: 4px;
            "
          >
            {{ SupervisionPrintBase?.org_VD?.nameEn }}
          </h1>
          <div class="line" style="position: relative; padding: 5px 0px 10px">
            <span
              style="
                position: absolute;
                right: 0;
                width: 100%;
                height: 2px;
                background-color: #e5e5e5;
                z-index: 1;
              "
            ></span>
            <span
              style="
                position: absolute;
                right: 0;
                width: 70%;
                height: 2px;
                background-color: #ec1c24;
                z-index: 2;
              "
            ></span>
          </div>

          <h3
            style="
              margin-bottom: 0;
              font-size: 22px;
              color: #0c8191;
              margin-bottom: 0;
              margin-top: 10px;
              font-weight: 500;
            "
            [translate]="'name'"
            [translateParams]="{
              ar: 'طلعة اشراف',
              en: 'supervision'
            }"
          ></h3>
        </div>
      </div>
      <!--/Header-->

      <div class="info" style="overflow: auto; margin-bottom: 20px">
        <table
          class="table table-bordered m-0"
          style="
            width: 100%;
            color: white;
            text-align: center;
            vertical-align: middle;
            min-width: max-content;
          "
        >
          <tr>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
              [translate]="'name'"
              [translateParams]="{ ar: 'العميل', en: 'customer name' }"
            ></td>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
            >
              {{ SupervisionPrintBase?.supervision[0]?.customerName }}
            </td>
          </tr>
          <tr>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
              [translate]="'name'"
              [translateParams]="{ ar: 'رقم المشروع', en: 'project number' }"
            ></td>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
            >
              {{ SupervisionPrintBase?.supervision[0]?.projectNo }}
            </td>
          </tr>
          <tr>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
              [translate]="'name'"
              [translateParams]="{ ar: 'اسم المرحلة', en: 'phase name' }"
            ></td>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
            >
              {{ SupervisionPrintBase?.supervision[0]?.phaseName }}
            </td>
          </tr>
          <tr>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
              [translate]="'name'"
              [translateParams]="{
                ar: 'رقم الاشراف',
                en: 'supervision number'
              }"
            ></td>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
            >
              {{ SupervisionPrintBase?.supervision[0]?.supervisionNumber }}
            </td>
          </tr>
          <tr>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
              [translate]="'name'"
              [translateParams]="{ ar: 'تاريخه', en: 'date' }"
            ></td>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
            >
              {{ SupervisionPrintBase?.supervision[0]?.date }}
            </td>
          </tr>
          <tr>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
              [translate]="'name'"
              [translateParams]="{ ar: 'المقاول', en: 'Contractor' }"
            ></td>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
            >
              {{ SupervisionPrintBase?.supervision[0]?.contractorName }}
            </td>
          </tr>
          <tr>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
              [translate]="'name'"
              [translateParams]="{ ar: 'المكلف بها', en: 'Received UserName' }"
            ></td>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
            >
              {{ SupervisionPrintBase?.supervision[0]?.receivedUserName }}
            </td>
          </tr>
          <tr>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
              [translate]="'name'"
              [translateParams]="{ ar: 'رقم الرخصه', en: 'license number' }"
            ></td>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
            >
              {{ SupervisionPrintBase?.supervision[0]?.licenseNo }}
            </td>
          </tr>
          <tr>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
              [translate]="'name'"
              [translateParams]="{ ar: 'رقم المخطط', en: 'Outline number' }"
            ></td>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
            >
              {{ SupervisionPrintBase?.supervision[0]?.outlineNo }}
            </td>
          </tr>
          <tr>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
              [translate]="'name'"
              [translateParams]="{ ar: 'رقم القطعة', en: 'Piece No' }"
            ></td>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
            >
              {{ SupervisionPrintBase?.supervision[0]?.contractorName }}
            </td>
          </tr>
          <tr>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
              [translate]="'name'"
              [translateParams]="{ ar: 'مكتب المتعاون', en: 'Office Name' }"
            ></td>
            <td
              style="
                padding-inline: 0px !important;
                background-color: #f7f7f7;
                font-size: 18px;
                color: #21403f;
                font-weight: 600;
                border: 1px solid #dce0e4;
              "
            >
              {{ SupervisionPrintBase?.supervision[0]?.officeName }}
            </td>
          </tr>
        </table>
      </div>

      <div class="services" style="width: 100%; margin-bottom: 20px">
        <div class="content">
          <table
            style="text-align: center; vertical-align: middle; width: 100%"
          >
            <thead>
              <td
                [translate]="'name'"
                [translateParams]="{
                  ar: 'اسم مرحلة الاستلام',
                  en: 'phase name'
                }"
                style="
                  font-size: 16px;
                  background-color: #fff;
                  padding: 14px 4px;
                  text-align: center;
                  color: #272727;
                  word-wrap: break-word;
                  border-inline-start: 1px dashed #0c8191;
                  border: 1px dashed #272727;
                  font-weight: 600;
                "
              ></td>
              <td
                [translate]="'name'"
                [translateParams]="{ ar: 'الحالة', en: 'status' }"
                style="
                  font-size: 16px;
                  background-color: #fff;
                  padding: 14px 4px;
                  text-align: center;
                  color: #272727;
                  word-wrap: break-word;
                  border-inline-start: 1px dashed #0c8191;
                  border: 1px dashed #272727;
                  font-weight: 600;
                "
              ></td>
              <td
                [translate]="'name'"
                [translateParams]="{ ar: 'ملاحظات', en: 'notes' }"
                style="
                  font-size: 16px;
                  background-color: #f7f7f7;
                  padding: 14px 4px;
                  text-align: center;
                  color: #272727;
                  word-wrap: break-word;
                  border-inline-start: 1px dashed #0c8191;
                  border: 1px dashed #272727;
                  font-weight: 600;
                "
              ></td>
            </thead>
            <tbody>
              <tr *ngFor="let item of SupervisionPrintBase?.supervision">
                <td
                  style="
                    background-color: #fff;
                    font-size: 15px;
                    font-weight: 500;
                    padding: 10px 0px;
                    color: #272727;
                    border-inline-start: 1px dashed #272727;
                    border-bottom: 1px dashed #272727;
                  "
                >
                  {{ item.nameAr }}
                </td>
                <td
                  style="
                    background-color: #fff;
                    font-size: 15px;
                    font-weight: 500;
                    padding: 10px 0px;
                    color: #272727;
                    border-inline-start: 1px dashed #272727;
                    border-bottom: 1px dashed #272727;
                  "
                >
                  {{ GetStatusName(item) }}
                </td>
                <td
                  style="
                    background-color: #fff;
                    font-size: 15px;
                    font-weight: 500;
                    padding: 10px 0px;
                    color: #272727;
                    border-inline-start: 1px dashed #272727;
                    border-bottom: 1px dashed #272727;
                  "
                >
                  {{ item.note }}
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button
      (click)="printDiv('report')"
      class="min-w-max p-2 bg-sky-100 hover:bg-sky-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
    >
      <i class="fa fa-print"></i>
    </button>
    <button
      type="button"
      (click)="modal.dismiss()"
      mat-raised-button
      color="basic"
    >
      {{ "No" | translate }}
    </button>
  </div>
</ng-template>
