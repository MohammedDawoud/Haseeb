<div class="modal-body text-center">
  <div class="content">
    <mat-stepper linear #stepper >
      <!-- 1 -->
      <mat-step [stepControl]="FormGroup01">
        <ng-template matStepLabel>{{
          "Contract data" | translate
        }}</ng-template>
        <form [formGroup]="FormGroup01">
          <div class="step-content" style="padding-bottom: 11% !important;">
            <div class="row align-items-end mb-4">
              <div class="col-sm-6 col-md-4 mb-0 mb-sm-3">
                <div class="form-group">
                  <label
                    for="ContractNo"
                    class="text-right col-form-label block"
                  >
                    {{ "contract number" | translate }}
                  </label>
                  <input
                    #ContractNo
                    type="text"
                    id="ContractNo"
                    name="ContractNo"
                    formControlName="ContractNo"
                    autocomplete="off"
                    class="form-control {{
                      ContractNo.value==null
                        ? 'errorInput'
                        : ''
                    }}"
                  />
                </div>
              </div>
              <div class="col-sm-6 col-md-4 mb-0 mb-sm-3">
                <div class="form-group">
                  <label for="ContractDate" class="text-right col-form-label block">
                    {{ "Date of contract" | translate }}
                  </label>
                  <input
                    class="form-control"
                    type="text"
                    id="ContractDate"
                    name="ContractDate"
                    formControlName="ContractDate"
                    bsDatepicker
                    autocomplete="off"
                    [bsConfig]="{dateInputFormat: 'DD/MM/YYYY'}"
                    (ngModelChange)="ChangeContractGre($event)"
                  />
                </div>
              </div>
              <div class="col-sm-6 col-md-4 mb-0 mb-sm-3">
                <div class="form-group">
                  <label
                    for="ContractHijriDate"
                    class="text-right col-form-label block"
                  >
                    {{ "Contract date (Hijri) *" | translate }}
                  </label>
                  <hijri-gregorian-datepicker
                    [(selectedDate)]="selectedHijriDate"
                    [isRequired]="true"
                    [hijriLabel]="'Hijri'"
                    [selectedDateType]="selectedDateType"
                    [dir]="'dir' | translate"
                    autocomplete="off"
                    (selectedDateChange)="ChangeContractHijri($event)"

                  >
                  </hijri-gregorian-datepicker>
                </div>
              </div>
              <div class="col-sm-6 col-md-6 mb-0 mb-sm-3">
                <div class="form-group">
                  <label
                    for="Org_CompanyName"
                    class="text-right col-form-label block"
                  >
                    {{
                      "The first party / the name of the office" | translate
                    }}
                  </label>
                  <input
                    class="form-control"
                    type="text"
                    id="Org_CompanyName"
                    name="Org_CompanyName"
                    formControlName="Org_CompanyName"
                    autocomplete="off"
                  />
                </div>
              </div>
              <div class="col-sm-6 col-md-3 mb-0 mb-sm-3">
                <div class="form-group">
                  <label class="text-right col-form-label block">
                    {{ "and represents it" | translate }}</label
                  >
                  <ng-select
                  #OrgEmpId
                    class="w-full p-0"
                    placeholder="{{ 'Chose' | translate }}"
                    name="OrgEmpId"
                    id="OrgEmpId"
                    formControlName="OrgEmpId"
                    (change)="GetEmployeeJob()"
                  >
                    <ng-option
                      *ngFor="let user of LoadEmployeeSelect"
                      [value]="user.id"
                      >{{ user.name }}</ng-option
                    >
                  </ng-select>
                </div>
              </div>
              <div class="col-sm-6 col-md-3 mb-0 mb-sm-3">
                <div class="form-group">
                  <label for="OrgEmpJob" class="text-right col-form-label block">
                    {{ "as" | translate }}
                  </label>
                  <input
                    class="form-control"
                    type="text"
                    id="OrgEmpJob"
                    name="OrgEmpJob"
                    formControlName="OrgEmpJob"
                  />
                </div>
              </div>

              <!-- <div class="col-sm-6 mb-0 mb-sm-3">
                <div class="form-group">
                  <label
                    for="Engineering_License"
                    class="text-right col-form-label block"
                  >
                    {{ "engineeringLicence" | translate }}
                  </label>
                  <input
                    class="form-control"
                    type="text"
                    id="Engineering_License"
                    name="Engineering_License"
                    formControlName="Engineering_License"
                  />
                </div>
              </div>
              <div class="col-sm-6 mb-0 mb-sm-3">
                <div class="form-group">
                  <label for="Engineering_LicenseDate" class="text-right col-form-label block">
                    {{ "IssuedOn*" | translate }}
                  </label>
                  <input
                    class="form-control"
                    type="text"
                    id="Engineering_LicenseDate"
                    name="Engineering_LicenseDate"
                    formControlName="Engineering_LicenseDate"
                    bsDatepicker
                    autocomplete="off"
                    [bsConfig]="{dateInputFormat: 'DD/MM/YYYY'}"
                  />
                </div>
              </div> -->

              <div class="col-sm-6 col-md-6 mb-0 mb-sm-3">
                <div class="form-group">
                  <label
                    for="ContractCustSelectId"
                    class="text-right col-form-label block"
                  >
                    {{ "The second party / customer" | translate }}
                  </label>
                  <ng-select
                    class="w-full p-0"
                    placeholder="{{ 'Chose' | translate }}"
                    name="ContractCustSelectId"
                    formControlName="ContractCustSelectId"
                    (change)="ChangeCustomerSelect()"
                  >
                    <ng-option
                      *ngFor="let user of LoadCustomerSelectWProC"
                      [value]="user.id"
                      >{{ user.name }}</ng-option
                    >
                  </ng-select>
                </div>
              </div>
              <!-- <div class="col-sm-6 col-md-3 mb-0 mb-sm-3">
                <div class="form-group">
                  <label for="ContractProjSelectId" class="text-right col-form-label block">
                    {{ "The project" | translate }}</label
                  >
                  <ng-select
                    class="w-full p-0"
                    placeholder="{{ 'Chose' | translate }}"
                    name="ContractProjSelectId"
                    id="ContractProjSelectId"
                    formControlName="ContractProjSelectId"
                    (change)="GetInvoiceIDByProjectID();"

                  >
                    <ng-option
                      *ngFor="let user of Loadprojects"
                      [value]="user.id"
                      >{{ user.name }}</ng-option
                    >
                  </ng-select>
                </div>
              </div> -->
              <div class="col-sm-6 col-md-3 mb-0 mb-sm-3">
                <div class="form-group">
                  <label
                    for="customerIdtxt"
                    class="text-right col-form-label block"
                  >
                    {{ "ID Number" | translate }}
                  </label>
                  <input
                    class="form-control"
                    type="text"
                    id="customerIdtxt"
                    name="customerIdtxt"
                    formControlName="customerIdtxt"
                  />
                </div>
              </div>
              <div class="col-sm-6 col-md-3 mb-0 mb-sm-3">
                <label
                  for="iDNumber"
                  class="text-right col-form-label block"
                >
                  {{ "Activate bid services" | translate }}
                </label>
                <div class="form-types checkbox justify-start mt-2">
                  <div class="checkbox-content relative">
                    <!-- [checked]="item.status == 2" -->
                    <input
                      type="checkbox"
                      name="check"
                      formControlName="check"
                      (change)="setOfferPriceChecked($event)"
                    />
                    <div
                      class="box {{
                        offerPriceChecked ? 'checked' : 'blur'
                      }}"
                    >
                      <span class="absolute">{{ "Yes" | translate }}</span>
                      <span class="absolute">{{ "No" | translate }}</span>
                      <div class="cycle"></div>
                    </div>
                  </div>
                </div>
              </div>
              <div
                *ngIf="offerPriceChecked"
                class="col-sm-6 col-md-3 mb-0 mb-sm-3"
              >
                <div class="form-group">
                  <label  for="OfferSelectid" class="col-form-label block">
                    {{ "Offer Price" | translate }}</label
                  >
                  <ng-select
                    class="w-full p-0"
                    placeholder="{{ 'Chose' | translate }}"
                    name="OfferSelectid"
                    formControlName="OfferSelectid"
                    (change)="offerpriceChange()"
                  >
                    <ng-option
                      *ngFor="let user of LoadofferPrice"
                      [value]="user.id"
                      >{{ user.name }}</ng-option
                    >
                  </ng-select>
                </div>
              </div>
            </div>
          </div>
          <div class="d-flex justify-end w-100">
            <button mat-button matStepperNext class="bg-base text-white">
              {{ "Next" | translate }}
            </button>
          </div>
          <!-- <p
          class="bg-red-100 p-1"
          style="width: max-content; margin: 15px auto"
        >
          {{
            "The second party: only clients who have projects appear"
              | translate
          }}
        </p> -->
        </form>
      </mat-step>
      <!-- 2 -->
      <mat-step [stepControl]="FormGroup02">
        <form [formGroup]="FormGroup02">
          <ng-template matStepLabel>{{
            "Financial details" | translate
          }}</ng-template>
          <div class="step-content">
            <div class="row mb-3">
              <div class="col-12 mb-0 mb-sm-3" *ngIf="ContractModalCustom.InvoiceNumDiv">
                <div class="form-group">
                  <label
                    for="InvoiceAmount"
                    class="text-right col-form-label block"
                  >
                    {{ "invoiceRegistered" | translate }} {{ContractModalCustom.InvoiceNumber}}
                  </label>
                  <input
                    class="form-control"
                    type="text"
                    id="InvoiceAmount"
                    name="InvoiceAmount"
                    formControlName="InvoiceAmount"
                    autocomplete="off"
                  />
                  <input
                  class="form-control"
                  type="text"
                  id="InvoiceAmountB"
                  name="InvoiceAmountB"
                  formControlName="InvoiceAmountB"
                  autocomplete="off"
                  style="display: none;"
                />
                </div>
              </div>

              <h3 class="flex items-center justify-start fw-bold">
                {{ "services" | translate }}
                <button
                  type="button "
                  class="add-btn mx-2"
                  (click)="addServiceContractNew()"
                  >
                  <i class="fa fa-plus"></i>
                </button>
              </h3>

              <div class="editable shadow mb-4">
                <table
                  class="table table-responsive table-striped table-bordered text-center"
                  style="vertical-align: middle; font-size: 14px"
                >
                  <thead
                    class="bg-base text-white"
                    style="line-height: 30px; font-size: 13px"
                  >
                  <tr>
                      <th>{{ "ServiceNo" | translate }}</th>
                      <th style="width: 30% !important;">{{ "ServiceName" | translate }}</th>
                      <th>{{ "Unit" | translate }}</th>
                      <th>{{ "Quantity" | translate }}</th>
                      <th>{{ "price" | translate }}</th>
                      <th>{{ "VATTax" | translate }}</th>
                      <th>{{ "netTax" | translate }}</th>
                      <th>{{ "action" | translate }}</th>
                        </tr>
                  </thead>
                  <tbody>
                    <tr
                    *ngFor="let item of ContractNewServices; let i = index"
                    style="line-height: 5px"
                  >
                    <td>{{ item.idRow }}</td>
                    <td (click)="open(servicesListModal_Contract, null, 'servicesList_Contract', item.idRow)">
                      <input
                        type="text"
                        name="os-name{{ item.idRow }}"
                        [(ngModel)]="item.accountJournaltxt"
                        [ngModelOptions]="{standalone: true}"
                        readonly
                      />
                    </td>
                    <td>
                      <input
                        type="text"
                        name="os-unit{{ item.idRow  }}"
                        [(ngModel)]="item.UnitConst"
                        [ngModelOptions]="{standalone: true}"
                        readonly
                      />
                    </td>

                    <td>
                      <input
                        type="text"
                        name="os-amount{{ item.idRow  }}"
                        [(ngModel)]="item.QtyConst"
                        [ngModelOptions]="{standalone: true}"
                        (keyup)="CalculateTotal_ContractNew()"
                      />
                    </td>

                    <td>
                      <div class="flex">
                        <input
                        type="number"
                        name="os-price{{ item.idRow  }}"
                        [(ngModel)]="item.Amounttxt"
                        [ngModelOptions]="{standalone: true}"
                        (keyup)="CalculateTotal_ContractNew()"
                      />
                      <span *ngIf="item.Amounttxt" style="align-self: center;">ر.س</span>
                      </div>
                    </td>

                    <td>
                      <div class="flex">
                        <input
                        type="number"
                        name="os-vatTax{{ item.idRow  }}"
                        [(ngModel)]="item.taxAmounttxt"
                        [ngModelOptions]="{standalone: true}"
                        readonly
                      />
                      <span *ngIf="item.taxAmounttxt" style="align-self: center;">ر.س</span>
                      </div>
                    </td>
                    <td>
                      <div class="flex">
                        <input
                        type="number"
                        name="os-taxes{{ item.idRow  }}"
                        [(ngModel)]="item.TotalAmounttxt"
                        [ngModelOptions]="{standalone: true}"
                        readonly
                      />
                      <span *ngIf="item.TotalAmounttxt" style="align-self: center;">ر.س</span>
                      </div>
                    </td>
                    <td class="flex">
                      <button
                        title=""
                        class="p-2 bg-orange-100 hover:bg-orange-500 rounded-lg duration-300 hover:text-white w-10"
                        style="margin-inline-end: 6px"
                        (click)="open(serviceDetailsModal, item, 'serviceDetails')"
                      >
                        <i class="fa-solid fa-info"></i>
                      </button>
                      <button
                        class="p-2 bg-red-100 hover:bg-red-500 rounded-lg duration-300 hover:text-white w-10"
                        (click)="RemoveServicesparent(item);deleteServiceContractNew(item.idRow)"
                      >
                        <i class="fa-solid fa-trash-can"></i>
                      </button>
                    </td>
                  </tr>
                  </tbody>
                </table>
              </div>

              <div class="boxContainer w-80 py-3 px-3">
                <div class="row">
                  <div class="col-md-2">
                    <label for="tax type" class=" " for="tax type">
                      {{ "tax type" | translate }}
                    </label>
                  </div>
                  <div class="col-md-10">
                    <ng-select
                      class="w-100"
                      placeholder="{{ 'Chose' | translate }}"
                      name="include_tax"
                      [(ngModel)]="modalDetailsContractNew.taxtype"
                      [ngModelOptions]="{standalone: true}"
                      (change)="CalculateTotal_ContractNew()"
                      [clearable]="false"
                    >
                      <ng-option [value]="2">{{
                        "Excluding tax" | translate
                      }}</ng-option>
                      <ng-option [value]="3">{{
                        "Taxes included" | translate
                      }}</ng-option>
                    </ng-select>
                  </div>
                </div>

                <div class="row">
                  <div class="col-md-12">
                    <div class="col-md-2">
                      <label
                        for="Total amount"
                        class="text-gren"
                        for="Total amount"
                      >
                        {{ "Total amount" | translate }}
                      </label>
                    </div>
                    <div class="col-md-10">
                      <input
                        id="Total amount"
                        class="form-control text-center"
                        type="number"
                        [(ngModel)]="modalDetailsContractNew.total_amount"
                        [ngModelOptions]="{standalone: true}"
                        readonly
                      />
                    </div>
                  </div>
                </div>

                <div class="row">
                  <div class="col-md-12">
                    <div class="col-md-2">
                      <label
                        for="total in writing"
                        class="text-orange"
                        for="total in writing"
                      >
                        {{ "total in writing" | translate }}
                      </label>
                    </div>
                    <div class="col-md-10">
                      <input
                        id="total in writing"
                        class="form-control text-center"
                        type="text"
                        [(ngModel)]="modalDetailsContractNew.total_amount_text"
                        [ngModelOptions]="{standalone: true}"
                        readonly
                      />
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="row mb-3">
              <h3 class="flex items-center justify-start fw-bold">
                {{ "Add a new item" | translate }}
                <button
                  type="button "
                  class="add-btn mx-2"
                  (click)="addBand()"
                >
                  <i class="fa fa-plus"></i>
                </button>
              </h3>

              <div
                class="table editable shadow d-block"
                style="overflow: auto"
              >
                <table
                  class="table table-responsive table-striped table-bordered text-center"
                  style="
                    vertical-align: middle;
                    font-size: 14px;
                    min-width: max-content;
                  "
                >
                  <thead
                    class="bg-base text-white"
                    style="line-height: 30px; font-size: 13px"
                  >
                    <tr>
                      <th>{{ "no" | translate }}</th>
                      <th>{{ "clause" | translate }}</th>
                      <th>{{ "action" | translate }}</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr
                      *ngFor="let item of bands; let i = index"
                      style="line-height: 5px"
                    >
                    <td>{{  item.idRow }}</td>
                      <td>
                        <input
                          type="text"
                          name="op-clause{{ item.idRow }}"
                          [(ngModel)]="item.clause"
                          [ngModelOptions]="{standalone: true}"
                          autocomplete="off"
                        />
                      </td>
                      <td>
                        <button
                          class="p-2 bg-red-100 hover:bg-red-500 rounded-lg duration-300 hover:text-white w-10"
                          (click)="deleteBand(item.idRow)"
                        >
                          <i class="fa-solid fa-trash-can"></i>
                        </button>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>

            <div
              *ngIf="ContractModalCustom?.ContractType == 2"
              class="row mb-3"
            >
              <h3 class="flex items-center justify-start fw-bold">
                {{ "Installments Details" | translate }}
                <button
                [disabled]="ContractNewServices.length==0"
                  type="button "
                  class="add-btn mx-2"
                  (click)="setWizardData();open(addInstallmentModal)"
                >
                  <i class="fa fa-plus"></i>
                </button>
              </h3>
              <!-- table -->
              <div class="overflow-auto mt-3">
                <table
                  class="min-w-max overflow-hidden rounded-t-lg table table-bordered table-striped"
                >
                  <thead>
                    <tr class="bg-base text-white">
                      <th class="uppercase text-center">
                        {{ "batch number" | translate }}
                      </th>
                      <th class="uppercase text-center">
                        {{ "Batch date" | translate }}
                      </th>
                      <th class="uppercase text-center">
                        {{ "Batch Date (Hijri)" | translate }}
                      </th>
                      <th class="uppercase text-center">
                        {{ "the amount" | translate }}
                      </th>
                      <th class="uppercase text-center">
                        {{ "Tax" | translate }}
                      </th>
                      <th class="uppercase text-center">
                        {{ "Payment total" | translate }}
                      </th>
                    </tr>
                  </thead>
                  <tbody id="tabledetails">
                    <tr
                      class="text-black text-center"
                      *ngFor="let installment of CustomerPaymentList"
                    >
                      <td>{{ installment.paymentNo }}</td>
                      <td>{{ installment.paymentDate }}</td>
                      <td>{{ installment.paymentDateHijri }}</td>
                      <td>{{ installment.amount }}</td>
                      <td>{{ installment.taxAmount }}</td>
                      <td>{{ installment.totalAmount }}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <div class="flex justify-between items-center flex-wrap">
            <button
              mat-button
              matStepperPrevious
              class="btn btn-outline-secondary"
            >
              {{ "Previous" | translate }}
            </button>
            <button
              mat-button
  
              class="btn bg-base text-white"
              [disabled]="disableButtonSave_Contract"
              (click)="open(SaveContractConfirmModal,null,'SaveContractConfirmModal',null, stepper)"

            >
              {{ "confirem" | translate }}
            </button>
          </div>
        </form>
      </mat-step>
      <!-- 3 -->
      <!-- <mat-step [stepControl]="FormGroup03">
        <ng-template matStepLabel>{{
          "operating expenses" | translate
        }}</ng-template>
        <div class="step-content"></div>
        <div class="row mb-3">
          <h3 class="flex items-center justify-start fw-bold">
            {{ "Add participant" | translate }}
            <button
              type="button "
              class="add-btn mx-2"
              (click)="addEmployee()"
            >
              <i class="fa fa-plus"></i>
            </button>
          </h3>

          <div class="table editable shadow">
            <table
              class="table table-responsive table-striped table-bordered text-center"
              style="vertical-align: middle; font-size: 14px"
            >
              <thead
                class="bg-base text-white"
                style="line-height: 30px; font-size: 13px"
              >
                <tr>
                  <th>{{ "EmployeeName" | translate }}</th>
                  <th>{{ "Duration" | translate }}</th>
                  <th>{{ "Employee percentage" | translate }}</th>
                  <th>{{ "employee salary" | translate }}</th>
                  <th>{{ "expected cost" | translate }}</th>
                  <th>{{ "operations" | translate }}</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let employee of employees">
                  <td>
                  <select class="form-select" aria-label="Default select example" [(ngModel)]="employee.name" (change)="emp_Change(employee)">
                    <option [ngValue]="0">{{"أختر"}}</option>
                    <option *ngFor="let c of load_Employee" [ngValue]="c.id">{{c.name}}</option>
                  </select>

                  </td>
                  <td>
                    <div class="flex">
                      <input type="number" class="form-control" [(ngModel)]="employee.duration" (keyup)="CalcDist(employee)"/>
                      <select class="form-select" aria-label="Default select example" [(ngModel)]="employee.durationType" (change)="CalcDist(employee)">
                        <option value="4">ساعه</option>
                        <option value="1">يوم</option>
                        <option value="2">اسبوع</option>
                        <option value="3">شهر</option>
                      </select>
                    </div>
                  </td>
                  <td>
                    <div class="flex">
                      <input type="number" class="form-control" [(ngModel)]="employee.ratio" (keyup)="CalcDist(employee)"/>
                      <div class="bg-neutral-200 p-2 rounded-lg aspect-square">%</div>
                    </div>
                  </td>
                  <td>
                    <input type="text" class="form-control" [(ngModel)]="employee.salary" readonly/>
                  </td>
                  <td>
                    <input type="text" class="form-control" [(ngModel)]="employee.cost" readonly/>
                  </td>
                  <td>
                    <button class="p-2 rounded-lg text-red-500 bg-red-50" (click)="deleteRow(employee.idRow);CalcDist(employee)">
                      <i class="fa-solid fa-trash"></i>
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="row mb-3">
          <h3 class="flex items-center justify-start fw-bold">
            {{
              "Through the data and preliminary reading of the project"
                | translate
            }}
          </h3>
          <div class="overflow-auto">
            <table class="custome-table">
              <thead>
                <tr>
                  <td style="display: none;"
                    [translate]="'name'"
                    [translateParams]="{
                      ar: 'مدة المشروع',
                      en: 'Project Time'
                    }"
                  ></td>
                  <td style="display: none;"
                    [translate]="'name'"
                    [translateParams]="{
                      ar: 'قيمة المشروع',
                      en: 'Project Price'
                    }"
                  ></td>
                  <td
                    [translate]="'name'"
                    [translateParams]="{
                      ar: 'مصاريف التشغيل		',
                      en: 'operating expenses'
                    }"
                  ></td>
                  <td
                    [translate]="'name'"
                    [translateParams]="{
                      ar: 'حالة المشروع	',
                      en: 'Project state'
                    }"
                  ></td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td style="display: none;">{{CalcData.FinalTable.projectTime}}</td>
                  <td style="display: none;">{{CalcData.FinalTable.projectValue}}</td>
                  <td>{{CalcData.FinalTable.projectCost}}</td>
                  <td [ngStyle]="{'background-color': (CalcData.FinalTable.projectStatusVal==0) ? '#ea9b9b' : '#73c7af'}"
                  >{{CalcData.FinalTable.projectStatusName}}</td>
                </tr>
              </tbody>
            </table>
          </div>

        </div>
        <div class="flex justify-between items-center flex-wrap">
          <button
            mat-button
            matStepperPrevious
            class="btn btn-outline-secondary"
          >
            {{ "Previous" | translate }}
          </button>
          <button
            mat-button

            class="btn bg-base text-white"
            [disabled]="disableButtonSave_Contract"
            (click)="saveContractbtn(stepper)"
          >
            {{ "confirem" | translate }}
          </button>
        </div>
      </mat-step> -->
      <!-- 4 -->
      <mat-step [stepControl]="FormGroup04">
        <ng-template matStepLabel>{{
          "Contract draft" | translate
        }}</ng-template>
        <div class="step-content">
          <div class="periority my-5">
            <mat-radio-group aria-label="Select an option" name="status">
              <div class="flex flex-wrap gap-8 items-center my-1">
                <mat-radio-button value="1" class="text-base">{{
                  "File Name" | translate
                }}</mat-radio-button>

                <div class="operations flex gap-2">
                  <button
                    class="p-2 bg-orange-100 hover:bg-orange-500 rounded-lg duration-300 hover:text-white w-10"
                  >
                    <i class="fa fa-download"></i>
                  </button>
                  <button
                    class="p-2 bg-red-100 hover:bg-red-500 rounded-lg duration-300 hover:text-white w-10"
                  >
                    <i class="fa-solid fa-trash-can"></i>
                  </button>
                </div>
              </div>
              <div class="flex flex-wrap gap-8 items-center my-1">
                <mat-radio-button value="2" class="text-base">{{
                  "File Name" | translate
                }}</mat-radio-button>

                <div class="operations flex gap-2">
                  <button
                    class="p-2 bg-orange-100 hover:bg-orange-500 rounded-lg duration-300 hover:text-white w-10"
                  >
                    <i class="fa fa-download"></i>
                  </button>
                  <button
                    class="p-2 bg-red-100 hover:bg-red-500 rounded-lg duration-300 hover:text-white w-10"
                  >
                    <i class="fa-solid fa-trash-can"></i>
                  </button>
                </div>
              </div>
            </mat-radio-group>
          </div>
        </div>
        <!-- <div class="flex justify-start mt-2">
          <button
            mat-button
            matStepperPrevious
            class="btn btn-outline-secondary"
          >
            {{ "Previous" | translate }}
          </button>
        </div> -->
      </mat-step>
    </mat-stepper>
  </div>
  </div>


<!-- serviceDetails -->
<ng-template #serviceDetailsModal let-modal>
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4 class="m-0">
      <span class="text-2xl">{{ "servicesList" | translate }}</span>
    </h4>
    <button
      type="button"
      class="text-2xl text-white m-0"
      (click)="modal.dismiss()"
    >
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>
  <div class="modal-body">
    <div
    cdkDropList
    [cdkDropListData]="serviceDetails"
    class="example-list"
    (cdkDropListDropped)="drop($event)">
      <div *ngFor="let item of serviceDetails ;" class="example-box" cdkDrag>
        <div class="col-md-11" style="font-size: 20px;">
        <i *ngIf="(item?.SureService??0)!=1 && OfferPopupAddorEdit==0"
        class="fa fa-xmark text-danger"></i>
        <i *ngIf="(item?.SureService??0)==1 && OfferPopupAddorEdit==0"
        class="fa fa-check text-success"></i>
        <i *ngIf="OfferPopupAddorEdit==1"
        class="fa fa-check text-success"></i>
        <span class="text-base mx-2">{{ item?.name }}</span>
      </div>
      <div class="serviceBtns"*ngIf="OfferPopupAddorEdit==0" >
        <button *ngIf="(item?.SureService??0)!=1"
        (click)="MarkServiceDetails(item)"
          type="button"
          class="btn btn-outline-success">
          {{ "Insert" | translate }}
        </button>
        <button *ngIf="(item?.SureService??0)==1"
        (click)="UnMarkServiceDetails(item)"
        type="button" class="btn btn-outline-danger">
          {{ "delete" | translate }}
        </button>
      </div>
    </div>
</div>
    <div
      class="flex gap-2 pt-3 border-t border-neutral-300 col-span-1 md:col-span-2 mt-2"
    >
      <button (click)="modal?.dismiss()" class="btn btn-secondary">
        {{ "Back" | translate }}
      </button>
    </div>
  </div>
</ng-template>

  <!-- servicesListModal_Contract -->
<ng-template #servicesListModal_Contract let-modal>
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4 class="m-0">
      <span class="text-2xl">{{ "servicesList" | translate }}</span>
    </h4>
    <button
      type="button"
      class="text-2xl text-white m-0"
      (click)="modal.dismiss()"
    >
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>
  <div class="modal-body" style="overflow-y: scroll;max-height: 600px;">
    <mat-form-field class="w-full">
      <mat-label>{{ "search" | translate }}</mat-label>
      <input matInput (keyup)="applyFilterServiceList_ContractNew($event)" #input />
    </mat-form-field>

    <div class="table">
      <table
        mat-table
        [dataSource]="serviceListDataSource_ContractNew"
        class="mat-elevation-z8 table table-responsive table-striped table-bordered text-center"
        style="vertical-align: middle; font-size: 14px;min-width: fit-content;"
      >
        <!-- Name Column -->
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef>
            {{ "ServiceName" | translate }}
          </th>
          <td mat-cell *matCellDef="let element">{{ element.servicesName }}</td>
        </ng-container>

        <!-- price Column -->
        <ng-container matColumnDef="price">
          <th mat-header-cell *matHeaderCellDef>{{ "price" | translate }}</th>
          <td mat-cell *matCellDef="let element">{{ element.amount }}</td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="servicesListdisplayedColumns"></tr>
        <tr
          mat-row
          *matRowDef="
            let row;
            let i = index;
            columns: servicesListdisplayedColumns
          "
          (dblclick)="setServiceRowValue_ContractNew(row); modal.dismiss()"
        ></tr>

        <!-- Row shown when there is no matching data. -->
        <tr class="mat-row" *matNoDataRow>
          <td class="mat-cell" colspan="4">
            {{ "noResult" | translate }} "{{ input.value }}"
          </td>
        </tr>
      </table>
    </div>

    <div class="text-end mt-2">
      <button (click)="modal?.dismiss()" class="btn btn-secondary">
        {{ "Back" | translate }}
      </button>
    </div>
  </div>
</ng-template>

  <!-- addInstallment -->
  <ng-template #addInstallmentModal let-modal>
    <div
      style="background-color: var(--base-color)"
      class="modal-header text-white flex justify-between items-center"
    >
      <h4 class="m-0">
        <span class="text-2xl">{{ "AddInstallments" | translate }}</span>
      </h4>
      <button
        type="button"
        class="text-2xl text-white m-0"
        (click)="modal.dismiss()"
      >
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>
    <div class="modal-body">
      <form #form="ngForm">
        <div class="row">
          <div class="col-md-6 col-lg-3 mb-3">
            <div class="form-group">
              <label
                for="ContractAmount"
                class="text-right col-form-label block"
              >
                {{ "Contract amount" | translate }}
              </label>
              <input
                class="form-control"
                type="number"
                id="ContractValueinfo"
                name="ContractValueinfo"
                [(ngModel)]="WizardData.ContractValueinfo"
                [ngModelOptions]="{standalone: true}"
                disabled
              />
            </div>
          </div>

          <div class="col-md-6 col-lg-3 mb-3">
            <div class="form-group">
              <label class="text-right col-form-label block">
                {{ "The beginning of the installments" | translate }}
              </label>
              <div class="form-group timeInput">
                <input
                  name="PaymentStartDate"
                  id="PaymentStartDate"
                  type="text"
                  class="form-control"
                  bsDatepicker
                  [(ngModel)]="WizardData.PaymentStartDate"
                  [ngModelOptions]="{standalone: true}"
                  autocomplete="off"
                  (ngModelChange)="ChangeDate($event)"
                />
              </div>
            </div>
          </div>
          <div class="col-md-6 col-lg-3 mb-3">
            <div class="form-group">
              <label class="text-right col-form-label block">
                {{ "Start of installments (Hijri)" | translate }}
              </label>
              <div class="form-group timeInput">
                <input
                  name="PaymentStartHijriDate"
                  id="PaymentStartHijriDate"
                  type="text"
                  class="form-control"

                  [(ngModel)]="WizardData.PaymentStartHijriDate"
                  [ngModelOptions]="{standalone: true}"
                  autocomplete="off"
                  disabled
                />
              </div>
            </div>
          </div>
          <!-- <div class="col-md-6 col-lg-3 mb-3">
            <div class="form-group">
              <label class="text-right col-form-label block">
                {{ "Start of installments (Hijri)" | translate }}
              </label>
              <div class="form-group">
                <hijri-gregorian-datepicker
                  [(selectedDate)]="selectedDate"
                  [hijriLabel]="'Hijri'"
                  [selectedDateType]="selectedDateType"

                  [dir]="'dir' | translate"
                >
                </hijri-gregorian-datepicker>
              </div>
            </div>
          </div> -->

          <div class="col-md-6 col-lg-3 mb-3">
            <div class="form-group">
              <label for="payment" class="text-right col-form-label block">
                {{ "Down payment value" | translate }}
              </label>
              <input
                class="form-control"
                type="number"
                id="AdvancePayValue"
                name="AdvancePayValue"
                [(ngModel)]="WizardData.AdvancePayValue"
                [ngModelOptions]="{standalone: true}"
                autocomplete="off"
                (keyup)="AdvancePayValueChange()"
              />
            </div>
          </div>

          <div class="periority mt-4 mb-2">
            <label for="payment" class="text-right col-form-label block">
              {{ "Basis for payment" | translate }}
            </label>

            <mat-radio-group
              class="flex gap-4"
              aria-label="Select an option"
              name="georgianOrhigri"
              [(ngModel)]="WizardData.georgianOrhigri"
              [ngModelOptions]="{standalone: true}"
            >
              <mat-radio-button value="1" class="text-warning">{{
                "Georgie" | translate
              }}</mat-radio-button>
              <mat-radio-button value="2" class="text-success">{{
                "Hijri" | translate
              }}</mat-radio-button>
            </mat-radio-group>
          </div>

          <div class="periority mt-4 mb-2">
            <label for="payment" class="text-right col-form-label block">
              {{ "Method of Payment" | translate }}
            </label>

            <mat-radio-group
              class="flex gap-4"
              aria-label="Select an option"
              name="PeriodPay"
              [(ngModel)]="WizardData.PeriodPay"
              [ngModelOptions]="{standalone: true}"
            >
              <mat-radio-button value="1" class="text-warning">{{
                "Monthly" | translate
              }}</mat-radio-button>
              <mat-radio-button value="2" class="text-success">{{
                "by duration" | translate
              }}</mat-radio-button>
              <mat-radio-button value="3" class="text-danger">{{
                "period with the month" | translate
              }}</mat-radio-button>
            </mat-radio-group>
          </div>

          <div class="periority mt-4 mb-2">
            <label for="payment" class="text-right col-form-label block">
              {{ "Installment calculation method" | translate }}
            </label>

            <mat-radio-group
              class="flex gap-4"
              aria-label="Select an option"
              name="countwithPayment"
              [(ngModel)]="WizardData.countwithPayment"
              [ngModelOptions]="{standalone: true}"
            >
              <mat-radio-button value="1" class="text-warning">{{
                "Depending on the number of installments" | translate
              }}</mat-radio-button>
              <mat-radio-button value="2" class="text-success">{{
                "Depending on the premium value" | translate
              }}</mat-radio-button>
            </mat-radio-group>
          </div>

          <div class="col-md-6 col-lg-4 mb-3">
            <div class="form-group">
              <label
                for="monthlyInstallment"
                class="text-right col-form-label block"
              >
                {{ "monthly installment" | translate }}
              </label>
              <input
                class="form-control"
                type="number"
                id="MonthlyPayVal"
                name="MonthlyPayVal"
                [(ngModel)]="WizardData.MonthlyPayVal"
                [ngModelOptions]="{standalone: true}"
                autocomplete="off"
                (keyup)="MonthlyPayValChange()"
                [disabled]="WizardData.countwithPayment!='2'"
              />
            </div>
          </div>

          <div class="col-md-6 col-lg-4 mb-3">
            <div class="form-group">
              <label
                for="numberOfInstallments"
                class="text-right col-form-label block"
              >
                {{ "number of installments" | translate }}
              </label>
              <input
                class="form-control"
                type="number"
                id="PaymentCount"
                name="PaymentCount"
                [(ngModel)]="WizardData.PaymentCount"
                [ngModelOptions]="{standalone: true}"
                autocomplete="off"
                (keyup)="PaymentCountChange()"
                [disabled]="WizardData.countwithPayment!='1'"
              />
            </div>
          </div>

          <div class="col-md-6 col-lg-4 mb-3">
            <div class="form-group">
              <label
                for="latestInstallment"
                class="text-right col-form-label block"
              >
                {{ "latest installment" | translate }}
              </label>
              <input
                class="form-control"
                type="number"
                id="LastpayVal"
                name="LastpayVal"
                [(ngModel)]="WizardData.LastpayVal"
                [ngModelOptions]="{standalone: true}"
                autocomplete="off"
                disabled
              />
            </div>
          </div>
        </div>
      </form>
      <div class="flex gap-2 pt-3 border-t border-neutral-300 justify-end">
        <button
          (click)="GenerateCustomerPayments(modal); "
          class="btn bg-base text-white"
        >
          {{ "confirem" | translate }}
        </button>

        <button (click)="modal?.dismiss()" class="btn btn-secondary">
          {{ "Back" | translate }}
        </button>
      </div>
    </div>
  </ng-template>

  <!-- confirm MergeInvoiceDataModal Modal -->
<ng-template #MergeInvoiceDataModal let-modal>
  <div class="modal-body text-center">
    <p [translate]="'name'" [translateParams]="{
        ar: 'سيتم دمج الفاتورة الصادرة مسبقا علي المشروع من ضمن العقد و ترحيلها مباشرة',
        en: 'The invoice previously issued for the project will be merged into the contract and posted directly'
      }"></p>
    <div class="flex gap-2 justify-center">
      <button type="button" mat-raised-button color="warn" (click)="ConfirmMergeInvoice(2,stepper); modal.dismiss()">
        {{ "Yes" | translate }}
      </button>
      <button type="button" (click)="modal.dismiss()" mat-raised-button color="basic">
        {{ "No" | translate }}
      </button>
    </div>
  </div>
</ng-template>


<ng-template #SaveContractConfirmModal let-modal>
  <div
    class="modal-body text-center"
    style="background-color: #cdcdcd !important"
  >
    <p
      [translate]="'name'"
      [translateParams]="{
        ar: 'هل تريد الحفظ ',
        en: 'Are you sure to save ?'
      }"
    ></p>
    <div class="flex gap-2 justify-center mt-3">
      <button
        type="button"
        mat-raised-button
        color="warn"
        (click)="saveContractbtn(); modal.dismiss()"
      >
        {{ "Yes" | translate }}
      </button>
      <button
        type="button"
        (click)="modal.dismiss()"
        mat-raised-button
        color="basic"
      >
        {{ "No" | translate }}
      </button>
    </div>
  </div>
</ng-template>
