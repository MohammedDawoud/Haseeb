<div class="sales-bill">
  <app-navigator [title]="title"></app-navigator>
  <div *ngIf="ZatcaFatoraCheck">
    <img
      src="/assets/images/fatora1.png" alt="logo"
      style="height: 70px !important; width: 15% !important"/>
    <span style="font-weight: bold;font-size: 23px;">
      الفواتير الضريبية مرتبطة بيهئة الزكاة و الضريبة و الجمارك في المرحلة الثانية
    </span>
  </div>

  <div class="head flex gap-2 flex-wrap items-end justify-between">
    <!-- all buttons  -->

    <!-- <div class="one" id="test" [innerHtml]="htmlToAdd"></div> -->

    <div class="btns mb-3 w-100">
      <div class="row flex flex-wrap w-100">
        <button
        *ngIf="userG?.userPrivileges.includes(13100105)"
          type="button"
          class="flex gap-1 btn btn-danger mb-3 col-md-2"
          (click)="open(postModal, null, 'postModalCheckbox')"
          [disabled]="selection.selected.length == 0"
        >
          {{ "Invoice posting" | translate }}
        </button>

        <button
          type="button"
          class="btn bg-base text-white mb-3 col-md-2"
          (click)="open(paymentReminderModal, null, 'AlarmVoucher')"
        >
          {{ "Reminder of outstanding bills" | translate }}
        </button>

        <button
          type="button"
          class="btn btn-outline-secondary mb-3 col-md-2"
          [routerLink]="'/customers/search'"
        >
          {{ "New_customer" | translate }}
        </button>

        <button
          (click)="open(addSerivceModal, null, 'addSerivceModal')"
          type="button"
          class="btn btn-outline-secondary mb-3 col-md-2"
        >
          {{ "Service prices" | translate }}
        </button>

        <button
        [disabled]="!TaxCodeCheck"
          type="button"
          class="btn bg-base text-white mb-3 col-md-2"
          (click)="open(NoticeCreditorModal, null, 'NoticeCreditorModal')"
        >
          {{ "Notice creditor" | translate }}
        </button>
        <button
        [disabled]="!TaxCodeCheck"
          style="background-color: #378d8f !important"
          type="button"
          class="btn bg-base text-white mb-3 col-md-2"
          (click)="open(NewInvoiceModal, null, 'addInvoicewithoutProject')"
        >
          {{ "New Invoice" | translate }}
        </button>
        <!-- <button
          [disabled]="!TaxCodeCheck"
          type="button"
          class="btn bg-base text-white mb-3 col-md-2"
          (click)="open(NewInvoiceModal, null, 'addInvoice')"
        >
          {{ "Add an invoiceProject" | translate }}
        </button> -->
        <button
          type="button"
          class="flex gap-1 btn btn-success mb-3 col-md-2"
          (click)="showFilters = !showFilters"
        >
          {{ "research" | translate }}
          <i class="fa-solid fa-search"></i>
        </button>

        <button type="button" class="flex gap-1 btn btn-outline-secondary"(click)="exportData()">
          {{ "exportExcel" | translate }}
        </button>
      </div>

      <div class="row flex-wrap">
        <div class="mt-2 d-flex flex-wrap w-max gap-4">
          <div class="form-check form-switch me-3">
            <label
              class="form-check-label"
              for="flexSwitchCheckDefault"
              style="width: max-content"
            >
              {{ "Show all invoices" | translate }}
            </label>
            <input
              class="form-check-input"
              type="checkbox"
              role="switch"
              id="flexSwitchCheckDefault"
              [(ngModel)]="dataInvoice.filter.AllInvoice"
              (change)="ShowAllVoucher()"
            />
          </div>

          <div class="form-check form-switch me-3">
            <label
              class="form-check-label"
              for="flexSwitchCheckDefault"
              style="width: max-content"
            >
              {{ "canceled invoices" | translate }}
            </label>
            <input
              class="form-check-input"
              type="checkbox"
              role="switch"
              id="flexSwitchCheckDefault"
              [(ngModel)]="dataInvoice.filter.InvoiceRet"
              (change)="ShowVoucherRet()"
            />
          </div>

          <div class="form-check form-switch me-3">
            <label
              class="form-check-label"
              for="flexSwitchCheckDefault"
              style="width: max-content"
            >
              {{ "Contract invoices" | translate }}
            </label>
            <input
              class="form-check-input"
              type="checkbox"
              role="switch"
              id="flexSwitchCheckDefault"
              [(ngModel)]="dataInvoice.filter.ContractInvoice"
              (change)="ShowVouchercontract()"
            />
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- search  after Edit -->
  <div *ngIf="showFilters" class="filters">
    <div class="container-fluid">
      <!-- ---- -->
      <div class="flex flex-wrap gap-4 align-items-end">
        <div class="form-group">
          <label class="col-form-label">
            {{ "invoice number" | translate }}</label
          >

          <input
            type="text "
            class="w-full p-2 inputType"
            name="user"
            placeholder="{{ 'invoice number' | translate }}"
            [(ngModel)]="dataInvoice.filter.search_InvoiceNumber"
            (keyup)="applyFilter($event)"
          />
        </div>

        <div class="flex justify-content-center gap-3">
          <button
            class="btn btn-primary"
            (click)="dataInvoice.filter.enable = !dataInvoice.filter.enable"
            [translate]="'name'"
            [translateParams]="{
              ar: 'فلترة بالوقت',
              en: 'Time Filter'
            }"
          ></button>
          <div
            class="form-group col-md-2 timeInput"
            *ngIf="dataInvoice.filter.enable"
          >
            <input
              placeholder="{{ 'Chose Date' | translate }}"
              [(ngModel)]="dataInvoice.filter.date"
              type="text"
              (ngModelChange)="CheckDate($event)"
              class="form-control"
              [bsConfig]="{ rangeInputFormat: 'DD/MM/YYYY' }"
              bsDaterangepicker
              #dpr="bsDaterangepicker"
            />
          </div>
        </div>

        <div class="form-group">
          <label class="col-form-label">
            {{ "Invoice type" | translate }}</label
          >
          <ng-select
            class="w-full p-0"
            placeholder="{{ 'Chose' | translate }}"
            [(ngModel)]="dataInvoice.filter.search_invoicetype"
            (change)="RefreshData()"
          >
            <ng-option
              *ngFor="let ex of invoicetype"
              [value]="ex.id"
              [translate]="'name'"
              [translateParams]="{ ar: ex.name?.ar, en: ex.name?.en }"
            >
            </ng-option>
          </ng-select>
        </div>
        <!-- <div class="form-group">
          <label class="col-form-label">
            {{ "Project Number" | translate }}</label
          >
          <ng-select
            class="w-full p-0"
            placeholder="{{ 'Chose' | translate }}"
            [(ngModel)]="dataInvoice.filter.search_projectId"
            name="Project Number"
            (change)="RefreshData()"
          >
            <ng-option
              *ngFor="let user of load_projectsSearch"
              [value]="user.id"
              >{{ user.name }}</ng-option
            >
          </ng-select>
        </div> -->
        <div class="form-group">
          <label class="col-form-label"> {{ "Client" | translate }}</label>
          <ng-select
            class="w-full p-0"
            placeholder="{{ 'Chose' | translate }}"
            [(ngModel)]="dataInvoice.filter.search_CustomerName"
            name="Client"
            (change)="RefreshData()"
          >
            <ng-option *ngFor="let user of load_customers" [value]="user.id">{{
              user.name
            }}</ng-option>
          </ng-select>
        </div>

        <!-- <button
          type="button"
          class="flex gap-1 btn btn-primary"
          (click)="showStats = !showStats"
        >
          {{ "search" | translate }}
        </button> -->
      </div>
    </div>
  </div>

  <!-- table -->
  <div class="overflow-auto mt-4">
    <table
      mat-table
      [dataSource]="InvoicessDataSource"
      matSort
      class="mat-elevation-z8 rounded-t-lg overflow-hidden w-max"
    >
      <ng-container matColumnDef="select">
        <th mat-header-cell *matHeaderCellDef>
          <mat-checkbox
            color="warn"
            (change)="$event ? toggleAllRows() : null"
            [checked]="selection.hasValue() && isAllSelected()"
            [indeterminate]="selection.hasValue() && !isAllSelected()"
            [aria-label]="checkboxLabel()"
          >
          </mat-checkbox>
        </th>
        <td mat-cell *matCellDef="let row">
          <mat-checkbox
            color="warn"
            (click)="$event.stopPropagation()"
            (change)="$event ? selection.toggle(row) : null"
            [checked]="selection.isSelected(row) && row.isPost == false"
            [aria-label]="checkboxLabel(row)"
            [disabled]="row.isPost == true"
          >
          </mat-checkbox>
        </td>
      </ng-container>

      <ng-container matColumnDef="invoiceNumber">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          <span>{{ "invoice number" | translate }}</span>
        </th>
        <td mat-cell *matCellDef="let element">
          {{ element.invoiceNumber }}
        </td>
      </ng-container>
      <ng-container matColumnDef="date">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          <span>{{ "Invoice date" | translate }}</span>
        </th>
        <td mat-cell *matCellDef="let element">
          {{ element.date }}
        </td>
      </ng-container>
      <ng-container matColumnDef="totalValue">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          <span>{{ "total invoice" | translate }}</span>
        </th>
        <td mat-cell *matCellDef="let element">
          {{ element.totalValue }}
        </td>
      </ng-container>
      <ng-container matColumnDef="payTypeName">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          <span>{{ "Payment type" | translate }}</span>
        </th>
        <td mat-cell *matCellDef="let element">
          {{ element.payTypeName }}
        </td>
      </ng-container>
      <!-- <ng-container matColumnDef="projectNumber">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          <span>{{ "project number" | translate }}</span>
        </th>
        <td mat-cell *matCellDef="let element">
          {{ element.projectNo }}
        </td>
      </ng-container> -->
      <ng-container matColumnDef="customerName">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          <span>{{ "Client Name" | translate }}</span>
        </th>
        <td mat-cell *matCellDef="let element">
          {{ element.customerName }}
        </td>
      </ng-container>
      <ng-container matColumnDef="InvoiceStatus">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          <span>{{ "Invoice status" | translate }}</span>
        </th>
        <td
          mat-cell
          *matCellDef="let element"
          style="font-weight: bold"
          [style.color]="getColorStatus(element)"
        >
          {{ element.statusNameNew }}
        </td>
      </ng-container>
      <ng-container matColumnDef="postDate">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          <span>{{ "Posting date" | translate }}</span>
        </th>
        <td mat-cell *matCellDef="let element">
          {{ element.postDate }}
        </td>
      </ng-container>
      <ng-container matColumnDef="Zatcanotes">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          <span>{{ "ملاحظات" | translate }}</span>
        </th>
        <td mat-cell *matCellDef="let element">
             <button
             *ngIf="element.invoicesRequests && element.invoicesRequests != 'undefined' && element.invoicesRequests.length > 0"
              type="button "
              id="button-basic"
              class="flex btn btn-danger"
              (click)="open(zatcaListModal, element, 'zatcaListModal')"
              > ملاحظات زاتكا             
            </button>
        </td>
      </ng-container>

      <ng-container matColumnDef="operations">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          <span>{{ "operations" | translate }}</span>
        </th>
        <td mat-cell *matCellDef="let element">
          <div dropdown>
            <button
              type="button "
              id="button-basic"
              dropdownToggle
              style="display: block; width: 100%"
            >
              <i class="fa-solid fa-ellipsis-vertical"></i>
            </button>

            <div
              id="dropdown-basic"
              *dropdownMenu
              aria-labelledby="dropdownBasic1"
              class="child flex align-items-center justify-center"
            >
              <div class="child-btns">
                <span class="dtr-data">
                  <!--طباعة  -->
                  <button
                    (click)="GetInvoicePrint(element, 1); open(printDivModal)"
                    type="button"
                    class="btn btn-outline-success btn-sm waves-effect"
                    data-toggle="tooltip"
                    data-placement="top"
                    title=" طباعة "
                    data-original-title="طباعة "
                  >
                    <i class="fa-solid fa-print"></i>
                  </button>
                  <!--طباعة مبسطة -->
                  <button
                    (click)="PrintVoucher(element)"
                    type="button"
                    class="btn btn-outline-success btn-sm waves-effect"
                    data-toggle="tooltip"
                    data-placement="top"
                    title=" طباعة مبسطة"
                    data-original-title="طباعة مبسطة"
                  >
                    <i class="fa-solid fa-print"></i>
                  </button>

                  <!--طباعة إشعار دائن  -->
                  <button
                    *ngIf="element.creditNotiId == -1"
                    (click)="GetInvoicePrint(element, 29); open(printDivModal)"
                    type="button"
                    class="btn btn-outline-success btn-sm waves-effect"
                    data-toggle="tooltip"
                    data-placement="top"
                    title=" طباعة إشعار دائن "
                    data-original-title="طباعة إشعار دائن "
                  >
                    <i class="fa-solid fa-print"></i>
                  </button>
                  <!--طباعة إشعار مدين  -->
                  <button
                    *ngIf="element.DepitNotiId == -1"
                    (click)="GetInvoicePrint(element, 30); open(printDivModal)"
                    type="button"
                    class="btn btn-outline-success btn-sm waves-effect"
                    data-toggle="tooltip"
                    data-placement="top"
                    title=" طباعة إشعار مدين "
                    data-original-title="طباعة إشعار مدين "
                  >
                    <i class="fa-solid fa-print"></i>
                  </button>

                  <!-- عرض القيد المحاسبي  -->
                  <button
                    *ngIf="element.isPost == true"
                    type="button"
                    class="btn btn-outline-warning btn-sm waves-effect"
                    data-toggle="tooltip"
                    data-placement="top"
                    title=" عرض القيد المحاسبي"
                    data-original-title=" عرض القيد المحاسبي"
                    (click)="open(accountingentry, element, 'accountingentry')"
                  >
                    <i class="fa-brands fa-stripe-s"></i>
                  </button>
                  <!-- "   فك الترحيل" -->
                  <button
                    *ngIf="element.isPost == true && element.rad != 1"
                    type="button"
                    class="btn btn-outline-warning btn-sm waves-effect"
                    data-toggle="tooltip"
                    data-placement="top"
                    title="   فك الترحيل"
                    data-original-title=" فك الترحيل"
                    (click)="open(decodingPagingModal, element)"
                  >
                    <i class="fa-solid fa-share fa-flip-horizontal"></i>
                  </button>

                  <a
                    *ngIf="element.fileUrl"
                    class="svg-icon svg-icon-3 text-dark svg-icon-dark"
                    [href]="pathurl + element.fileUrl"
                    target="_blank"
                  >
                    <i class="fa-solid fa-eye"></i>
                  </a>

                  <!-- =" سند قبض للفاتورة" -->
                  <button
                  [disabled]="!TaxCodeCheck"
                    *ngIf="
                      element.isPost == true &&
                      element.payType == 8 &&
                      element.storeId != 1 &&
                      element.rad != true
                    "
                    type="button"
                    class="btn btn-outline-warning btn-sm waves-effect"
                    data-toggle="tooltip"
                    data-placement="top"
                    title=" سند قبض للفاتورة"
                    data-original-title=" سند قبض للفاتورة"
                    (click)="
                      open(
                        ReceiptVoucherwithoutCustomerModal,
                        element,
                        'editReceiptModal'
                      )
                    "
                  >
                    <i class="fa-solid fa-receipt"></i>
                  </button>
                  <!-- =" اشعار فاتورة" -->
                  <button
                    type="button"
                    class="current-tasks btn btn-outline-info btn-sm waves-effect"
                    data-toggle="tooltip"
                    data-placement="top"
                    (click)="open(sendEmail, element)"
                    [disabled]="OrganizationData?.sendCustomerMail == false"
                  >
                    <i
                      class="fa-solid fa-at"
                      [title]="
                        OrganizationData?.sendCustomerMail == false
                          ? 'ايميل المنشأة غير مفعل'
                          : 'اشعار فاتورة'
                      "
                    ></i>
                  </button>
                  <!--   (click)="open(invoiceNoticeModal)" -->
                  <!-- e="  رسالة نصية جديدة" -->
                  <button
                    type="button"
                    class="project-workers btn btn-outline-success btn-sm waves-effect"
                    data-toggle="tooltip"
                    data-placement="top"
                    title="  رسالة نصية جديدة"
                    data-original-title="  رسالة نصية جديدة"
                    (click)="open(sendMessageModal, element)"
                    [disabled]="OrganizationData?.sendCustomerSMS == false"
                  >
                    <i class="fa-solid fa-comment-sms" [title]="
                        OrganizationData?.sendCustomerSMS == false ? 'خدمة لرسال غير مفعل': 'ارسال رساله'"
                    ></i>
                  </button>
                  <!-- -->
                  <button
                    *ngIf="
                      element.voucherAlarmCheck == 1 && element.isSendAlarm != 1
                    "
                    type="button"
                    class="btn btn-outline-warning btn-sm waves-effect"
                    data-toggle="tooltip"
                    data-placement="top"
                    title="{{ getAlaramNote(element) }}"
                    data-original-title="تذكير"
                  >
                    <i class="fa-solid fa-bell"></i>
                  </button>


                  <button
                    type="button"
                    class="current-tasks btn btn-outline-success    btn-sm waves-effect"
                    data-toggle="tooltip"
                    data-placement="top"
                    (click)="uploadedFiles = [];open(sendWhatsApp, element)"
                    [disabled]="WhatsAppData?.sendactivation == false"
                    >
                    <i
                      class="fa-brands fa-whatsapp"
                      [title]="
                        WhatsAppData?.sendactivation == false ? 'خدمة ارسال واتس اب غير مفعل': 'ارسال واتس اب'"
                         ></i>
                  </button>

                </span>
              </div>
            </div>
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="invoiceDisplayedColumns"></tr>

      <tr
        mat-row
        *matRowDef="let row; columns: invoiceDisplayedColumns"
        [ngClass]="{ highlight: selectedRowIndex == row.invoiceId }"
        (click)="highlight(row)"
        (dblclick)="open(NewInvoiceModal, row, 'InvoiceView')"
      ></tr>
    </table>
  </div>
  <mat-paginator
    [pageSizeOptions]="[10, 25, 100, InvoicessDataSource.data.length]"
  >
  </mat-paginator>

  <div
    class="max-h-100 overflow-x-scroll overflow-y-scroll p-4"
    id="reportaccountingentryModal"
    [ngStyle]="{ direction: lang == 'ar' ? 'rtl' : 'ltr' }"
    style="position: absolute"
  >
    <!--Header-->
    <div
      class="report-header"
      style="
        display: flex;
        align-items: center;
        gap: 100px;
        padding: 3px 0px;
        margin-bottom: 20px;
      "
    >
      <div class="headerNe-right-side">
        <img
          src="{{ environmentPho }}"
          alt="logo"
          style="
            height: 200px;
            width: 200px;
            max-width: 200px;
            object-fit: fill;
          "
        />
      </div>

      <div class="headerNe-lefy-side" style="width: 100%">
        <h1
          style="
            letter-spacing: 0.25px;
            font-size: 23px;
            margin: 0;
            margin-bottom: 5px;
          "
        >
          {{ OrganizationData?.nameAr }}
        </h1>
        <h1
          style="
            letter-spacing: 0.25px;
            font-size: 23px;
            margin: 0;
            margin-bottom: 5px;
          "
        >
          {{ OrganizationData?.nameEn }}
        </h1>
        <h1
          style="
            margin-bottom: 0;
            font-size: 34px;
            color: #0c8191;
            margin-bottom: 0;
            margin-top: 30px;
            font-weight: 500;
            display: flex;
            justify-content: center;
          "
        >
          {{ "View_accounting_entry" | translate }}
        </h1>
      </div>
    </div>
    <!--/Header-->

    <div style="margin-bottom: 10px">
      <p>
        <span
          [translate]="'name'"
          [translateParams]="{
            ar: 'التاريخ: ',
            en: 'Date: '
          }"
        ></span>
        <span> {{ datePrintJournals | date }} </span>
      </p>
    </div>

    <table
      class="border border-gray-500"
      style="width: 100%; text-align: center"
    >
      <thead>
        <tr>
          <th class="w-1/9 px-1 border py-2">{{ "date" | translate }}</th>
          <th class="w-1/9 px-1 border py-2">
            {{ "Bond number" | translate }}
          </th>
          <th class="w-1/9 px-1 border py-2">{{ "Bond type" | translate }}</th>
          <th class="w-1/9 px-1 border py-2">
            {{ "Registration number" | translate }}
          </th>
          <th class="w-1/9 px-1 border py-2">
            {{ "account code" | translate }}
          </th>
          <th class="w-1/9 px-1 border py-2">
            {{ "account name" | translate }}
          </th>
          <th class="w-1/9 px-1 border py-2">{{ "Statement" | translate }}</th>
          <th class="w-1/9 px-1 border py-2">{{ "debtor" | translate }}</th>
          <th class="w-1/9 px-1 border py-2">{{ "Creditor" | translate }}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let entry of AllJournalEntries">
          <td class="w-1/9 border px-1 py-2">{{ entry.transactionDate }}</td>
          <td class="w-1/9 border px-1 py-2">{{ entry.invoiceNumber }}</td>
          <td class="w-1/9 border px-1 py-2">{{ entry.typeName }}</td>
          <td class="w-1/9 border px-1 py-2">{{ entry.journalNo }}</td>
          <td class="w-1/9 border px-1 py-2">{{ entry.accountCode }}</td>
          <td class="w-1/9 border px-1 py-2">{{ entry.accountName }}</td>
          <td class="w-1/9 border px-1 py-2">{{ entry.notes }}</td>
          <td class="w-1/9 border px-1 py-2">{{ entry.depit }}</td>
          <td class="w-1/9 border px-1 py-2">{{ entry.credit }}</td>
        </tr>
        <tr>
          <td class="w-1/9 border px-1 py-2">{{ "total" | translate }}</td>
          <td class="w-1/9 border px-1 py-2"></td>
          <td class="w-1/9 border px-1 py-2"></td>
          <td class="w-1/9 border px-1 py-2"></td>
          <td class="w-1/9 border px-1 py-2"></td>
          <td class="w-1/9 border px-1 py-2"></td>
          <td class="w-1/9 border px-1 py-2"></td>
          <td class="w-1/9 border px-1 py-2 bg-green-500">{{ totaldepit }}</td>
          <td class="w-1/9 border px-1 py-2 bg-red-500">{{ totalcredit }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- paymentReminderModal  -->
<ng-template #paymentReminderModal let-modal>
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4 class="m-0">
      <span class="text-2xl">{{ "Bill payment reminder" | translate }}</span>
    </h4>
    <button
      type="button"
      class="text-2xl text-white m-0"
      (click)="modal?.dismiss()"
    >
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>

  <div class="modal-body">
    <div class="row align-items-center">
      <div class="col-xxl-5 col-md-3 col-lg-3 mb-0 mb-md-3 me-3">
        <div class="form-group">
          <label class="col-form-label">
            {{ "invoice number" | translate }}</label
          >
          <ng-select
            class="w-full p-0"
            placeholder="{{ 'Chose' | translate }}"
            ngModel
            name="user"
            [(ngModel)]="AlarmData.invoiceid"
            [ngModelOptions]="{ standalone: true }"
          >
            <ng-option
              *ngFor="let user of load_AllAlarmVoucher"
              [value]="user.id"
              >{{ user.name }}</ng-option
            >
          </ng-select>
        </div>
      </div>

      <div class="col-xxl-5 col-md-3 col-lg-3 mb-0 mb-md-3">
        <div class="form-group timeInput">
          <label class="col-form-label">{{
            "date reminder" | translate
          }}</label>
          <input
            placeholder="{{ 'date reminder' | translate }}"
            name="date"
            [(ngModel)]="AlarmData.date"
            [ngModelOptions]="{ standalone: true }"
            type="text"
            class="form-control"
            bsDatepicker
            #dpr="bsDatepicker"
            autocomplete="off"
          />
        </div>
      </div>
    </div>
  </div>

  <div class="flex justify-end p-3">
    <button (click)="modal?.dismiss()" class="btn btn-secondary">
      {{ "close" | translate }}
    </button>

    <button
      (click)="ConfirmAlarm(modal)"
      class="btn text-white me-2"
      style="background-color: var(--base-color)"
    >
      {{ "confirem" | translate }}
    </button>
  </div>
</ng-template>

<!-- NoticeCreditorModal  -->
<ng-template #NoticeCreditorModal let-modal>
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4 class="m-0">
      <span class="text-2xl">{{ "credit/debit note" | translate }}</span>
    </h4>
    <button
      type="button"
      class="text-2xl text-white m-0"
      (click)="modal?.dismiss()"
    >
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>

  <div class="modal-body">
    <div class="flex align-items-center gap-4 flex-wrap">
      <div class="form-group col-md-5">
        <label class="col-form-label">
          {{ "invoice number" | translate }}</label
        >
        <ng-select
          class="w-full p-0"
          placeholder="{{ 'Chose' | translate }}"
          name="user"
          [(ngModel)]="NotiData.invoiceid"
          [ngModelOptions]="{ standalone: true }"
        >
          <ng-option
            *ngFor="let user of LoadInvoiceNumbers"
            [value]="user.id"
            >{{ user.name }}</ng-option
          >
        </ng-select>
      </div>

      <div class="form-check form-switch me-3" style="margin-top: 4%;">
        <label
          class="form-check-label"
          for="flexSwitchCheckDefault"
          style="width: max-content"
        >
          {{ "فواتير السنة السابقة" | translate }} 
        </label>
        <input
          class="form-check-input"
          type="checkbox"
          role="switch"
          id="flexSwitchCheckDefault"
          [(ngModel)]="NotiData.PrevInvoices"
          (change)="FillAllNotiVoucher()"
        />
      </div>

      <!-- <button
        (click)="ReturnNotiCreditBack(modal)"
        class="btn btn-success btnSuccess me-5"
      >
        {{ "Release a credit note" | translate }}
      </button> -->

      <button
        (click)="modal?.dismiss(); open(NewInvoiceModal, null, 'InvCredit')"
        class="btn btn-danger btnSuccess"
      >
        {{ "Notice creditor" | translate }}
      </button>
    </div>
  </div>
  <div class="flex justify-end p-3">
    <button (click)="modal?.dismiss()" class="btn btn-secondary">
      {{ "close" | translate }}
    </button>
  </div>
</ng-template>

<!-- عرض القيد المحاسبي  -->
<!-- accountingentry -->
<ng-template #accountingentry let-modal>
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4 class="m-0">
      <span class="text-2xl">{{ "View_accounting_entry" | translate }}</span>
    </h4>
    <button
      type="button"
      class="text-2xl text-white m-0"
      (click)="modal.dismiss()"
    >
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>
  <div class="max-h-100 overflow-x-scroll overflow-y-scroll p-4">
    <table
      class="border border-gray-500"
      style="width: 100%; text-align: center"
    >
      <thead>
        <tr>
          <th class="w-1/9 px-1 py-2">{{ "date" | translate }}</th>
          <th class="w-1/9 px-1 py-2">{{ "Bond number" | translate }}</th>
          <th class="w-1/9 px-1 py-2">{{ "Bond type" | translate }}</th>
          <th class="w-1/9 px-1 py-2">
            {{ "Registration number" | translate }}
          </th>
          <th class="w-1/9 px-1 py-2">{{ "account code" | translate }}</th>
          <th class="w-1/9 px-1 py-2">{{ "account name" | translate }}</th>
          <th class="w-1/9 px-1 py-2">{{ "Statement" | translate }}</th>
          <th class="w-1/9 px-1 py-2">{{ "debtor" | translate }}</th>
          <th class="w-1/9 px-1 py-2">{{ "Creditor" | translate }}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let entry of AllJournalEntries">
          <td class="w-1/9 border px-1 py-2">{{ entry.transactionDate }}</td>
          <td class="w-1/9 border px-1 py-2">{{ entry.invoiceNumber }}</td>
          <td class="w-1/9 border px-1 py-2">{{ entry.typeName }}</td>
          <td class="w-1/9 border px-1 py-2">{{ entry.journalNo }}</td>
          <td class="w-1/9 border px-1 py-2">{{ entry.accountCode }}</td>
          <td class="w-1/9 border px-1 py-2">{{ entry.accountName }}</td>
          <td class="w-1/9 border px-1 py-2">{{ entry.notes }}</td>
          <td class="w-1/9 border px-1 py-2">{{ entry.depit }}</td>
          <td class="w-1/9 border px-1 py-2">{{ entry.credit }}</td>
        </tr>
        <tr>
          <td class="w-1/9 border px-1 py-2">{{ "total" | translate }}</td>
          <td class="w-1/9 border px-1 py-2"></td>
          <td class="w-1/9 border px-1 py-2"></td>
          <td class="w-1/9 border px-1 py-2"></td>
          <td class="w-1/9 border px-1 py-2"></td>
          <td class="w-1/9 border px-1 py-2"></td>
          <td class="w-1/9 border px-1 py-2"></td>
          <td class="w-1/9 border px-1 py-2 bg-green-500">{{ totaldepit }}</td>
          <td class="w-1/9 border px-1 py-2 bg-red-500">{{ totalcredit }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="flex justify-end p-3">
    <button
      (click)="PrintJournalsVyInvIdRetPurchase()"
      class="btn text-white me-2"
      style="background-color: var(--base-color)"
    >
      {{ "Print" | translate }}
    </button>

    <button (click)="modal?.dismiss()" class="btn btn-secondary">
      {{ "close" | translate }}
    </button>
  </div>
</ng-template>

<!-- decodingPagingModal  -->
<ng-template #decodingPagingModal let-modal>
  <div class="text-center p-3">
    {{ "Do you want to undo the deportation of this bond?" | translate }}
  </div>

  <div class="flex justify-center p-3">
    <button
      (click)="PostBackVouchers(); modal?.dismiss()"
      class="btn text-white me-2"
      style="background-color: var(--base-color)"
    >
      {{ "save" | translate }}
    </button>

    <button (click)="modal?.dismiss()" class="btn btn-secondary">
      {{ "close" | translate }}
    </button>
  </div>
</ng-template>
<!-- postModal  -->
<ng-template #postModal let-modal>
  <div class="text-center p-3" *ngIf="WhichPost == 1">
    {{ "Do you want to do the deportation of this bond?" | translate }}
  </div>
  <div class="text-center p-3" *ngIf="WhichPost == 2">
    {{ "Do you want to do the deportation of those bonds?" | translate }}
  </div>
  <div class="flex justify-center p-3">
    <button
      (click)="postbtn(); modal?.dismiss()"
      class="btn text-white me-2"
      style="background-color: var(--base-color)"
    >
      {{ "save" | translate }}
    </button>

    <button (click)="modal?.dismiss()" class="btn btn-secondary">
      {{ "close" | translate }}
    </button>
  </div>
</ng-template>

<!--sendEmail  -->
<ng-template #sendEmail let-modal>
  <!-- header -->
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4 class="m-0">
      <span class="text-2xl">{{ "sendSms" | translate }}</span>
    </h4>
    <button
      type="button"
      class="text-2xl text-white m-0"
      (click)="modal.dismiss()"
    >
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>

  <div class="modal-body">
    <ng-container>
      <form class="grid gap-3 grid-cols-1 md:grid-cols-2" #emailForm="ngForm">
        <div class="form-group">
          <label for="from" class="text-right col-form-label block">
            {{ "From" | translate }}
          </label>
          <input
            required
            #from="ngModel"
            [(ngModel)]="data.orgEmail"
            ngModel
            class="form-control"
            type="text"
            id="from"
            name="from"
            readonly
          />
        </div>

        <div class="form-group">
          <label for="to234" class="text-right col-form-label block">
            {{ "To" | translate }}
          </label>
          <input
            required
            #to234="ngModel"
            [(ngModel)]="modalInvoice.CustomerEmail"
            ngModel
            class="form-control"
            type="text"
            id="to234"
            name="to234"
            readonly
          />
        </div>
        <div class="form-group col-span-1 md:col-span-2">
          <label for="Subject" class="text-right col-form-label block">
            {{ "subject" | translate }}
          </label>
          <input
            required
            #Subject="ngModel"
            ngModel
            class="form-control"
            type="text"
            id="Subject"
            name="Subject"
          />
        </div>

        <div class="form-group col-span-1 md:col-span-2">
          <label for="Text32" class="text-right col-form-label block">
            {{ "Text" | translate }}
          </label>
          <textarea
            required
            #Text32="ngModel"
            ngModel
            class="form-control"
            type="text"
            id="Text32"
            name="Text32"
          ></textarea>
        </div>

        <div class="upload col-span-1 md:col-span-2">
          <label for="">{{ "Add Attachments" | translate }}</label>

          <file-upload [(ngModel)]="uploadedFiles" name="files"></file-upload>
        </div>

        <div
          class="flex gap-2 pt-3 border-t border-neutral-300 col-span-1 md:col-span-2 mt-2"
        >
          <button
            class="btn bg-base text-white"
            type="submit"
            (click)="sendEMAIL(emailForm.value)"
          >
            {{ "Send" | translate }}
          </button>
          <button (click)="modal?.dismiss()" class="btn btn-secondary">
            {{ "Back" | translate }}
          </button>
        </div>
      </form>
    </ng-container>
  </div>
</ng-template>

<!--sendWhatsApp  -->
<ng-template #sendWhatsApp let-modal>
  <!-- header -->
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4 class="m-0">
      <span class="text-2xl">{{ "إرسال الفاتورة عن طريق الواتس اب" | translate }}</span>
      <i style="margin-right: 10px;" class="fa-brands fa-whatsapp"></i>
    </h4>
    <button
      type="button"
      class="text-2xl text-white m-0"
      (click)="modal.dismiss()"
    >
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>

  <div class="modal-body">
    <ng-container>
      <form class="grid gap-3 grid-cols-1 md:grid-cols-2" #WhatsAppForm="ngForm">

        <div class="form-group">
          <label for="WhatsAppcustomerPhone" class="text-right col-form-label block">
            {{ "To" | translate }}
          </label>
          <input
            required
            #to234="ngModel"
            [(ngModel)]="RowInvoiceData.customerMobile"
            ngModel
            class="form-control"
            type="text"
            id="WhatsAppcustomerPhone"
            name="WhatsAppcustomerPhone"
            readonly
          />
        </div>

        <div class="form-group col-span-1 md:col-span-2">
          <label for="WhatsAppText" class="text-right col-form-label block">
            {{ "Text" | translate }}
          </label>
          <textarea
            required
            #WhatsAppText="ngModel"
            ngModel
            class="form-control"
            type="text"
            id="WhatsAppText"
            name="WhatsAppText"
          ></textarea>
        </div>

        <div class="upload col-span-1 md:col-span-2">
          <!-- <label for="">{{ "Add Attachments" | translate }}</label> -->
          <p style="text-align: center;color: red;font-weight: bold; " class="p-1 bg-red-100">
            {{ "يرجي تحميل الفاتورة PDF و ارفاقها هنا لكي تصل الي العميل بالشكل الجديد" | translate }}
          </p>
          <file-upload [(ngModel)]="uploadedFiles" name="files"></file-upload>
        </div>

        <div
          class="flex gap-2 pt-3 border-t border-neutral-300 col-span-1 md:col-span-2 mt-2"
        >
          <button
            class="btn bg-base text-white"
            type="submit"
            (click)="SendWInvoice(WhatsAppForm.value,modal)"
          >
            {{ "Send" | translate }}
          </button>
          <button (click)="modal?.dismiss()" class="btn btn-secondary">
            {{ "Back" | translate }}
          </button>
        </div>
      </form>
    </ng-container>
  </div>
</ng-template>


<!-- sendMessageModal  -->
<ng-template #sendMessageModal let-modal>
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4 class="m-0">
      <span class="text-2xl">{{ "sendSms" | translate }}</span>
    </h4>
    <button
      type="button"
      class="text-2xl text-white m-0"
      (click)="modal?.dismiss()"
    >
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>
  <div class="modal-body">
    <ng-container>
      <form class="grid gap-3 grid-cols-1 md:grid-cols-2" #smsForm="ngForm">
        <div class="form-group">
          <label for="clientName" class="text-right col-form-label block">
            {{ "Customer Name" | translate }}
          </label>
          <input
            required
            #clientName="ngModel"
            [(ngModel)]="modalInvoice.CustomerName"
            ngModel
            class="form-control"
            type="text"
            id="clientName"
            name="clientName"
            readonly
          />
        </div>

        <div class="form-group">
          <label for="mobileNumber" class="text-right col-form-label block">
            {{ "Mobile Number" | translate }}
          </label>
          <input
            required
            #mobileNumber="ngModel"
            [(ngModel)]="modalInvoice.CustomerMobile"
            ngModel
            class="form-control"
            type="text"
            id="mobileNumber"
            name="mobileNumber"
            readonly
          />
        </div>

        <div class="form-group col-span-1 md:col-span-2">
          <label for="Text32" class="text-right col-form-label block">
            {{ "Text" | translate }}
          </label>
          <textarea
            required
            #Text32="ngModel"
            ngModel
            class="form-control"
            type="text"
            id="Text32"
            name="Text32"
          ></textarea>
        </div>

        <div
          class="flex gap-2 pt-3 border-t border-neutral-300 col-span-1 md:col-span-2 mt-2"
        >
          <button
            class="btn bg-base text-white"
            [disabled]="smsForm.invalid"
            type="submit"
            (click)="sendSMS(smsForm.value)"
          >
            {{ "Send" | translate }}
          </button>
          <button (click)="modal?.dismiss()" class="btn btn-secondary">
            {{ "Back" | translate }}
          </button>
        </div>
      </form>
    </ng-container>
  </div>
</ng-template>

<!-- NewInvoiceModal  -->
<ng-template #NewInvoiceModal let-modal>
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4 class="m-0">
      <span *ngIf="modalInvoice.popuptype == 1" class="text-2xl">{{
        "NewsSalesInvoice" | translate
      }}</span>
      <span *ngIf="modalInvoice.popuptype == 2" class="text-2xl">{{
        "NewInvoice" | translate
      }}</span>
    </h4>
    <button
      type="button"
      class="text-2xl text-white m-0"
      (click)="modal?.dismiss()"
    >
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>

  <div class="modal-body">
    <ng-container>
      <div class="row align-items-end mb-2 mx-3">
        <div class="col-sm-6 col-md-3 col-lg-2 mb-0">
          <div class="form-group">
            <label for="date" class="text-right col-form-label block">
              {{ "date" | translate }}
            </label>
            <input
              placeholder="{{ 'Chose' | translate }}"
              name="date"
              type="text"
              class="form-control"
              bsDatepicker
              #dpr="bsDatepicker"
              autocomplete="off"
              [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY' }"
              (ngModelChange)="ChangeInvoiceGre($event)"
              [(ngModel)]="modalInvoice.Date"
              [ngModelOptions]="{ standalone: true }"
              [disabled]="
                modalInvoice.AddOrView != 1 && modalInvoice.AddOrView != 3
              "
            />
          </div>
        </div>

        <div class="col-sm-6 col-md-3 col-lg-2 mb-0">
          <div class="form-group">
            <label for="customerEn" class="text-right col-form-label block">
              {{ "invoice number" | translate }}
            </label>
            <input
              required
              placeholder="{{ 'invoice number' | translate }}"
              class="form-control"
              type="text"
              disabled
              autocomplete="off"
              [(ngModel)]="modalInvoice.InvoiceNumber"
              [ngModelOptions]="{ standalone: true }"
            />
          </div>
        </div>

        <div class="col-sm-6 col-md-3 col-lg-2 mb-0" style="display: none;">
          <div class="form-group">
            <input
              required
              placeholder="{{ 'SR' | translate }}"
              class="form-control"
              type="text"
              disabled
              autocomplete="off"
              [(ngModel)]="modalInvoice.Currency"
              [ngModelOptions]="{ standalone: true }"
            />
          </div>
        </div>

        <div class="col-sm-6 col-md-3 col-lg-2 mb-0">
          <div class="form-group">
            <input
              required
              placeholder="{{ 'Registration number' | translate }}"
              class="form-control"
              type="text"
              disabled
              autocomplete="off"
              [(ngModel)]="modalInvoice.JournalNumber"
              [ngModelOptions]="{ standalone: true }"
            />
          </div>
        </div>


        <div class="col-sm-6 col-md-3 col-lg-2 mb-0">
          <div class="form-group">
            <input
              placeholder="{{ '' | translate }}"
              required
              class="form-control"
              type="text"
              disabled
              autocomplete="off"
              [(ngModel)]="modalInvoice.OrganizationsAddress"
              [ngModelOptions]="{ standalone: true }"
            />
          </div>
        </div>

        <div class="col-sm-10 col-md-6 col-lg-4 mb-0">
          <div class="form-group">
            <ng-select
              class="w-full p-0"
              style="min-width: max-content; display: inline"
              placeholder="{{ 'Chose' | translate }}"
              [(ngModel)]="modalInvoice.CostCenterId"
              [ngModelOptions]="{ standalone: true }"
              name="CostCenterId"
            >
              <ng-option
                *ngFor="let user of load_CostCenter"
                [value]="user.id"
                >{{ user.name }}</ng-option
              >
            </ng-select>
          </div>
        </div>
        <!-- 2 line-->

        <div class="col-sm-6 col-md-3 col-lg-2 mb-0">
          <div class="form-group hijri-gregorianReciept">
            <label for="Corresponding" class="text-right col-form-label block">
              {{ "Corresponding" | translate }}
            </label>
            <hijri-gregorian-datepicker
              [(selectedDate)]="modalInvoice.HijriDate"
              [hijriLabel]="'Hijri'"
              [selectedDateType]="selectedDateType"
              [dir]="'dir' | translate"
              autocomplete="off"
              [disabled]="
                modalInvoice.AddOrView != 1 && modalInvoice.AddOrView != 3
              "
              (selectedDateChange)="ChangeInvoiceDateHijri($event)"
            >
            </hijri-gregorian-datepicker>
          </div>
        </div>
        <div class="col-sm-6 col-md-3 col-lg-2 mb-0">
          <div class="form-group">
            <label for="Paytype" class="text-right col-form-label block">
              {{ "Type" | translate }}
            </label>
            <ng-select
              class="w-full p-0"
              style="min-width: max-content; display: inline"
              placeholder="{{ 'Chose' | translate }}"
              name="Paytype"
              [clearable]="false"
              (change)="PayTypeChange()"
              [(ngModel)]="modalInvoice.PayType"
              [ngModelOptions]="{ standalone: true }"
              [disabled]="
                modalInvoice.AddOrView != 1 && modalInvoice.AddOrView != 3
              "
            >
              <ng-option
                *ngFor="let type of Paytype"
                [value]="type.id"
                [translate]="'name'"
                [translateParams]="{ ar: type.name?.ar, en: type.name?.en }"
              >
              </ng-option>
            </ng-select>
          </div>
        </div>

        <div class="col-sm-8 col-md-6 col-lg-6 mb-0">
          <div class="form-group">
            <ng-select
              class="w-full p-0"
              placeholder="{{ 'Chose' | translate }}"
              [(ngModel)]="modalInvoice.ToAccountId"
              [ngModelOptions]="{ standalone: true }"
              (change)="accountIdChange()"
              name="ToAccountId"
              [disabled]="
                modalInvoice.AddOrView != 1 && modalInvoice.AddOrView != 3
              "
            >
              <ng-option *ngFor="let user of load_Accounts" [value]="user.id">{{
                user.name
              }}</ng-option>
            </ng-select>
          </div>
        </div>

        <div class="col-sm-6 col-md-3 col-lg-2 mb-0">
          <div class="form-group">
            <input
              placeholder="{{ 'thePhone' | translate }}"
              required
              class="form-control"
              type="text"
              [(ngModel)]="modalInvoice.OrganizationsMobile"
              [ngModelOptions]="{ standalone: true }"
              disabled
            />
          </div>
        </div>


        <!-- 3 line -->

        <div class="col-sm-6 col-md-3 col-lg-3 mb-0">
          <div class="form-group">
            <label for="customerId" class="text-right col-form-label block">
              {{ "Client" | translate }}
            </label>
            <ng-select
              class="w-full p-0"
              placeholder="{{ 'Chose' | translate }}"
              id="customerId"
              name="customerId"
              (change)="customerIdChange()"
              [(ngModel)]="modalInvoice.customerId"
              [ngModelOptions]="{ standalone: true }"
              [disabled]="modalInvoice.AddOrView != 1"
            >
              <ng-option *ngFor="let user of load_Customer" [value]="user.id">{{
                user.name
              }}</ng-option>
            </ng-select>
          </div>
        </div>

        <!-- <div
          class="col-sm-6 col-md-3 col-lg-2 mb-0"
          *ngIf="modalInvoice.popuptype != 2"
        >
          <div class="form-group">
            <label for="ProjectId" class="text-right col-form-label block">
              {{ "Project" | translate }}
            </label>
            <ng-select
              class="w-full p-0"
              style="min-width: max-content"
              placeholder="{{ 'Chose' | translate }}"
              id="ProjectId"
              name="ProjectId"
              (change)="ProjectIdChange()"
              [(ngModel)]="modalInvoice.ProjectId"
              [ngModelOptions]="{ standalone: true }"
              [disabled]="modalInvoice.AddOrView != 1"
            >
              <ng-option *ngFor="let user of load_Projects" [value]="user.id">{{
                user.name
              }}</ng-option>
            </ng-select>
          </div>
        </div> -->

        <div
          class="col-sm-6 col-md-3 col-lg-2 mb-0"
          *ngIf="modalInvoice.popuptype == 2"
        >
          <div class="d-flex">
            <input
              type="checkbox"
              name="AllCustomer"
              id="AllCustomer"
              id="AllCustomerCheck"
              name="AllCustomerCheck"
              [(ngModel)]="modalInvoice.AllCustomerCheck"
              [ngModelOptions]="{ standalone: true }"
              [disabled]="modalInvoice.AddOrView != 1"
              (change)="AllCustomerCheckChange()"
            />
            <label for="AllCustomerCheck" class="mx-2">{{
              "AllCustomer" | translate
            }}</label>
          </div>
        </div>

        <div class="col-sm-6 col-md-3 col-lg-3 mb-0">
          <div class="form-group">
            <label for="CustomerTax" class="text-right col-form-label block">
              {{ "Tax Number" | translate }}
            </label>
            <input
              required
              placeholder="{{ '' | translate }}"
              class="form-control"
              type="text"
              id="CustomerTax"
              name="CustomerTax"
              disabled
              [(ngModel)]="modalInvoice.CustomerTax"
              [ngModelOptions]="{ standalone: true }"
            />
          </div>
        </div>
        <div class="col-sm-6 col-md-3 col-lg-3 mb-0" style="display: none">
          <div class="form-group">
            <label
              for="CustomerAddress"
              class="text-right col-form-label block"
            >
              {{ "Address" | translate }}
            </label>
            <input
              required
              placeholder="{{ '' | translate }}"
              class="form-control"
              id="CustomerAddress"
              name="CustomerAddress"
              type="text"
              disabled
              [(ngModel)]="modalInvoice.CustomerAddress"
              [ngModelOptions]="{ standalone: true }"
            />
          </div>
        </div>

        <div class="col-sm-8 col-md-4 col-lg-3 mb-0 text-end">
          <div class="form-check form-switch position-relative">
            <label
              class="form-check-label priceOffer"
              for="flexSwitchCheckDefault"
              style="width: max-content"
            >
              {{ "OfferPriceActiveNew" | translate }}
            </label>
            <input
              style="inset-inline-start: 0"
              class="form-check-input px-3 priceOfferInput position-absolute left-100"
              (change)="showPrice = !showPrice; offerpriceChange()"
              type="checkbox"
              role="switch"
              id="flexSwitchCheckDefault"
              [(ngModel)]="modalInvoice.OfferPriceNoCheck"
              [ngModelOptions]="{ standalone: true }"
              [disabled]="modalInvoice.AddOrView != 1"
            />
          </div>
        </div>

        <div
          class="col-sm-4 col-md-2 col-lg-1 mb-0"
          style="padding: 0 !important"
          *ngIf="showPrice && load_OfferPrices.length > 0"
        >
          <div class="form-group">
            <label for="OfferPriceNo" class="text-right col-form-label block">
              {{ "OfferPrice" | translate }}
            </label>
            <ng-select
              style="min-width: 79px !important"
              class="w-full p-0"
              id="OfferPriceNo"
              name="OfferPriceNo"
              placeholder="{{ 'Chose' | translate }}"
              (change)="offerpriceChange()"
              [(ngModel)]="modalInvoice.OfferPriceNo"
              [ngModelOptions]="{ standalone: true }"
              [disabled]="modalInvoice.AddOrView != 1"
            >
              <ng-option
                *ngFor="let user of load_OfferPrices"
                [value]="user.id"
                >{{ user.name }}</ng-option
              >
            </ng-select>
          </div>
        </div>

        <div class="col-sm-4 col-md-2 col-lg-1 mb-3" *ngIf="!showPrice">
          <span style="color: red"> {{ "shifta" | translate }}</span>
        </div>

        <div class="col-sm-6 col-md-3 col-lg-3 mb-0">
          <div class="form-group">
            <label for="StorehouseId" class="text-right col-form-label block">
              {{ "Storehouse" | translate }}</label
            >
            <div class="flex">
              <ng-select
              class="w-full p-0"
              placeholder="{{ 'Chose' | translate }}"
              [(ngModel)]="modalInvoice.storehouseId"
              [ngModelOptions]="{ standalone: true }"
              [disabled]="modalInvoice.AddOrView != 1"
              name="storehouseId"
              >
                <ng-option *ngFor="let user of Storehouse" [value]="user.id">{{
                  user.name
                }}</ng-option>
              </ng-select>
              <button
                type="button"
                [disabled]="modalInvoice.AddOrView != 1"
                class="btn bg-base text-white"
                style="padding: 5px 10px"
                (click)="open(StorehouseModal)"
              >
                <i class="fa fa-plus"></i>
              </button>

            </div>
          </div>
        </div>
        <div class="col-sm-6 col-md-4 col-lg-3 mb-0">
          <button
          (click)="open(addSerivceModal, null, 'addSerivceModal')"
          type="button"
          class="btn btn-outline-primary"
          >
            {{ "addServices" | translate }}
          </button>
        </div>


      </div>

      <div class="row mb-3">
        <h3  style="display: none"
          class="flex items-center justify-start fw-bold">       
          <button style="display: none"
            *ngIf="modalInvoice.AddOrView == 1"
            type="button "
            class="add-btn mx-2"
            (click)="addInvoiceRow()"
          >
            <i class="fa fa-plus"></i>
          </button>

        </h3>
        <div
          class="editable shadow mb-2 block customTable"
          style="overflow: auto"
        >
          <table
            class="table table-responsive table-striped table-bordered text-center"
            style="
              vertical-align: middle;
              font-size: 14px;
              min-width: max-content;
            "
          >
            <thead
              class="bg-base text-white"
              style="line-height: 30px; font-size: 13px"
            >
              <tr>
                <th>{{ "ServiceNo" | translate }}</th>
                <th style="width: 30% !important">
                  {{ "ServiceName" | translate }}
                </th>
                <th>{{ "Unit" | translate }}</th>
                <th>{{ "Quantity" | translate }}</th>
                <th>{{ "price" | translate }}</th>
                <th>{{ "Discount" | translate }}</th>
                <th>{{ "discountPercentage" | translate }}</th>
                <th>{{ "totalBeforeTax" | translate }}</th>
                <th>{{ "VATTax" | translate }}</th>
                <th>{{ "Net_taxes" | translate }}</th>
                <th>{{ "delete" | translate }}</th>
              </tr>
            </thead>
            <tbody>
              <tr
                *ngFor="let item of InvoiceDetailsRows; let i = index"
                style="line-height: 5px"
              >
                <td>{{ item.idRow }}</td>
                <td
                  (click)="
                    (modalInvoice.AddOrView == 1 ||
                      modalInvoice.AddOrView == 3) &&
                      open(servicesListModal, null, 'servicesList', item.idRow)
                  "
                >
                  <input
                    type="text"
                    name="os-name{{ item.idRow }}"
                    [(ngModel)]="item.accountJournaltxt"
                    readonly
                  />
                </td>
                <td>
                  <input
                    type="text"
                    name="os-Unit{{ item.idRow }}"
                    [(ngModel)]="item.UnitConst"
                    disabled
                  />
                </td>
                <td>
                  <input
                    type="number"
                    min="1"
                    name="os-Qty{{ item.idRow }}"
                    [(ngModel)]="item.QtyConst"
                    [disabled]="
                      modalInvoice.AddOrView != 1 && modalInvoice.AddOrView != 3
                    "
                    (keyup)="CalculateTotal2(1)"
                  />
                </td>
                <td>
                  <input
                    type="number"
                    min="0"
                    name="os-Amount{{ item.idRow }}"
                    [(ngModel)]="item.Amounttxt"
                    [disabled]="
                      modalInvoice.AddOrView != 1 && modalInvoice.AddOrView != 3
                    "
                    (keyup)="CalculateTotal2(1)"
                  />
                </td>
                <td>
                  <input
                    type="number"
                    min="0"
                    name="os-DiscountValue{{ item.idRow }}"
                    [(ngModel)]="item.DiscountValueConst"
                    [disabled]="modalInvoice.AddOrView != 1"
                    (keyup)="CalculateTotal2(1)"
                  />
                </td>
                <td>
                  <input
                    type="number"
                    min="0"
                    name="os-DiscountPercentage{{ item.idRow }}"
                    [(ngModel)]="item.DiscountPercentageConst"
                    [disabled]="modalInvoice.AddOrView != 1"
                    (keyup)="CalculateTotal2(2)"
                  />
                </td>
                <td>
                  <input
                    type="text"
                    name="os-AmountBefore{{ item.idRow }}"
                    [(ngModel)]="item.AmountBeforeTaxtxt"
                    [disabled]="modalInvoice.AddOrView != 1"
                    readonly
                  />
                </td>
                <td>
                  <input
                    type="text"
                    name="os-taxAmount{{ item.idRow }}"
                    [(ngModel)]="item.taxAmounttxt"
                    [disabled]="modalInvoice.AddOrView != 1"
                    readonly
                  />
                </td>
                <td>
                  <input
                    type="text"
                    name="os-TotalAmount{{ item.idRow }}"
                    [(ngModel)]="item.TotalAmounttxt"
                    [disabled]="modalInvoice.AddOrView != 1"
                    readonly
                  />
                </td>

                <td class="flex">
                  <button
                    title=""
                    class="p-2 bg-orange-100 hover:bg-orange-500 rounded-lg duration-300 hover:text-white w-10"
                    style="margin-inline-end: 6px"
                    (click)="
                      open(
                        serviceDetailsModal_Invoice,
                        item,
                        'serviceDetails_Invoice'
                      )
                    "
                  >
                    <i class="fa-solid fa-info"></i>
                  </button>
                  <button
                    *ngIf="
                      modalInvoice.AddOrView == 1 || modalInvoice.AddOrView == 3
                    "
                    (click)="
                      RemoveServicesparent_invoice(item);
                      deleteInvoiceRow(item.idRow)
                    "
                    class="p-2 bg-red-100 hover:bg-red-500 rounded-lg duration-300 hover:text-white w-10"
                  >
                    <i class="fa-solid fa-trash-can"></i>
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="row">
          <div class="col-md-6">
            <div class="box w-100 p-3">
              <div>
                <label for="include_tax">{{ "tax type" | translate }}</label>
                <ng-select
                  class="w-100"
                  placeholder="{{ 'Chose' | translate }}"
                  name="include_tax"
                  [(ngModel)]="modalInvoice.taxtype"
                  [ngModelOptions]="{ standalone: true }"
                  [disabled]="modalInvoice.AddOrView != 1"
                  [clearable]="false"
                  (change)="taxtypeChange()"
                >
                  <ng-option [value]="2">{{
                    "Excluding tax" | translate
                  }}</ng-option>
                  <ng-option [value]="3">{{
                    "Taxes included" | translate
                  }}</ng-option>
                </ng-select>
              </div>

              <div>
                <label for="paid" class="text-right col-form-label block">
                  {{ "paid" | translate }}
                </label>
                <input
                  id="paid"
                  required
                  class="form-control bg-green"
                  type="text"
                  [(ngModel)]="modalInvoice.PaidValue"
                  [ngModelOptions]="{ standalone: true }"
                  [disabled]="
                    modalInvoice.AddOrView != 1 && modalInvoice.AddOrView != 3
                  "
                  [readOnly]="modalInvoice.PayType == 8"
                  (keyup)="checkRemainder()"
                />
              </div>

              <div>
                <label for="remaining">{{ "remaining" | translate }}</label>
                <input
                  type="text"
                  id="remaining"
                  name="remaining"
                  class="form-control bg-red"
                  [(ngModel)]="modalInvoice.remainder"
                  [ngModelOptions]="{ standalone: true }"
                  disabled
                />
              </div>
            </div>

            <div class="d-flex me-3">
              <input
                type="checkbox"
                name="printBankAccount"
                id="printBankAccount"
                [(ngModel)]="modalInvoice.printBankAccount"
                [ngModelOptions]="{ standalone: true }"
                [disabled]="modalInvoice.AddOrView != 1"
              />
              <label for="date" class="mx-2">{{
                "hideAccount" | translate
              }}</label>
            </div>

            <div class="form-group row me-3">
              <label for="Statement" class="col-sm-2 col-form-label">{{
                "Statement" | translate
              }}</label>
              <div class="col-sm-10">
                <input
                  [disabled]="
                    modalInvoice.AddOrView != 1 && modalInvoice.AddOrView != 3
                  "
                  type="text"
                  id="Statement"
                  name="Statement"
                  class="form-control"
                  placeholder="{{ 'Statement' | translate }}"
                  [(ngModel)]="modalInvoice.InvoiceNotes"
                  [ngModelOptions]="{ standalone: true }"
                  autocomplete="off"
                />
              </div>
            </div>

            <div class="form-group row me-3">
              <label for="theNotes" class="col-sm-2 col-form-label">{{
                "theNotes" | translate
              }}</label>
              <div class="col-sm-10">
                <input
                  [disabled]="
                    modalInvoice.AddOrView != 1 && modalInvoice.AddOrView != 3
                  "
                  type="text"
                  id="theNotes"
                  name="theNotes"
                  class="form-control"
                  placeholder="{{ 'theNotes' | translate }}"
                  [(ngModel)]="modalInvoice.Notes"
                  [ngModelOptions]="{ standalone: true }"
                  autocomplete="off"
                />
              </div>
            </div>

            <div
              class="form-group row me-3"
              *ngIf="modalInvoice.AddOrView == 1"
            >
              <label for="attachments" class="col-sm-2 col-form-label">{{
                "attachments" | translate
              }}</label>
              <div class="col-sm-10">
                <file-upload
                  class="w-full"
                  style="min-height: 40px"
                  [(ngModel)]="uploadedFiles"
                  name="files"
                ></file-upload>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="box w-100 px-1 py-2 mx-3">
              <div>
                <label
                  for="totalAmount"
                  class="text-right col-form-label block"
                >
                  {{ "totalAmount" | translate }}
                </label>
                <input
                  id="totalAmount"
                  required
                  class="form-control"
                  type="text"
                  [(ngModel)]="modalInvoice.totalAmount"
                  [ngModelOptions]="{ standalone: true }"
                  disabled
                />
              </div>
              <div>
                <label
                  for="TotalDiscount"
                  class="text-right col-form-label block"
                >
                  {{ "TotalDiscount" | translate }}
                </label>
                <input
                  id="TotalDiscount"
                  required
                  class="form-control"
                  type="text"
                  [(ngModel)]="modalInvoice.discounMoneytVal"
                  [ngModelOptions]="{ standalone: true }"
                  disabled
                />
              </div>

              <div>
                <label for="netAmount" class="text-right col-form-label block">
                  {{ "netAmount" | translate }}
                </label>
                <input
                  id="netAmount"
                  required
                  class="form-control"
                  type="text"
                  [(ngModel)]="modalInvoice.totalWithDiscount"
                  [ngModelOptions]="{ standalone: true }"
                  disabled
                />
              </div>

              <div>
                <label for="AllTotal" class="text-right col-form-label block">
                  {{ "AllTotal" | translate }}
                </label>
                <input
                  id="AllTotal"
                  required
                  class="form-control"
                  type="text"
                  [(ngModel)]="modalInvoice.total_"
                  [ngModelOptions]="{ standalone: true }"
                  disabled
                />
              </div>

              <div>
                <label for="netBill">{{ "netBill" | translate }}</label>
                <input
                  type="text"
                  id="netBill"
                  name="netBill"
                  class="form-control"
                  [(ngModel)]="modalInvoice.VoucherValue"
                  [ngModelOptions]="{ standalone: true }"
                  disabled
                />
              </div>

              <div>
                <label for="TotalTaxes" class="text-right col-form-label block">
                  {{ "TotalTaxes" | translate }}
                </label>
                <input
                  id="TotalTaxes"
                  required
                  class="form-control bg-yellow"
                  type="text"
                  [(ngModel)]="modalInvoice.taxAmountLbl"
                  [ngModelOptions]="{ standalone: true }"
                  disabled
                />
              </div>

              <div>
                <label for="CreditNoteTotal">{{
                  "CreditNoteTotal" | translate
                }}</label>
                <input
                  type="text"
                  id="CreditNoteTotal"
                  name="CreditNoteTotal"
                  class="form-control"
                  [(ngModel)]="modalInvoice.CreditNotiLbl"
                  [ngModelOptions]="{ standalone: true }"
                  disabled
                />
              </div>

              <div style="display: none">
                <label for="TotalDebtorNotice">{{
                  "TotalDebtorNotice" | translate
                }}</label>
                <input
                  type="text"
                  id="TotalDebtorNotice"
                  name="TotalDebtorNotice"
                  class="form-control"
                  [(ngModel)]="modalInvoice.DepitNotiLbl"
                  [ngModelOptions]="{ standalone: true }"
                  disabled
                />
              </div>

              <div>
                <label for="Net_taxes" class="text-right col-form-label block">
                  {{ "Net_taxes" | translate }}
                </label>
                <input
                  id="Net_taxes"
                  required
                  class="form-control bg-black"
                  type="text"
                  [(ngModel)]="modalInvoice.TotalVoucherValueLbl"
                  [ngModelOptions]="{ standalone: true }"
                  disabled
                />
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- footer -->
    </ng-container>

    <div
      class="d-flex justify-content-end"
      *ngIf="modalInvoice.AddOrView == 3 && modalInvoice.IsPost == true"
    >
      <div class="pt-1 m-1">
        <button
          [disabled]="disableButtonSave_Invoice"
          (click)="
            modalInvoice.WhichClick = 3;
            open(
              SaveInvoiceConfirmModal,
              null,
              'SaveInvoiceConfirmModal',
              null,
              null,
              modal
            )
          "
          class="btn text-white"
          style="background-color: var(--base-color)"
        >
          {{ "save" | translate }}
        </button>
      </div>
    </div>
    <div class="d-flex justify-content-end" *ngIf="modalInvoice.AddOrView == 1">
      <div class="pt-1 m-1">
        <button
          [disabled]="disableButtonSave_Invoice"
          *ngIf="userG?.userPrivileges.includes(13100407)"
          (click)="
            modalInvoice.WhichClick = 2;
            open(
              SaveInvoiceConfirmModal,
              null,
              'SaveInvoiceConfirmModal',
              null,
              null,
              modal
            )
          "
          class="btn text-white"
          style="background-color: var(--base-color)"
        >
          {{ "Save_CarryOver" | translate }}
        </button>
      </div>

      <div class="pt-1 m-1">
        <button (click)="modal?.dismiss()" class="btn btn-secondary">
          {{ "close" | translate }}
        </button>
      </div>

      <div class="pt-1 m-1">
        <button
          [disabled]="disableButtonSave_Invoice"
          (click)="
            modalInvoice.WhichClick = 1;
            open(
              SaveInvoiceConfirmModal,
              null,
              'SaveInvoiceConfirmModal',
              null,
              null,
              modal
            )
          "
          class="btn text-white"
          style="background-color: var(--base-color)"
        >
          {{ "save" | translate }}
        </button>
      </div>
    </div>
  </div>
</ng-template>

<!-- PaymentInvoiceModal  -->
<ng-template #PaymentInvoiceModal let-modal>
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4 class="m-0">
      <span class="text-2xl">{{ "ReceiptVoucher" | translate }}</span>
    </h4>
    <button
      type="button"
      class="text-2xl text-white m-0"
      (click)="modal?.dismiss()"
    >
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>

  <div class="modal-body">
    <ng-container>
      <form #addForm="ngForm">
        <div class="row align-items-end justify-end mb-3 mx-3">
          <!-- 1 line -->
          <div class="col-sm-6 col-md-3 col-lg-4 mb-0">
            <div class="form-group">
              <label for="customerEn" class="text-right col-form-label block">
                {{ "date" | translate }}
              </label>
              <input
                placeholder="{{ 'Chose' | translate }}"
                name="date"
                type="text"
                class="form-control"
                bsDatepicker
                #dpr="bsDatepicker"
              />
            </div>
          </div>

          <div class="col-sm-6 col-md-3 col-lg-4 mb-0">
            <div class="form-group">
              <label for="customerEn" class="text-right col-form-label block">
                {{ "Bond number" | translate }}
              </label>
              <input required class="form-control" type="text" disabled />
            </div>
          </div>

          <div class="col-sm-6 col-md-3 col-lg-4 mb-0">
            <div class="form-group">
              <label for="customerEn" class="text-right col-form-label block">
                {{ "m_Cost" | translate }}
              </label>
              <ng-select
                class="w-full p-0"
                placeholder="{{ 'mainCenter' | translate }}"
                [(ngModel)]="modalInvoice.user"
                [ngModelOptions]="{ standalone: true }"
                name="user"
              >
                <ng-option *ngFor="let user of users" [value]="user.id">{{
                  user.Name
                }}</ng-option>
              </ng-select>
            </div>
          </div>

          <!-- 2 line -->

          <div class="col-sm-6 col-md-3 col-lg-4 mb-0">
            <div class="form-group">
              <label for="customerEn" class="text-right col-form-label block">
                {{ "Corresponding" | translate }}
              </label>
              <input
                placeholder="{{ 'Chose' | translate }}"
                name="date"
                type="text"
                class="form-control"
                bsDatepicker
                #dpr="bsDatepicker"
              />
            </div>
          </div>

          <div class="col-sm-6 col-md-3 col-lg-4 mb-0">
            <div class="form-group">
              <label for="customerEn" class="text-right col-form-label block">
                {{ "referenceNumber" | translate }}
              </label>
              <input
                placeholder="{{ 'referenceNumber' | translate }}"
                required
                class="form-control"
                type="text"
              />
            </div>
          </div>

          <div class="col-sm-6 col-md-3 col-lg-4 mb-0">
            <div class="form-group">
              <label for="customerEn" class="text-right col-form-label block">
                {{ "R_theInvoice" | translate }}
              </label>
              <input
                required
                placeholder="{{ 'R_theInvoice' | translate }}"
                class="form-control"
                type="text"
                disabled
              />
            </div>
          </div>

          <!-- 3 line -->
          <div class="col-sm-6 col-md-3 col-lg-4 mb-0">
            <div class="form-group">
              <label for="customerEn" class="text-right col-form-label block">
                {{ "Registration number" | translate }}
              </label>
              <input
                required
                placeholder="{{ 'Registration number' | translate }}"
                class="form-control"
                type="text"
                disabled
              />
            </div>
          </div>

          <div class="col-sm-6 col-md-3 col-lg-4 mb-0">
            <div class="form-group">
              <label for="customerEn" class="text-right col-form-label block">
                {{ "Payment type" | translate }}
              </label>
              <ng-select
                placeholder="{{ 'Chose' | translate }}"
                class="w-full p-0"
              >
                <ng-option *ngFor="let user of users" [value]="user.id">{{
                  user.Name
                }}</ng-option>
              </ng-select>
            </div>
          </div>

          <div class="col-sm-6 col-md-3 col-lg-4 mb-0">
            <div class="form-group">
              <label for="customerEn" class="text-right col-form-label block">
                {{ "A_Client" | translate }}
              </label>
              <ng-select
                placeholder="{{ 'Chose' | translate }}"
                class="w-full p-0"
                disabled
              >
                <ng-option *ngFor="let user of users" [value]="user.id">{{
                  user.Name
                }}</ng-option>
              </ng-select>
            </div>
          </div>
        </div>

        <!--  -->
        <div class="row mx-3 items-end">
          <div class="col-md-12">
            <div class="boxContainer mb-3 w-100 p-3">
              <div class="row">
                <div class="col-md-3">
                  <label
                    for="recipientName"
                    class="text-yellow"
                    for="recipientName"
                  >
                    {{ "recipientName" | translate }}
                  </label>
                </div>
                <div class="col-md-9">
                  <input
                    id="recipientName"
                    placeholder="{{ 'recipientName' | translate }}"
                    required
                    class="form-control text-center {{
                      recipientName.invalid && recipientName.touched
                        ? 'errorInput'
                        : ''
                    }}"
                    type="text"
                    ngModel
                    name="recipientName"
                    #recipientName="ngModel"
                  />
                </div>
              </div>

              <div class="row">
                <div class="col-md-3">
                  <label for="AmountOf" class="text-orange">
                    {{ "AmountOf" | translate }}
                  </label>
                </div>
                <div class="col-md-3">
                  <input
                    id="AmountOf"
                    placeholder="{{ 'AmountOf' | translate }}"
                    required
                    class="form-control text-center {{
                      AmountOf.invalid && AmountOf.touched ? 'errorInput' : ''
                    }}"
                    type="number"
                    ngModel
                    name="AmountOf"
                    #AmountOf="ngModel"
                  />
                </div>
                <div class="col-md-6">
                  <input
                    id="AmountOf"
                    placeholder="{{ 'amountWriting' | translate }}"
                    required
                    class="form-control text-center"
                    type="text"
                    disabled
                  />
                </div>
              </div>

              <div class="row">
                <div class="col-md-3">
                  <label for="AndThatFor" class="text-yellow">
                    {{ "AndThatFor" | translate }}
                  </label>
                </div>
                <div class="col-md-9">
                  <input
                    id="AndThatFor"
                    placeholder="{{ 'AndThatFor' | translate }}"
                    required
                    class="form-control text-center {{
                      AndThatFor.invalid && AndThatFor.touched
                        ? 'errorInput'
                        : ''
                    }}"
                    type="text"
                    ngModel
                    name="AndThatFor"
                    #AndThatFor="ngModel"
                  />
                </div>
              </div>
            </div>
            <div class="boxContainer w-100 p-3">
              <div class="row">
                <div class="col-md-3">
                  <label for="fromAccount" class="text-orange">
                    {{ "fromAccount" | translate }}
                  </label>
                </div>
                <div class="col-md-6">
                  <ng-select
                    placeholder="{{ 'Chose' | translate }}"
                    required
                    class="w-full p-0 h-100 {{
                      fromAccount.invalid && fromAccount.touched
                        ? 'errorInput'
                        : ''
                    }}"
                    ngModel
                    name="fromAccount"
                    #fromAccount="ngModel"
                  >
                    <ng-option *ngFor="let user of users" [value]="user.id">
                      {{ user.Name }}</ng-option
                    >
                  </ng-select>
                </div>
                <div class="col-md-3">
                  <input
                    id="accountNumber"
                    required
                    placeholder="{{ 'accountNumber' | translate }}"
                    class="form-control text-center"
                    type="text"
                    disabled
                  />
                </div>
              </div>

              <div class="row">
                <div class="col-md-3">
                  <label for="toAccount" class="text-green-500">
                    {{ "toAccount" | translate }}
                  </label>
                </div>
                <div class="col-md-6">
                  <ng-select
                    placeholder="{{ 'Chose' | translate }}"
                    required
                    class="w-full p-0 h-100 {{
                      toAccount.invalid && toAccount.touched ? 'errorInput' : ''
                    }}"
                    ngModel
                    name="toAccount"
                    #toAccount="ngModel"
                  >
                    <ng-option *ngFor="let user of users" [value]="user.id">
                      {{ user.Name }}</ng-option
                    >
                  </ng-select>
                </div>
                <div class="col-md-3">
                  <input
                    id="accountNumber"
                    placeholder="{{ 'accountNumber' | translate }}"
                    required
                    class="form-control text-center"
                    type="text"
                    disabled
                  />
                </div>
              </div>

              <div class="row">
                <div class="col-md-3">
                  <label for="Statement " class="text-babyblue">
                    {{ "Statement" | translate }}
                  </label>
                </div>
                <div class="col-md-9">
                  <input
                    id="Statement "
                    placeholder="{{ 'Statement' | translate }}"
                    required
                    class="form-control text-center {{
                      Statement.invalid && Statement.touched ? 'errorInput' : ''
                    }}"
                    type="text"
                    ngModel
                    name="Statement"
                    #Statement="ngModel"
                  />
                </div>
              </div>

              <div class="row">
                <div class="col-md-3">
                  <label for="Notes " class="text-babyblue">
                    {{ "Notes" | translate }}
                  </label>
                </div>
                <div class="col-md-9">
                  <input
                    id="Notes "
                    placeholder="{{ 'Notes' | translate }}"
                    required
                    class="form-control text-center {{
                      Notes.invalid && Notes.touched ? 'errorInput' : ''
                    }}"
                    type="text"
                    ngModel
                    name="Notes"
                    #Notes="ngModel"
                  />
                </div>
              </div>
            </div>
          </div>
        </div>
      </form>

      <!-- footer -->
    </ng-container>

    <div class="d-flex justify-content-end mx-3">
      <div class="pt-3 m-3">
        <button
          class="btn text-white"
          style="background-color: var(--base-color)"
        >
          {{ "save" | translate }}
        </button>
      </div>

      <div class="pt-3 m-3">
        <button (click)="modal?.dismiss()" class="btn btn-secondary">
          {{ "close" | translate }}
        </button>
      </div>
    </div>
  </div>
</ng-template>

<!-- servicesListModal -->
<ng-template #servicesListModal let-modal>
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4 class="m-0">
      <span class="text-2xl">{{ "servicesList" | translate }}</span>
    </h4>
    <button
      type="button"
      class="text-2xl text-white m-0"
      (click)="modal.dismiss()"
    >
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>
  <div class="modal-body" style="overflow-y: scroll; max-height: 600px">
    <mat-form-field class="w-full">
      <mat-label>{{ "search" | translate }}</mat-label>
      <input matInput (keyup)="applyFilterServiceList($event)" #input />
    </mat-form-field>

    <div class="table">
      <table
        mat-table
        [dataSource]="serviceListDataSource"
        class="mat-elevation-z8 table table-responsive table-striped table-bordered text-center"
        style="vertical-align: middle; font-size: 14px;min-width: fit-content;"
      >
        <!-- Name Column -->
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef>
            {{ "ServiceName" | translate }}
          </th>
          <td mat-cell *matCellDef="let element">{{ element.servicesName }}</td>
        </ng-container>

        <!-- price Column -->
        <ng-container matColumnDef="price">
          <th mat-header-cell *matHeaderCellDef>{{ "price" | translate }}</th>
          <td mat-cell *matCellDef="let element">{{ element.amount }}</td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="servicesListdisplayedColumns"></tr>
        <tr
          mat-row
          *matRowDef="
            let row;
            let i = index;
            columns: servicesListdisplayedColumns
          "
          (dblclick)="setServiceRowValue(row); modal.dismiss()"
        ></tr>

        <!-- Row shown when there is no matching data. -->
        <tr class="mat-row" *matNoDataRow>
          <td class="mat-cell" colspan="4">
            {{ "noResult" | translate }} "{{ input.value }}"
          </td>
        </tr>
      </table>
      <mat-paginator #paginatorServices [pageSizeOptions]="[10, 25]">
      </mat-paginator>
    </div>

    <div class="text-end mt-2">
      <button (click)="modal?.dismiss()" class="btn btn-secondary">
        {{ "Back" | translate }}
      </button>
    </div>
  </div>
</ng-template>

<!-- zatcaListModal -->
<ng-template #zatcaListModal let-modal>
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4 class="m-0">
      <span class="text-2xl">{{ "ملاحظات زاتكا" | translate }}</span>
    </h4>
    <button
      type="button"
      class="text-2xl text-white m-0"
      (click)="modal.dismiss()"
    >
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>
  <div class="modal-body" style="overflow-y: scroll; max-height: 600px">
    <div class="table">
      <table
        mat-table
        [dataSource]="zatcaListDataSource"
        class="mat-elevation-z8 table table-responsive table-striped table-bordered text-center"
        style="vertical-align: middle; font-size: 14px;min-width: fit-content;">
        <!-- Name Column -->
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef>
            {{ "الملاحظة" | translate }}
          </th>
                    <td mat-cell *matCellDef="let element" style="padding: 13px;">
            <span style="font-size: 16px;background-color: #30b130;font-weight: bold;"
            *ngIf="element.statusCode==200">تم ارسال الفاتورة بنجاح إلي زاتكا</span>
            <span style="font-size: 16px;background-color: #b7d14d;font-weight: bold;"
            *ngIf="element.statusCode==202">تم قبول الفاتورة من قبل زاتكا (مع تحذيرات)</span>
            <span style="font-size: 16px;background-color: #dd5858;font-weight: bold;"
            *ngIf="(element.statusCode==400)">تم رفض الفاتورة من قبل زاتكا</span>
            <span style="font-size: 16px;background-color: #979797;font-weight: bold;"
            *ngIf="element.statusCode ==0 || element.statusCode==504 || element.statusCode==503 
                  || element.statusCode==500 || element.statusCode==429">يجب عليك اعادة ارسال الفاتورة الي زاتكا</span>

            

            <span *ngIf="element.statusCode==202">{{ element.warningmessage }} </span>
            <span *ngIf="(element.statusCode==400)">{{ element.errormessage }}</span>

            
      
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="zatcaListdisplayedColumns"></tr>
        <tr
          mat-row
          *matRowDef="
            let row;
            let i = index;
            columns: zatcaListdisplayedColumns"></tr>

        <!-- Row shown when there is no matching data. -->
        <tr class="mat-row" *matNoDataRow>
          <td class="mat-cell" colspan="4">
            {{ "noResult" | translate }}
          </td>
        </tr>
      </table>
      <!-- <mat-paginator #paginatorZatca [pageSizeOptions]="[10, 25]">
      </mat-paginator> -->
    </div>

    <div class="text-end mt-2">
      <button (click)="modal?.dismiss()" class="btn btn-secondary">
        {{ "Back" | translate }}
      </button>
    </div>
  </div>
</ng-template>

<!-- <button
  (click)="open(printDivModal)"
  class="min-w-max p-2 bg-sky-100 hover:bg-sky-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
>
  popup print
</button> -->

<ng-template #printDivModal let-modal>
  <div class="modal-body">
    <div
      id="divHtml_a"
      class="divHtml"
      style="width: 100% !important; margin: 0px auto !important"
    >
      <div>
        <img
          *ngIf="CustomData.headerurl"
          src="{{ CustomData.headerurl }}"
          alt="headerurl"
          style="height: 60px; width: 100%; max-width: 100%; object-fit: fill"
        />
      </div>
      <div class="invoiceNe-wrapper" style="direction: rtl !important">
        <!--Header-->
        <div class="invoiceNe-header">
          <div class="headerNe-right-side">
            <img
              *ngIf="CustomData.OrgImg"
              src="{{ CustomData.OrgImg }}"
              alt="logo"
              style="
                height: 80px;
                width: 140px;
                max-width: 200px;
                object-fit: fill;
              "
            />
          </div>
          <div class="headerNe-lefy-side" style="width: 100%">
            <p>{{ InvPrintData?.org_VD?.nameAr }}</p>
            <p>{{ InvPrintData?.org_VD?.nameEn }}</p>
            <div class="line" style="position: relative; padding: 1px 0px 1px">
              <span
                style="
                  position: absolute;
                  right: 0;
                  width: 100%;
                  height: 2px;
                  background-color: #e5e5e5;
                  z-index: 1;
                "
              ></span>
              <span
                style="
                  position: absolute;
                  right: 0;
                  width: 70%;
                  height: 2px;
                  background-color: #ec1c24;
                  z-index: 2;
                "
              ></span>
            </div>
            <h1 style="margin-bottom: 0">فاتورة ضريبية</h1>
          </div>
        </div>
        <!--/Header-->

        <!--invoiceNe-content-->
        <div class="invoiceNe-content">
          <div class="firstNe-table-main-heading" style="display: flex">
            <div class="firstNe-table" style="margin-left: 5px; width: 50%">
              <table
                class="tableI"
                style="
                  margin-bottom: 5px;
                  vertical-align: middle;
                  text-align: center;
                "
              >
                <thead>
                  <tr>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      رقم الفاتورة
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      {{ InvPrintData?.invoicesVM_VD?.invoiceNumber }}
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      Invoice No
                    </th>
                  </tr>
                  <tr>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      تاريخ الفاتورة
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      {{ InvPrintData?.invoicesVM_VD?.date }}
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      Invoice Date
                    </th>
                  </tr>

                  <tr>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      تاريخ التوريد
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      {{ InvPrintData?.invoicesVM_VD?.date }}
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      Date of supply
                    </th>
                  </tr>
                </thead>
              </table>
            </div>
            <div class="firstNe-table" style="margin-right: 5px; width: 50%">
              <table
                of
                supplyable
                class="tableI"
                style="
                  margin-bottom: 5px;
                  vertical-align: middle;
                  text-align: center;
                "
              >
                <thead>
                  <tr>
                    <th
                      style="
                        background-color: #faebd7;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      فاتورة ضريبية
                    </th>
                    <th
                      style="
                        background-color: #faebd7;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      {{ InvPrintData?.invoicesVM_VD?.payTypeName }}
                    </th>
                    <th
                      style="
                        background-color: #faebd7;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      Tax Invoice
                    </th>
                  </tr>
                  <!-- <tr>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      رقم المشروع
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      {{ InvPrintData?.invoicesVM_VD?.projectNo }}
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      Project No
                    </th>
                  </tr> -->

                  <tr>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      رقم العقد
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      {{ CustomData.ContractNo }}
                    </th>
                    <th
                      style="
                        background-color: #dceefd;
                        padding: 2px;
                        color: #53627e;
                        font-size: 12px;
                        letter-spacing: 0px;
                        border: 1px solid #f0f7fe;
                      "
                    >
                      Contract No
                    </th>
                  </tr>
                </thead>
              </table>
            </div>
          </div>

          <!--Details-->
          <div
            class="invoiceNe-details"
            style="margin-bottom: 0px; display: flex"
          >
            <!--second table-->
            <div class="secondNe-table" style="margin-left: 5px; width: 50%">
              <h4
                class="tableNe-heading"
                style="
                  background-color: #dceefd !important;
                  font-size: 15px;
                  letter-spacing: 0px;
                  font-weight: 700;
                  padding: 1px 10px;
                "
              >
                <span>بيانات المورد </span>
                <span>Seller</span>
              </h4>
              <table style="vertical-align: middle; text-align: center">
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الاسم
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.org_VD?.nameAr
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Name
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    العنوان
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.address
                        : InvPrintData?.branch_VD?.address
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Address
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    ر.المبنى
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.buildingNumber
                        : InvPrintData?.branch_VD?.buildingNumber
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Build.No
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الشارع
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.streetName
                        : InvPrintData?.branch_VD?.streetName
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Street
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الحي
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.neighborhood
                        : InvPrintData?.branch_VD?.neighborhood
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Area
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    المدينة
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.cityName
                        : InvPrintData?.branch_VD?.cityName
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    City
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الدولة
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.country
                        : InvPrintData?.branch_VD?.country
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Country
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    ر.البريدى
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.postalCodeFinal
                        : InvPrintData?.branch_VD?.postalCodeFinal
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    P.Code
                  </th>
                </tr>

                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    ر.الاضافي
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.externalPhone
                        : InvPrintData?.branch_VD?.externalPhone
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Addit. No
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    ر.الضريبي
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.orgIsRequired_VD == true
                        ? InvPrintData?.org_VD?.taxCode
                        : InvPrintData?.branch_VD?.taxCode
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    VAT
                  </th>
                </tr>
                <tr></tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الفرع
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{
                      InvPrintData?.branch_VD?.isPrintInvoice == true
                        ? InvPrintData?.branch_VD?.nameAr
                        : "--"
                    }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Branch
                  </th>
                </tr>
              </table>
            </div>
            <!--second table-->
            <!--third table-->
            <div class="thirdNe-table" style="margin-right: 5px; width: 50%">
              <h4
                class="tableNe-heading"
                style="
                  background-color: #faebd7 !important;
                  font-size: 15px;
                  letter-spacing: 0px;
                  font-weight: 700;
                  padding: 1px 10px;
                "
              >
                <span>بيانات العميل </span>
                <span>Customer</span>
              </h4>
              <table style="vertical-align: middle; text-align: center">
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الاسم
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.customerVM_VD?.customerNameAr }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Name
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    العنوان
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.customerVM_VD?.customerAddress }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Address
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    ر.المبنى
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.customerVM_VD?.buildingNumber }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Build.No
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الشارع
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.customerVM_VD?.streetName }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Street
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الحي
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.customerVM_VD?.neighborhood }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Area
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    المدينة
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.customerVM_VD?.cityName }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    City
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    الدولة
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.customerVM_VD?.country }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Country
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    ر.البريدى
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.customerVM_VD?.postalCodeFinal }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    P.Code
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    ر. الاضافي
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.customerVM_VD?.externalPhone }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    Addit.No
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    ر.الضريبي
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.customerVM_VD?.commercialRegInvoice }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    VAT
                  </th>
                </tr>
                <tr>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    معرف اخر
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    {{ InvPrintData?.customerVM_VD?.commercialRegister }}
                  </th>
                  <th
                    style="
                      padding: 0px;
                      font-size: 12px;
                      letter-spacing: 0px;
                      border: 1px solid #f0f7fe;
                    "
                  >
                    A.SellerID
                  </th>
                </tr>
              </table>
            </div>
            <!--third table-->
          </div>

          <!--totalNe-invoice-->
          <div class="totalNe-invoice" style="margin-bottom: 0px">
            <table
              style="
                max-width: 100%;
                vertical-align: middle;
                text-align: center;
              "
            >
              <thead>
                <tr>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 2px 0px;
                    "
                  >
                    م <br />
                    .No
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 2px 0px;
                    "
                  >
                    اسم الخدمة <br />
                    Item Name
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 2px 0px;
                    "
                  >
                    الوحدة <br />
                    Unit
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 2px 0px;
                    "
                  >
                    الكمية <br />
                    .Qty
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 2px 0px;
                    "
                  >
                    السعر <br />
                    Price
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 2px 0px;
                    "
                  >
                    الخصم <br />
                    Discount
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 2px 0px;
                    "
                  >
                    نسبة الخصم <br />
                    discount percent
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 2px 0px;
                    "
                  >
                    الصافي<br />
                    Net
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 2px 0px;
                    "
                  >
                    ض.ق.المضافة <br />
                    VAT
                  </th>
                  <th
                    style="
                      font-size: 14px;
                      color: #333;
                      background-color: #dceefd;
                      line-height: 1.2em;
                      padding: 2px 0px;
                    "
                  >
                    الصافي + الضريبة <br />
                    Net + VAT
                  </th>
                </tr>
              </thead>
              <tbody style="line-height: 1.2em">
                <tr
                  *ngFor="
                    let item of InvPrintData?.voucherDetailsVM_VD;
                    let i = index
                  "
                >
                  <td>{{ i + 1 }}</td>
                  <td>
                    <span style="font-size: 13px; font-weight: 700">{{
                      item.servicesPriceName
                    }}</span>
                    <ul
                      *ngFor="
                        let det of item?.servicesPricesOffer;
                        let i = index
                      "
                      style="
                        list-style: none;
                        padding: 0px;
                        margin-inline-start: 10px;
                        text-align: right;
                        margin-top: 3px;
                        line-height: 16px;
                        font-size: 12px;
                      "
                    >
                      <hr style="margin: 6px" />
                      <li>
                        <span style="font-size: 12px; font-weight: 800">-</span>
                        {{ det.name }}
                      </li>
                    </ul>
                  </td>

                  <!-- <td>{{ item.servicesPriceName }}</td> -->
                  <td>{{ item.serviceTypeName }}</td>
                  <td>{{ item.qty }}</td>
                  <td>{{ GetAccualValue(item) }}</td>
                  <td>{{ item.discountValue_Det }}</td>
                  <td>{{ item.discountPercentage_Det }}</td>
                  <td>{{ GetDiff(item) }}</td>
                  <td>{{ item.taxAmount }}</td>
                  <td>{{ item.totalAmount }}</td>
                </tr>
              </tbody>
            </table>
          </div>

          <!--totalNe-invoice-->
          <!--invoice value-->
          <div
            class="invoiceNe-value"
            style="display: block !important; margin-bottom: 3px"
          >
            <div class="invoiceNe-divided">
              <div class="invoiceNe-value-right-side">
                <p style="margin-bottom: 2px">
                  <span> الإجمالي : </span>
                  <span>{{ CustomData.Total }}</span>
                </p>
                <p style="margin-bottom: 2px">
                  <span> الخصم : </span>
                  <span>{{ CustomData.DiscPer }} % {{ CustomData.Disc }}</span>
                </p>
                <p style="margin-bottom: 2px">
                  <span> الإجمالي بعد الخصم : </span>
                  <span>{{ CustomData.TotalAfterDisc }}</span>
                </p>
                <p style="margin-bottom: 2px">
                  <span> الصافي : </span>
                  <span>{{ CustomData.netVal }}</span>
                </p>
                <p style="margin-bottom: 2px">
                  <span> ضريبة القيمة المضافة (15%) : </span>
                  <span>{{ InvPrintData?.invoicesVM_VD.taxAmount ?? 0 }}</span>
                </p>
                <p
                  style="
                    margin-bottom: 3px;
                    background-color: #dceefd;
                    padding: 1px;
                    min-width: 637px;
                    max-width: 637px;
                  "
                >
                  <span>إجمالي المبلغ المطلوب سداده: </span>
                  <span
                    >{{ InvPrintData?.invoicesVM_VD.totalValue ?? 0 }}</span>
                    <span style="margin-right: 6%;">({{ InvPrintData?.valueNumString }})</span>
                </p>
                <p
                  style="
                    margin-bottom: 3px;
                    background-color: #dceefd;
                    padding: 1dvh;
                    min-width: 637px;
                    max-width: 637px;
                  "
                >
                  <span>الملاحظات:</span>
                  <span>{{ InvPrintData?.invoicesVM_VD.notes }}</span>
                </p>
                <p
                  style="
                    margin-bottom: 3px;
                    background-color: #dceefd;
                    padding: 1px;
                    min-width: 637px;
                    max-width: 637px;
                    font-size: 15px !important;
                  "
                >
                  <span>وسائل الدفع:</span>
                  <span></span>
                </p>
              </div>
              <div class="invoiceNe-value-right-side">
                <p style="margin-bottom: 2px">
                  <span>المدفوع :</span>
                  <span>{{ InvPrintData?.invoicesVM_VD.paidValue ?? 0 }}</span>
                </p>
                <p style="margin-bottom: 2px">
                  <span>المتبقي :</span>
                  <span>{{
                    (InvPrintData?.invoicesVM_VD.totalValue ?? 0) -
                      (InvPrintData?.invoicesVM_VD.paidValue ?? 0)
                  }}</span>
                </p>
                <p
                  style="margin-top: 120%; color: red"
                  *ngIf="CustomData?.PrintType != 1"
                >
                  <span>{{ CustomData?.PrintTypeName }}</span>
                </p>
                <p style="color: red" *ngIf="CustomData?.PrintType != 1">
                  <span>{{ "رقم الإشعار : "  }}</span>
                  </p>
                  <p style="color: red" *ngIf="CustomData?.PrintType != 1">
                    <span>{{ InvPrintData?.invoicesVM_VD?.invoiceRetId }}</span>
                    </p>
              </div>
            </div>
          </div>

          <!--invoice -bank-account-->
          <!--invoiceNe-footer-->
          <div
            class="invoiceNe-footer"
            style="
              display: flex !important;
              justify-content: space-between;
              align-items: start;
            "
          >
            <div>
              <img
                *ngIf="CustomData.Account1Img"
                src="{{ CustomData.Account1Img }}"
                alt=""
                style="
                  display: block !important;
                  width: 100px;
                  height: 70px;
                  object-fit: fill;
                  margin-bottom: 5px;
                "
              />
              <img
                *ngIf="CustomData.Account2Img"
                src="{{ CustomData.Account2Img }}"
                alt=""
                style="
                  display: block !important;
                  width: 100px;
                  height: 70px;
                  object-fit: fill;
                "
              />
            </div>

            <div>
              <h4>{{ CustomData.Account1Bank }}</h4>
              <h4>{{ CustomData.Account2Bank }}</h4>
              <h4 *ngIf="InvPrintData?.invoicesVM_VD.appearUser == 1">
                {{ InvPrintData?.invoicesVM_VD.addUser }}
              </h4>
            </div>

            <div class="qrNe-code">
              <img
                #conditionimg
                src="{{ InvPrintData?.qrCodeString_VD }}"
                alt="QRCode"
                style="height: 140px; width: 180px"
              />
            </div>
          </div>

          <!--invoiceNe-footer-->
          <!--Details-->
        </div>
        <!--invoiceNe-content-->
        <div>
          <img
            *ngIf="CustomData.footerurl"
            src="{{ CustomData.footerurl }}"
            alt="footerurl"
            style="height: 60px; width: 100%; max-width: 100%; object-fit: fill"
          />
        </div>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button
      (click)="printDiv('divHtml_a')"
      class="min-w-max p-2 bg-sky-100 hover:bg-sky-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
    >
      <i class="fa fa-print"></i>
    </button>
    <button
      type="button"
      (click)="modal.dismiss()"
      mat-raised-button
      color="basic"
    >
      {{ "No" | translate }}
    </button>
  </div>
</ng-template>

<!-- --------------Add Services------------------- -->
<!-- addSerivceModal / edit -->
<ng-template #addSerivceModal let-modal>
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4 class="m-0">
      <span class="text-2xl">
        {{ "AddNewService" | translate }}
      </span>
    </h4>
    <button
      type="button"
      class="text-2xl text-white m-0"
      (click)="modal.dismiss()"
    >
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>
  <!-- modal-body -->
  <div class="modal-body">
    <form [formGroup]="SerivceModalForm" >
      <div class="row items-center">
        <div class="col-sm-6 col-md-3 mb-3" style="display: none;">
          <div class="form-group">
            <label class="col-form-label">
              {{ "Project Type" | translate }}</label
            >
            <span class="text-danger">*</span>
            <ng-select
              name="Project Type"
              class="w-full p-0"
              placeholder="{{ 'Chose' | translate }}" autocomplete="off"
              formControlName="ProjectType"
              (change)="ChangeProjectType()"
            >
              <ng-option *ngFor="let user of ProjectTypeList" [value]="user.id">{{
                user.name
              }}</ng-option>
            </ng-select>
            <div class="fieldrequired" *ngIf="
                      SerivceModalForm.controls['ProjectType']?.hasError('required') &&
                      SerivceModalForm.controls['ProjectType'].touched
                    ">
                    {{ "This field is required" | translate }}
                  </div>
          </div>
        </div>

        <div class="col-sm-6 col-md-3 mb-3" style="display: none;">
          <button
            type="button"

            class="btn btn-success  mt-5 mb-2"
            (click)="open(NewProjectType , null , 'NewProjectType')"
            >
            {{ "AddNewProjectType" | translate }}
            <i class="fa-solid fa-plus"></i>
          </button>
        </div>

        <div class="col-sm-6 col-md-3 mb-3" style="display: none;">
          <div class="form-group">
            <label class="col-form-label">
              {{ "Subproject type" | translate }}</label
            >
            <span class="text-danger">*</span>
            <ng-select
              name="Subproject type"
              class="w-full p-0"
              placeholder="{{ 'Chose' | translate }}"
              formControlName="SubprojectType" autocomplete="off"
            >

              <ng-option *ngFor="let user of SubprojecttypeList" [value]="user.id">{{
                user.name
              }}</ng-option>
            </ng-select>
            <div class="fieldrequired" *ngIf="
                      SerivceModalForm.controls['SubprojectType']?.hasError('required') &&
                      SerivceModalForm.controls['SubprojectType'].touched
                    ">
                    {{ "This field is required" | translate }}
                  </div>
          </div>
        </div>

        <div class="col-sm-6 col-md-3 mb-3" style="display: none;">
          <button
            type="button"

            class="btn btn-success  mt-5 mb-2"
            (click)="open(SubprojectTypeModal , null , 'SubprojectTypeModal')"
            >
            {{ "AddNewSubgenre" | translate }}
            <i class="fa-solid fa-plus"></i>
          </button>
        </div>
        <div class="col-sm-6 col-md-3 mb-3" *ngIf="this.SerivceModalForm.controls['ProjectType'].value == 1">
          <div class="form-group">
            <label class="col-form-label">
              {{ "Packages" | translate }}</label
            >
            <ng-select
              name="Packages"
              class="w-full p-0"
              placeholder="{{ 'Chose' | translate }}"
              formControlName="PackageId" autocomplete="off"
            >

              <ng-option *ngFor="let user of packageList" [value]="user.id">{{
                user.name
              }}</ng-option>
            </ng-select>
            <!-- <div class="fieldrequired" *ngIf="
                      SerivceModalForm.controls['PackageId']?.hasError('required') &&
                      SerivceModalForm.controls['PackageId'].touched
                    ">
                    {{ "This field is required" | translate }}
                  </div> -->
          </div>
        </div>

        <div class="col-sm-6 col-md-3 mb-3" style="display: none;">
          <button
            type="button"

            class="btn btn-success  mt-5 mb-2"
            (click)="open(PackagesModal , null , 'PackagesModal')"
            >
            {{ "AddNewPackages" | translate }}
            <i class="fa-solid fa-plus"></i>
          </button>
        </div>
        <!-- 2 -->
        <div class="col-sm-6 col-md-3 mb-3">
          <div class="form-group">
            <label class="col-form-label">
              {{ "ServiceName" | translate }}</label
            >
            <span class="text-danger">*</span>
            <input
              name="ServiceName"
              placeholder="{{ 'ServiceName' | translate }}"
              type="text"
              class="form-control"
              formControlName="ServiceName" autocomplete="off"
            />
            <div class="fieldrequired" *ngIf="
                      SerivceModalForm.controls['ServiceName']?.hasError('required') &&
                      SerivceModalForm.controls['ServiceName'].touched
                    ">
                    {{ "This field is required" | translate }}
                  </div>
          </div>
        </div>

        <div class="col-sm-6 col-md-3 mb-3">
          <div class="form-group">
            <label class="col-form-label">
              {{ "ServiceNameEN" | translate }}</label
            >
            <span class="text-danger">*</span>
            <input
              name="ServiceNameEN"
              placeholder="{{ 'ServiceNameEN' | translate }}"
              type="text"
              class="form-control"
              formControlName="ServiceNameEN" autocomplete="off"
            />
            <div class="fieldrequired" *ngIf="
                      SerivceModalForm.controls['ServiceNameEN']?.hasError('required') &&
                      SerivceModalForm.controls['ServiceNameEN'].touched
                    ">
                    {{ "This field is required" | translate }}
                  </div>
          </div>
        </div>

        <div class="col-sm-6 col-md-2 mb-3" >
          <div class="form-group">
            <label class="col-form-label">
              {{ "ServiceType" | translate }}</label
            >
            <span class="text-danger">*</span>
            <div class="flex">
              <ng-select
              name="ServiceType"
              class="w-full p-0"
              placeholder="{{ 'Chose' | translate }}" autocomplete="off"
              formControlName="ServiceType"
            >
              <ng-option *ngFor="let user of ServiceType" [value]="user.id">{{
                user.name
              }}</ng-option>
            </ng-select>
            <button
            type="button"
            class="btn bg-base text-white"
            style="padding: 5px 10px"
            (click)="open(ServiceTypeModal)"
            >
            <i class="fa fa-plus"></i>
           </button>
            <div class="fieldrequired" *ngIf="
                      SerivceModalForm.controls['ServiceType']?.hasError('required') &&
                      SerivceModalForm.controls['ServiceType'].touched
                    ">
                    {{ "This field is required" | translate }}
           </div>
            </div>
          </div>
        </div>

        <div class="col-sm-1 col-md-1 mb-3" >

        </div>

        <div class="col-sm-6 col-md-3 mb-3" *ngIf="SerivceModalForm.controls['PackageId'].value ==  null">
          <div class="form-group">
            <label class="col-form-label"> {{ "PriceRev" | translate }}</label>
            <span class="text-danger">*</span>
            <div class="d-flex">
              <input
                name="price"
                placeholder="{{ 'PriceRev' | translate }}"
                type="text"
                class="form-control" autocomplete="off"
                formControlName="amount"
              />
              <SPAN class="me-1"> {{ "RS" | translate }}</SPAN>
            </div>
            <div class="fieldrequired" *ngIf="
                      SerivceModalForm.controls['amount']?.hasError('required') &&
                      SerivceModalForm.controls['amount'].touched
                    ">
                    {{ "This field is required" | translate }}
                  </div>
          </div>
        </div>

        <!-- 3 -->
        <div class="col-sm-6 col-md-3 mb-3" style="display: none;">
          <div class="form-group">
            <label class="col-form-label">
              {{ "costCenter" | translate }}</label
            >
            <ng-select
              name="costCenter"
              class="w-full p-0"
              placeholder="{{ 'Chose' | translate }}"
              formControlName="costCenter" autocomplete="off"
            >
              <ng-option *ngFor="let user of CostCenterSelectlist" [value]="user.id">{{
                user.name
              }}</ng-option>
            </ng-select>
          </div>
        </div>
        <div class="col-sm-6 col-md-3 mb-3">
          <div class="form-group">
            <label class="col-form-label">
              {{ "AddServiceDetails" | translate }}</label
            >
          <button
            type="button"

            class="btn btn-outline-success "
            (click)="open(costCenterModal ,null , 'costCenterModal')"
            >
            {{ "AddServiceDetails" | translate }}
            <i class="fa-solid fa-plus"></i>
          </button>
        </div>
      </div>

        <div class="col-sm-6 col-md-3 mb-3">
          <div class="form-group">
            <label class="col-form-label">
              {{ "ServiceRevenueAccount" | translate }}</label
            >
            <span class="text-danger">*</span>
            <ng-select
              name="ServiceRevenueAccount"
              class="w-full p-0"
              placeholder="{{ 'Chose' | translate }}" autocomplete="off"
              formControlName="ServiceRevenueAccount"
            >
              <ng-option *ngFor="let user of ServiceAccountlist" [value]="user.id">{{
                user.name
              }}</ng-option>
            </ng-select>
            <div class="fieldrequired" *ngIf="
                      SerivceModalForm.controls['ServiceRevenueAccount']?.hasError('required') &&
                      SerivceModalForm.controls['ServiceRevenueAccount'].touched
                    ">
                    {{ "This field is required" | translate }}
                  </div>
          </div>
        </div>

        <div class="col-sm-6 col-md-3 mb-3" *ngIf="SerivceModalForm.controls['PackageId'].value ==  null">
          <div class="form-group">
            <label class="col-form-label"> {{ "PricePur" | translate }}</label>
            <span class="text-danger">*</span>
            <div class="d-flex">
              <input
                name="AmountPur"
                placeholder="{{ 'PricePur' | translate }}"
                type="text"
                class="form-control" autocomplete="off"
                formControlName="AmountPur"
              />
              <SPAN class="me-1"> {{ "RS" | translate }}</SPAN>
            </div>
            <div class="fieldrequired" *ngIf="
                      SerivceModalForm.controls['AmountPur']?.hasError('required') &&
                      SerivceModalForm.controls['AmountPur'].touched
                    ">
                    {{ "This field is required" | translate }}
                  </div>
          </div>
        </div>

        <div class="col-sm-6 col-md-3 mb-3">
          <div class="form-group">
            <label class="col-form-label">
              {{ "ServicePurAccount" | translate }}</label
            >
            <span class="text-danger">*</span>
            <ng-select
              name="AccountIdPur"
              class="w-full p-0"
              placeholder="{{ 'Chose' | translate }}" autocomplete="off"
              formControlName="AccountIdPur"
            >
              <ng-option *ngFor="let user of ServiceAccountPurlist" [value]="user.id">{{
                user.name
              }}</ng-option>
            </ng-select>
            <div class="fieldrequired" *ngIf="
                      SerivceModalForm.controls['AccountIdPur']?.hasError('required') &&
                      SerivceModalForm.controls['AccountIdPur'].touched
                    ">
                    {{ "This field is required" | translate }}
                  </div>
          </div>
        </div>

        <div class="col-sm-6 col-md-3 mb-3">
          <div class="form-group">
            <label class="col-form-label">
              {{ "Beginningbalance" | translate }}</label
            >
            <span class="text-danger">*</span>
            <input
              name="Begbalance"
              placeholder="{{ 'Beginningbalance' | translate }}"
              type="text"
              class="form-control"
              formControlName="Begbalance" autocomplete="off"
            />
            <div class="fieldrequired" *ngIf="
                      SerivceModalForm.controls['Begbalance']?.hasError('required') &&
                      SerivceModalForm.controls['Begbalance'].touched
                    ">
                    {{ "This field is required" | translate }}
                  </div>
          </div>
        </div>

        <div class="col-sm-6 col-md-3 mb-3">
          <div class="form-group">
            <label class="col-form-label">
              {{ "SerialNumber" | translate }}</label
            >
            <span class="text-danger">*</span>
            <input
              name="SerialNumber"
              placeholder="{{ 'SerialNumber' | translate }}"
              type="text"
              class="form-control"
              formControlName="SerialNumber" autocomplete="off"
            />
            <div class="fieldrequired" *ngIf="
                      SerivceModalForm.controls['SerialNumber']?.hasError('required') &&
                      SerivceModalForm.controls['SerialNumber'].touched
                    ">
                    {{ "This field is required" | translate }}
                  </div>
          </div>
        </div>

        <div class="col-sm-6 col-md-3 mb-3">
          <div class="form-group">
            <label class="col-form-label">
              {{ "ItemCode" | translate }}</label
            >
            <span class="text-danger">*</span>
            <input
              name="ItemCode"
              placeholder="{{ 'ItemCode' | translate }}"
              type="text"
              class="form-control"
              formControlName="ItemCode" autocomplete="off"
            />
            <div class="fieldrequired" *ngIf="
                      SerivceModalForm.controls['ItemCode']?.hasError('required') &&
                      SerivceModalForm.controls['ItemCode'].touched
                    ">
                    {{ "This field is required" | translate }}
                  </div>
          </div>
        </div>

        <div class="col-sm-6 col-md-2 mb-3">
          <div class="form-group">
            <label for="StorehouseId" class="text-right col-form-label block">
              {{ "Storehouse" | translate }}</label
            >
            <div class="flex">
              <ng-select
              class="w-full p-0"
              placeholder="{{ 'Chose' | translate }}"
              formControlName="storehouseId"
              name="storehouseId"
              >
                <ng-option *ngFor="let user of Storehouse" [value]="user.id">{{
                  user.name
                }}</ng-option>
              </ng-select>
              <button
                type="button"
                class="btn bg-base text-white"
                style="padding: 5px 10px"
                (click)="open(StorehouseModal)"
              >
                <i class="fa fa-plus"></i>
              </button>
            </div>
          </div>
        </div>


      </div>
    </form>
    <p class="w-fit bg-red-100 text-danger mx-auto my-3 p-1">
      {{ "AttentionAddService" | translate }}
    </p>
    <div
      class="flex gap-2 justify-end pt-3 border-t border-neutral-300 col-span-1 md:col-span-2 mt-2"
    >
    <button class="btn bg-base text-white" type="submit"(click)="SaveServicePriceWithDetails(modal)"   [disabled]='
    this.SerivceModalForm.controls["ServiceName"].value ==null|| this.SerivceModalForm.controls["ServiceName"].value ==""||
    this.SerivceModalForm.controls["ServiceNameEN"].value ==null|| this.SerivceModalForm.controls["ServiceNameEN"].value ==""||
    this.SerivceModalForm.controls["AmountPur"].value ==null|| this.SerivceModalForm.controls["AmountPur"].value ==""||
    this.SerivceModalForm.controls["amount"].value ==null|| this.SerivceModalForm.controls["amount"].value ==""||
    this.SerivceModalForm.controls["ServiceRevenueAccount"].value ==null || 
    this.SerivceModalForm.controls["ItemCode"].value ==null || this.SerivceModalForm.controls["ItemCode"].value ==""||
    this.SerivceModalForm.controls["AccountIdPur"].value ==null'>
        {{ "Save" | translate }}
      </button>
      <button (click)="modal?.dismiss()" class="btn btn-secondary">
        {{ "close" | translate }}
      </button>
    </div>
  </div>
</ng-template>

<!-- NewProjectType -->
<ng-template #NewProjectType let-modal>
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4 class="m-0">
      <span class="text-2xl">
        <span>{{ "NewProjectType" | translate }}</span>
        <!-- <span *ngIf="modalDetails?.type == 'newSub'">{{ "NewSubprojectType" | translate }}</span>
        <span *ngIf="modalDetails?.type == 'ServiceDetails'">{{ "Add New Item" | translate }}</span> -->
      </span>
    </h4>
    <button
      type="button"
      class="text-2xl text-white m-0"
      (click)="modal.dismiss()"
    >
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>
  <div class="modal-body max-h-100 overflow-x-scroll overflow-y-scroll p-4">
    <form class="" #smsForm="ngForm">
      <div class="row align-items-end mb-4 mx-3">
        <!-- 1 line -->

        <div class="col-sm-6 col-md-3 col-lg-6 mb-0 mb-sm-3">
          <div class="form-group">
            <label for="nameAr" class="text-right col-form-label block">
              {{ "nameAr" | translate }}
              <span class="text-danger">*</span>
            </label>
            <input
              required
              class="form-control"
              autocomplete="off"
              [placeholder]="
                ('Write' | translate) + ' ' + ('nameAr' | translate)
              "
              [(ngModel)]="ProjectTypenameAr"
              type="text"
              [ngModelOptions]="{ standalone: true }"
            />
          </div>
        </div>
        <div class="col-sm-6 col-md-3 col-lg-6 mb-0 mb-sm-3">
          <div class="form-group">
            <label class="text-right col-form-label block">
              {{ "nameEn" | translate }}
              <span class="text-danger">*</span></label
            >
            <input
              class="form-control"
              [(ngModel)]="ProjectTypenameEn"
              autocomplete="off"
              type="text"
              [ngModelOptions]="{ standalone: true }"
              [placeholder]="
                ('Write' | translate) + ' ' + ('nameEn' | translate)
              "
            />
          </div>
        </div>

        <div class="col-sm-6 col-md-3 col-lg-12 mb-0 mb-sm-3 text-center">
          <button
            type="button"
            (click)="SaveProjectType()"
            [disabled]="ProjectTypenameEn == null || ProjectTypenameAr == null"
            class="flex gap-1 btn text-white mb-3 col-md-2 me-3"
            style="background-color: var(--base-color)"
          >
            {{ "save" | translate }}
          </button>

          <button
            type="button"
            (click)="modal.dismiss()"
            class="flex gap-1 btn btn-secondary mb-3 col-md-2"
          >
            {{ "close" | translate }}
          </button>
        </div>

        <div class="col-sm-6 col-md-3 col-lg-12 mb-0 mb-sm-3 text-center">
          <input
            name="dateCheck_transfer"
            (keyup)="applyFilterProjectType($event)"
            placeholder="{{ 'search' | translate }}"
            type="text"
            class="form-control"
          />
        </div>
      </div>

      <div class="editable shadow mb-4">
        <table
          class="table table-responsive table-striped table-bordered text-center"
          style="vertical-align: middle; font-size: 14px"
        >
          <thead
            class="bg-base text-white"
            style="line-height: 30px; font-size: 13px"
          >
            <tr>
              <th>{{ "nameAr" | translate }}</th>
              <th>{{ "nameEn" | translate }}</th>
              <th>{{ "operations" | translate }}</th>
              <!-- <th   *ngIf="modalDetails?.type == 'newSub'" >{{ "ApproximatePeriod" | translate }}</th> -->
            </tr>
          </thead>
          <tbody>
            <tr
              *ngFor="let item of AllProjectTypelist; let i = index"
              style="line-height: 5px"
            >
              <td>{{ item.nameAr }}</td>
              <td>{{ item.nameEn }}</td>
              <td>
                <button
                  (click)="updateProjectType(item)"
                  class="p-2 bg-orange-100 hover:bg-orange-500 rounded-lg duration-300 hover:text-white w-10"
                >
                  <i class="fa-regular fa-pen-to-square"></i>
                </button>

                <button
                  class="p-2 bg-red-100 hover:bg-red-500 rounded-lg duration-300 hover:text-white w-10 me-3"
                  (click)="
                    open(deleteProjectTypeModal, item, 'deleteProjectTypeModal')
                  "
                >
                  <i class="fa-solid fa-trash-can"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </form>
  </div>
</ng-template>

<!-- deleteProjectTypeModal -->
<ng-template #deleteProjectTypeModal let-modal>
  <div class="modal-body text-center">
    <p
      [translate]="'name'"
      [translateParams]="{
        ar: 'هل تريد حذف هذا العنصر ؟',
        en: 'Do you want to delete this item?'
      }"
    ></p>
    <div class="flex gap-2 justify-center">
      <button
        type="button"
        (click)="modal.dismiss()"
        mat-raised-button
        color="basic"
      >
        {{ "close" | translate }}
      </button>

      <button
        type="button"
        mat-raised-button
        color="warn"
        (click)="DeleteProjectType(modal)"
      >
        {{ "confirem" | translate }}
      </button>
    </div>
  </div>
</ng-template>

<!-- SubprojectTypeModal -->
<ng-template #SubprojectTypeModal let-modal>
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4 class="m-0">
      <span class="text-2xl">
        <span>{{ "NewSubprojectType" | translate }}</span>
        <!--  <span *ngIf="modalDetails?.type == 'ServiceDetails'">{{ "Add New Item" | translate }}</span> -->
      </span>
    </h4>
    <button
      type="button"
      class="text-2xl text-white m-0"
      (click)="modal.dismiss()"
    >
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>
  <div class="modal-body max-h-100 overflow-x-scroll overflow-y-scroll p-4">
    <form class="" #smsForm="ngForm">
      <div class="row align-items-end mb-4 mx-3">
        <!-- 1 line -->

        <div class="col-sm-6 col-md-3 col-lg-6 mb-0 mb-sm-3">
          <div class="form-group">
            <label for="nameAr" class="text-right col-form-label block">
              {{ "nameAr" | translate }}
              <span class="text-danger">*</span>
            </label>
            <input
              required
              class="form-control"
              autocomplete="off"
              [placeholder]="
                ('Write' | translate) + ' ' + ('nameAr' | translate)
              "
              [(ngModel)]="SubprojectTypenameAr"
              type="text"
              [ngModelOptions]="{ standalone: true }"
            />
          </div>
        </div>

        <div class="col-sm-6 col-md-3 col-lg-6 mb-0 mb-sm-3">
          <div class="form-group">
            <label class="text-right col-form-label block">
              {{ "nameEn" | translate }}
              <span class="text-danger">*</span></label
            >
            <input
              class="form-control"
              [(ngModel)]="SubprojectTypenameEn"
              autocomplete="off"
              type="text"
              [ngModelOptions]="{ standalone: true }"
              [placeholder]="
                ('Write' | translate) + ' ' + ('nameEn' | translate)
              "
            />
          </div>
        </div>
        <div class="col-sm-6 col-md-3 col-lg-6 mb-0 mb-sm-3">
          <div class="form-group">
            <label class="text-right col-form-label block">
              {{ "TimePeriodStr" | translate }}</label
            >
            <input
              class="form-control"
              [(ngModel)]="TimePeriodStr"
              autocomplete="off"
              type="text"
              [ngModelOptions]="{ standalone: true }"
              [placeholder]="
                ('Write' | translate) + ' ' + ('TimePeriodStr' | translate)
              "
            />
          </div>
        </div>

        <div class="col-sm-6 col-md-3 col-lg-12 mb-0 mb-sm-3 text-center">
          <button
            type="button"
            (click)="SaveSubprojectType()"
            [disabled]="
              SubprojectTypenameAr == null || SubprojectTypenameEn == null
            "
            class="flex gap-1 btn text-white mb-3 col-md-2 me-3"
            style="background-color: var(--base-color)"
          >
            {{ "save" | translate }}
          </button>

          <button
            type="button"
            (click)="modal.dismiss()"
            class="flex gap-1 btn btn-secondary mb-3 col-md-2"
          >
            {{ "close" | translate }}
          </button>
        </div>

        <div class="col-sm-6 col-md-3 col-lg-12 mb-0 mb-sm-3 text-center">
          <input
            name="dateCheck_transfer"
            (keyup)="applyFilterSubsByProjectTypeId($event)"
            placeholder="{{ 'search' | translate }}"
            type="text"
            class="form-control"
          />
        </div>
      </div>

      <div class="editable shadow mb-4">
        <table
          class="table table-responsive table-striped table-bordered text-center"
          style="vertical-align: middle; font-size: 14px"
        >
          <thead
            class="bg-base text-white"
            style="line-height: 30px; font-size: 13px"
          >
            <tr>
              <th>{{ "nameAr" | translate }}</th>
              <th>{{ "nameEn" | translate }}</th>
              <th>{{ "TimePeriodStr" | translate }}</th>
              <th>{{ "operations" | translate }}</th>
              <!-- <th   *ngIf="modalDetails?.type == 'newSub'" >{{ "ApproximatePeriod" | translate }}</th> -->
            </tr>
          </thead>
          <tbody>
            <tr
              *ngFor="
                let item of AllProjectSubsByProjectTypelist;
                let i = index
              "
              style="line-height: 5px"
            >
              <td>{{ item.nameAr }}</td>
              <td>{{ item.nameEn }}</td>
              <td>
                {{ item.timePeriodStr }}
              </td>
              <td>
                <button
                  (click)="updateSubprojectType(item)"
                  class="p-2 bg-orange-100 hover:bg-orange-500 rounded-lg duration-300 hover:text-white w-10"
                >
                  <i class="fa-regular fa-pen-to-square"></i>
                </button>

                <button
                  class="p-2 bg-red-100 hover:bg-red-500 rounded-lg duration-300 hover:text-white w-10 me-3"
                  (click)="
                    open(
                      deleteSubprojectTypeModal,
                      item,
                      'deleteSubprojectTypeModal'
                    )
                  "
                >
                  <i class="fa-solid fa-trash-can"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </form>
  </div>

  <!-- <div class="flex justify-end p-3">
    <button
      (click)="modal?.dismiss()"
      class="btn text-white"
      style="background-color: var(--base-color)"
    >
      {{ "save" | translate }}
    </button>

    <button class="btn me-2 btn-secondary">
      {{ "close" | translate }}
    </button>
  </div> -->
</ng-template>
<!-- deleteSubprojectTypeModal -->
<ng-template #deleteSubprojectTypeModal let-modal>
  <div class="modal-body text-center">
    <p
      [translate]="'name'"
      [translateParams]="{
        ar: 'هل تريد حذف هذا العنصر ؟',
        en: 'Do you want to delete this item?'
      }"
    ></p>
    <div class="flex gap-2 justify-center">
      <button
        type="button"
        (click)="modal.dismiss()"
        mat-raised-button
        color="basic"
      >
        {{ "close" | translate }}
      </button>

      <button
        type="button"
        mat-raised-button
        color="warn"
        (click)="DeleteProjectSubTypes(modal)"
      >
        {{ "confirem" | translate }}
      </button>
    </div>
  </div>
</ng-template>

<!-- PackagesModal -->
<ng-template #PackagesModal let-modal>
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4 class="m-0">
      <span class="text-2xl">
        <span>{{ "Packages" | translate }}</span>
      </span>
    </h4>
    <button
      type="button"
      class="text-2xl text-white m-0"
      (click)="modal.dismiss()"
    >
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>
  <div class="modal-body max-h-100 overflow-x-scroll overflow-y-scroll p-4">
    <form class="" #smsForm="ngForm">
      <div class="row align-items-end mb-4 mx-3">
        <!-- 1 line -->

        <div class="col-sm-6 col-md-3 col-lg-6 mb-0 mb-sm-3">
          <div class="form-group">
            <label for="nameAr" class="text-right col-form-label block">
              {{ "PackageName" | translate }}
              <span class="text-danger">*</span>
            </label>
            <input
              required
              class="form-control"
              autocomplete="off"
              [placeholder]="
                ('Write' | translate) + ' ' + ('PackageName' | translate)
              "
              [(ngModel)]="PackageName"
              type="text"
              [ngModelOptions]="{ standalone: true }"
            />
          </div>
        </div>

        <div class="col-sm-6 col-md-3 col-lg-6 mb-0 mb-sm-3">
          <div class="form-group">
            <label class="text-right col-form-label block">
              {{ "MeterPrice1" | translate }}
              <span class="text-danger">*</span></label
            >
            <input
              class="form-control"
              [(ngModel)]="MeterPrice1"
              autocomplete="off"
              type="text"
              [ngModelOptions]="{ standalone: true }"
              [placeholder]="
                ('Write' | translate) + ' ' + ('MeterPrice1' | translate)
              "
            />
          </div>
        </div>
        <div class="col-sm-6 col-md-3 col-lg-6 mb-0 mb-sm-3">
          <div class="form-group">
            <label class="text-right col-form-label block">
              {{ "MeterPrice2" | translate }}</label
            >
            <input
              class="form-control"
              [(ngModel)]="MeterPrice2"
              autocomplete="off"
              type="text"
              [ngModelOptions]="{ standalone: true }"
              [placeholder]="
                ('Write' | translate) + ' ' + ('MeterPrice2' | translate)
              "
            />
          </div>
        </div>
        <div class="col-sm-6 col-md-3 col-lg-6 mb-0 mb-sm-3">
          <div class="form-group">
            <label class="text-right col-form-label block">
              {{ "MeterPrice3" | translate }}</label
            >
            <input
              class="form-control"
              [(ngModel)]="MeterPrice3"
              autocomplete="off"
              type="text"
              [ngModelOptions]="{ standalone: true }"
              [placeholder]="
                ('Write' | translate) + ' ' + ('MeterPrice3' | translate)
              "
            />
          </div>
        </div>
        <div class="col-sm-6 col-md-3 col-lg-6 mb-0 mb-sm-3">
          <div class="form-group">
            <label class="text-right col-form-label block">
              {{ "PackageRatio1" | translate }}</label
            >
            <input
              class="form-control"
              [(ngModel)]="PackageRatio1"
              autocomplete="off"
              type="text"
              [ngModelOptions]="{ standalone: true }"
              [placeholder]="
                ('Write' | translate) + ' ' + ('PackageRatio1' | translate)
              "
            />
          </div>
        </div>
        <div class="col-sm-6 col-md-3 col-lg-6 mb-0 mb-sm-3">
          <div class="form-group">
            <label class="text-right col-form-label block">
              {{ "PackageRatio2" | translate }}</label
            >
            <input
              class="form-control"
              [(ngModel)]="PackageRatio2"
              autocomplete="off"
              type="text"
              [ngModelOptions]="{ standalone: true }"
              [placeholder]="
                ('Write' | translate) + ' ' + ('PackageRatio2' | translate)
              "
            />
          </div>
        </div>
        <div class="col-sm-6 col-md-3 col-lg-6 mb-0 mb-sm-3">
          <div class="form-group">
            <label class="text-right col-form-label block">
              {{ "PackageRatio3" | translate }}</label
            >
            <input
              class="form-control"
              [(ngModel)]="PackageRatio3"
              autocomplete="off"
              type="text"
              [ngModelOptions]="{ standalone: true }"
              [placeholder]="
                ('Write' | translate) + ' ' + ('PackageRatio3' | translate)
              "
            />
          </div>
        </div>
        <div class="col-sm-6 col-md-3 col-lg-12 mb-0 mb-sm-3 text-center">
          <button
            type="button"
            (click)="SavePackages()"
            [disabled]="
              PackageRatio3 == null ||
              PackageRatio2 == null ||
              PackageRatio1 == null ||
              MeterPrice3 == null ||
              MeterPrice2 == null ||
              MeterPrice1 == null ||
              PackageName == null
            "
            class="flex gap-1 btn text-white mb-3 col-md-2 me-3"
            style="background-color: var(--base-color)"
          >
            {{ "save" | translate }}
          </button>

          <button
            type="button"
            (click)="modal.dismiss()"
            class="flex gap-1 btn btn-secondary mb-3 col-md-2"
          >
            {{ "close" | translate }}
          </button>
        </div>

        <div class="col-sm-6 col-md-3 col-lg-12 mb-0 mb-sm-3 text-center">
          <input
            name="dateCheck_transfer"
            (keyup)="applyFilterPackages($event)"
            placeholder="{{ 'search' | translate }}"
            type="text"
            class="form-control"
          />
        </div>
      </div>

      <div class="editable shadow mb-4">
        <table
          class="table table-responsive table-striped table-bordered text-center"
          style="vertical-align: middle; font-size: 14px"
        >
          <thead
            class="bg-base text-white"
            style="line-height: 30px; font-size: 13px"
          >
            <tr>
              <th>{{ "PackageName" | translate }}</th>
              <th>{{ "operations" | translate }}</th>
              <!-- <th   *ngIf="modalDetails?.type == 'newSub'" >{{ "ApproximatePeriod" | translate }}</th> -->
            </tr>
          </thead>
          <tbody>
            <tr
              *ngFor="let item of AllPackageslist; let i = index"
              style="line-height: 5px"
            >
              <td>{{ item.packageName }}</td>
              <td>
                <button
                  (click)="updatePackages(item)"
                  class="p-2 bg-orange-100 hover:bg-orange-500 rounded-lg duration-300 hover:text-white w-10"
                >
                  <i class="fa-regular fa-pen-to-square"></i>
                </button>

                <button
                  class="p-2 bg-red-100 hover:bg-red-500 rounded-lg duration-300 hover:text-white w-10 me-3"
                  (click)="
                    open(deletePackagesModal, item, 'deletePackagesModal')
                  "
                >
                  <i class="fa-solid fa-trash-can"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </form>
  </div>

  <!-- <div class="flex justify-end p-3">
    <button
      (click)="modal?.dismiss()"
      class="btn text-white"
      style="background-color: var(--base-color)"
    >
      {{ "save" | translate }}
    </button>

    <button class="btn me-2 btn-secondary">
      {{ "close" | translate }}
    </button>
  </div> -->
</ng-template>
<!-- deletePackagesModal -->
<ng-template #deletePackagesModal let-modal>
  <div class="modal-body text-center">
    <p
      [translate]="'name'"
      [translateParams]="{
        ar: 'هل تريد حذف هذا العنصر ؟',
        en: 'Do you want to delete this item?'
      }"
    ></p>
    <div class="flex gap-2 justify-center">
      <button
        type="button"
        (click)="modal.dismiss()"
        mat-raised-button
        color="basic"
      >
        {{ "close" | translate }}
      </button>

      <button
        type="button"
        mat-raised-button
        color="warn"
        (click)="DeletePackages(modal)"
      >
        {{ "confirem" | translate }}
      </button>
    </div>
  </div>
</ng-template>

<!-- costCenterModal -->
<ng-template #costCenterModal let-modal>
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4 class="m-0">
      <span class="text-2xl">
        <span>{{ "AddServiceDetails" | translate }}</span>
      </span>
    </h4>
    <button
      type="button"
      class="text-2xl text-white m-0"
      (click)="modal.dismiss()"
    >
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>
  <div class="modal-body max-h-100 overflow-x-scroll overflow-y-scroll p-4">
    <form class="" #smsForm="ngForm">
      <div class="row align-items-end mb-4 mx-3">
        <!-- 1 line -->

        <div class="col-sm-6 col-md-3 col-lg-6 mb-0 mb-sm-3">
          <div class="form-group">
            <label for="nameAr" class="text-right col-form-label block">
              {{ "nameAr" | translate }}
              <span class="text-danger">*</span>
            </label>
            <input
              required
              class="form-control"
              autocomplete="off"
              [placeholder]="
                ('Write' | translate) + ' ' + ('nameAr' | translate)
              "
              [(ngModel)]="servicesName"
              type="text"
              [ngModelOptions]="{ standalone: true }"
            />
          </div>
        </div>
        <div class="col-sm-6 col-md-3 col-lg-6 mb-0 mb-sm-3">
          <div class="form-group">
            <label class="text-right col-form-label block">
              {{ "nameEn" | translate }}
              <span class="text-danger">*</span></label
            >
            <input
              class="form-control"
              [(ngModel)]="accountName"
              autocomplete="off"
              type="text"
              [ngModelOptions]="{ standalone: true }"
              [placeholder]="
                ('Write' | translate) + ' ' + ('nameEn' | translate)
              "
            />
          </div>
        </div>

        <div class="col-sm-6 col-md-3 col-lg-12 mb-0 mb-sm-3 text-center">
          <button
            type="button"
            (click)="SavecostCenter()"
            [disabled]="accountName == null || servicesName == null"
            class="flex gap-1 btn text-white mb-3 col-md-2 me-3"
            style="background-color: var(--base-color)"
          >
            {{ "add" | translate }}
          </button>

          <button
            type="button"
            (click)="modal.dismiss()"
            class="flex gap-1 btn btn-secondary mb-3 col-md-2"
          >
            {{ "close" | translate }}
          </button>
        </div>

        <!-- <div class="col-sm-6 col-md-3 col-lg-12 mb-0 mb-sm-3 text-center">
          <input
            name="dateCheck_transfer"(keyup)="applyFiltercostCenter($event)"
            placeholder="{{ 'search' | translate }}"
            type="text"
            class="form-control"
          />
        </div> -->
      </div>

      <div class="editable shadow mb-4">
        <table
          class="table table-responsive table-striped table-bordered text-center"
          style="vertical-align: middle; font-size: 14px"
        >
          <thead
            class="bg-base text-white"
            style="line-height: 30px; font-size: 13px"
          >
            <tr>
              <th>{{ "nameAr" | translate }}</th>
              <th>{{ "nameEn" | translate }}</th>
              <th>{{ "operations" | translate }}</th>
              <!-- <th   *ngIf="modalDetails?.type == 'newSub'" >{{ "ApproximatePeriod" | translate }}</th> -->
            </tr>
          </thead>
          <tbody>
            <tr
              *ngFor="let item of AllcostCenterlist; let i = index"
              style="line-height: 5px"
            >
              <td>{{ item.servicesName }}</td>
              <td>{{ item.accountName }}</td>
              <td>
                <button
                  (click)="updatecostCenter(item)"
                  class="p-2 bg-orange-100 hover:bg-orange-500 rounded-lg duration-300 hover:text-white w-10"
                >
                  <i class="fa-regular fa-pen-to-square"></i>
                </button>

                <button
                  class="p-2 bg-red-100 hover:bg-red-500 rounded-lg duration-300 hover:text-white w-10 me-3"
                  (click)="
                    open(
                      deletecostCenterModal,
                      item,
                      'deletecostCenterModal',
                      i
                    )
                  "
                >
                  <i class="fa-solid fa-trash-can"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </form>
  </div>

  <!-- <div class="flex justify-end p-3">
    <button
      (click)="modal?.dismiss()"
      class="btn text-white"
      style="background-color: var(--base-color)"
    >
      {{ "save" | translate }}
    </button>

    <button class="btn me-2 btn-secondary">
      {{ "close" | translate }}
    </button>
  </div> -->
</ng-template>
<!-- deletecostCenterModal -->
<ng-template #deletecostCenterModal let-modal>
  <div class="modal-body text-center">
    <p
      [translate]="'name'"
      [translateParams]="{
        ar: 'هل تريد حذف هذا العنصر ؟',
        en: 'Do you want to delete this item?'
      }"
    ></p>
    <div class="flex gap-2 justify-center">
      <button
        type="button"
        (click)="modal.dismiss()"
        mat-raised-button
        color="basic"
      >
        {{ "close" | translate }}
      </button>

      <button
        type="button"
        mat-raised-button
        color="warn"
        (click)="DeleteService(modal)"
      >
        {{ "confirem" | translate }}
      </button>
    </div>
  </div>
</ng-template>

<!-- سند قبض بدون عميل  -->
<!-- ReceiptVoucherwithoutCustomerModal  -->
<ng-template #ReceiptVoucherwithoutCustomerModal let-modal>
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4 class="m-0">
      <span class="text-2xl" *ngIf="CustCheckPage == 'noCustomer'">{{
        "ReceiptVoucherwithoutCustomer" | translate
      }}</span>
      <span class="text-2xl" *ngIf="CustCheckPage == 'withCustomer'">{{
        "A voucher for a future bill" | translate
      }}</span>
    </h4>
    <button
      type="button"
      class="text-2xl text-white m-0"
      (click)="modal?.dismiss()"
    >
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>

  <div class="modal-body">
    <ng-container>
      <form [formGroup]="ReceiptVoucherForm">
        <div class="row align-items-end mb-3 mx-3">
          <!-- 1 line -->
          <div class="col-sm-6 col-md-3 col-lg-4 mb-0">
            <div class="form-group">
              <label for="customerEn" class="text-right col-form-label block">
                {{ "date" | translate }}
              </label>
              <input
                placeholder="{{ 'Chose' | translate }}"
                name="date"
                type="text"
                class="form-control"
                bsDatepicker
                autocomplete="off"
                formControlName="dateM"
                #dpr="bsDatepicker"
                (ngModelChange)="gethigridate()"
              />
            </div>
          </div>

          <div class="col-sm-6 col-md-3 col-lg-4 mb-0">
            <div class="form-group">
              <label for="customerEn" class="text-right col-form-label block">
                {{ "Bond number" | translate }}
              </label>
              <input
                required
                class="form-control"
                type="text"
                autocomplete="off"
                formControlName="VoucherNumber"
              />
            </div>
          </div>

          <div class="col-sm-6 col-md-3 col-lg-4 mb-0">
            <div class="form-group">
              <label for="customerEn" class="text-right col-form-label block">
                {{ "m_Cost" | translate }}
                <span class="text-danger">*</span>
              </label>
              <ng-select
                class="w-full p-0
                {{
                  ReceiptVoucherForm.get('costCentersId')?.hasError(
                    'required'
                  ) && ReceiptVoucherForm.get('costCentersId')?.touched
                    ? 'errorInput'
                    : ''
                }}"
                placeholder="{{ 'Chose' | translate }}"
                autocomplete="off"
                formControlName="costCentersId"
                name="user"
              >
                <ng-option
                  *ngFor="let user of costCentersList"
                  [value]="user.id"
                  >{{ user.name }}</ng-option
                >
              </ng-select>
              <!-- <div *ngIf="ReceiptVoucherForm.get('costCentersId')?.hasError('required')
                   && ReceiptVoucherForm.get('costCentersId')?.touched" class="error-text">
                  This field is required.
                </div> -->
            </div>
          </div>
        </div>
      </form>

      <!-- 2 line -->
      <div class="row align-items-end mb-3 mx-3">
        <div class="col-sm-6 col-md-3 col-lg-4 mb-0">
          <div class="form-group hijri-gregorianReciept">
            <label for="customerEn" class="text-right col-form-label block">
              {{ "Corresponding" | translate }}
            </label>
            <!-- <input placeholder="{{ 'Chose' | translate }}" name="date" type="text" class="form-control" bsDatepicker
                formControlName="hijriDate"
                  #dpr="bsDatepicker" /> -->
            <hijri-gregorian-datepicker
              [(selectedDate)]="hijriDateReceipt"
              [isRequired]="true"
              [hijriLabel]="'Hijri'"
              [disabled]="hijritype"
              [selectedDateType]="selectedDateType"
              [dir]="'dir' | translate"
            >
            </hijri-gregorian-datepicker>
          </div>
        </div>
        <div class="col-sm-6 col-md-3 col-lg-4 mb-0">
          <div class="form-group">
            <label for="customerEn" class="text-right col-form-label block">
              {{ "referenceNumber" | translate }}
              <!-- <span class="text-danger">*</span> -->
            </label>
            <input
              placeholder="{{ 'referenceNumber' | translate }}"
              autocomplete="off"
              [disabled]="modalType == 'View'"
              [(ngModel)]="referenceNumber"
              class="form-control"
              type="text"
            />
            <!-- <div *ngIf="referenceNumber==null&& submitted==true" class="error-text">
                  This field is required.
                </div> -->
          </div>
        </div>

        <div class="col-sm-6 col-md-3 col-lg-4 mb-0">
          <div class="form-group">
            <label for="customerEn" class="text-right col-form-label block">
              {{ "Invoice Number" | translate }}
            </label>
            <input
              autocomplete="off"
              disabled
              [(ngModel)]="R_theInvoice"
              placeholder="{{ 'R_theInvoice' | translate }}"
              class="form-control"
              type="text"
            />
          </div>
        </div>
      </div>
      <!-- 3 line -->

      <!-- <form [formGroup]="ReceiptVoucherForm"> -->
      <div class="row align-items-end mb-3 mx-3">
        <div class="col-sm-6 col-md-3 col-lg-4 mb-0">
          <div class="form-group">
            <label for="customerEn" class="text-right col-form-label block">
              {{ "Registration number" | translate }}
            </label>
            <input
              autocomplete="off"
              [(ngModel)]="Registrationnumber"
              disabled
              placeholder="{{ 'Registration number' | translate }}"
              class="form-control"
              type="text"
            />
          </div>
        </div>

        <div class="col-sm-6 col-md-3 col-lg-4 mb-0">
          <div class="form-group">
            <label for="customerEn" class="text-right col-form-label block">
              {{ "Payment type" | translate }}
              <span class="text-danger">*</span>
            </label>
            <ng-select
              placeholder="{{ 'Chose' | translate }}"
              class="w-full p-0
                {{
                paymenttype == null && submitted == true ? 'errorInput' : ''
              }}"
              [(ngModel)]="paymenttype"
              (change)="FillCustAc(false)"
            >
              <ng-option *ngFor="let user of PayTypeList" [value]="user.id">{{
                user.name | translate
              }}</ng-option>
            </ng-select>
            <!-- <div *ngIf="paymenttype==null && submitted==true" class="error-text">
                  This field is required.
                </div> -->
          </div>
        </div>

        <!-- <div class="col-sm-6 col-md-3 col-lg-4 mb-0">
              <div class="upload col-span-1 md:col-span-2">
                <label for="attach">{{ "attachments" | translate }}</label>
                <input type="file" accept="image/*" (change)="selectFile($event)" formControlName="fileUrl" />
              </div>
            </div> -->

        <!-- <div class="col-sm-6 col-md-3 col-lg-4 mb-0">
              <div class="upload col-span-1 md:col-span-2">
                <label for="attachments" class=" " for="attachments">{{ "attachments" | translate }}</label>
                <file-upload
                  class="w-full"
                  style="min-height: 40px"
                  [(ngModel)]="uploadedFiles"
                  name="files"
                ></file-upload>
              </div>
            </div> -->

        <div class="col-sm-6 col-md-3 col-lg-4 mb-0">
          <div class="form-group">
            <label for="customerEn" class="text-right col-form-label block">
              {{ "customer name" | translate }}
              <span class="text-danger">*</span>
            </label>
            <ng-select
              placeholder="{{ 'Chose' | translate }}"
              class="w-full p-0
                {{ ClientId == null && submitted == true ? 'errorInput' : '' }}"
              autocomplete="off"
              (change)="GetCustomersByCustomerId()"
              [(ngModel)]="ClientId"
              disabled
            >
              <ng-option
                *ngFor="let user of AllCustomerForDropWithBranchList"
                [value]="user.id"
                >{{ user.name }}</ng-option
              >
            </ng-select>
            <!-- <div *ngIf="ClientId==null&& submitted==true" class="error-text">
                  This field is required.
                </div> -->
          </div>
        </div>
      </div>
      <!-- </form> -->
      <!--  -->
      <form [formGroup]="ReceiptVoucherForm">
        <div class="row mx-3 items-end">
          <div class="col-md-12">
            <div class="boxContainer mb-3 w-100 p-3">
              <div class="row">
                <div class="col-md-3">
                  <label
                    for="recipientName"
                    class="text-yellow"
                    for="recipientName"
                  >
                    {{ "recipientfromName" | translate }}
                    <span class="text-danger">*</span>
                  </label>
                </div>
                <div class="col-md-9">
                  <input
                    id="recipientName"
                    placeholder="{{ 'recipientName' | translate }}"
                    type="text"
                    class="form-control text-center {{
                      ReceiptVoucherForm.get('recipientName')?.hasError(
                        'required'
                      ) && ReceiptVoucherForm.get('recipientName')?.touched
                        ? 'errorInput'
                        : ''
                    }}"
                    name="recipientName"
                    autocomplete="off"
                    formControlName="recipientName"
                  />
                  <!-- <div *ngIf="ReceiptVoucherForm.get('recipientName')?.hasError('required')
                            && ReceiptVoucherForm.get('recipientName')?.touched" class="error-text">
                    This field is required.
                  </div> -->
                </div>
              </div>

              <div class="row">
                <div class="col-md-3">
                  <label for="AmountOf" class="text-orange">
                    {{ "AmountOf" | translate }}
                    <span class="text-danger">*</span>
                  </label>
                </div>
                <div class="col-md-3">
                  <input
                    id="AmountOf"
                    placeholder="{{ 'AmountOf' | translate }}"
                    class="form-control text-center
                  {{
                      ReceiptVoucherForm.get('AmountOf')?.hasError(
                        'required'
                      ) && ReceiptVoucherForm.get('AmountOf')?.touched
                        ? 'errorInput'
                        : ''
                    }}
                    "
                    type="number"
                    autocomplete="off"
                    formControlName="AmountOf"
                    name="AmountOf"
                    (keyup)="
                      ConvertNumToString_Offer(
                        this.ReceiptVoucherForm.controls['AmountOf'].value
                      )
                    "
                  />
                  <!-- <div *ngIf="ReceiptVoucherForm.get('AmountOf')?.hasError('required')
                            && ReceiptVoucherForm.get('AmountOf')?.touched" class="error-text">
                    This field is required.
                  </div> -->
                </div>
                <div class="col-md-6">
                  <input
                    id="AmountOf"
                    placeholder="{{ 'amountWriting' | translate }}"
                    class="form-control text-center"
                    type="text"
                    autocomplete="off"
                    formControlName="amountWriting"
                  />
                </div>
              </div>

              <div class="row">
                <div class="col-md-3">
                  <label for="AndThatFor" class="text-yellow">
                    {{ "AndThatFor" | translate }}
                    <span class="text-danger">*</span>
                  </label>
                </div>
                <div class="col-md-9">
                  <input
                    id="AndThatFor"
                    placeholder="{{ 'AndThatFor' | translate }}"
                    class="form-control text-center
                  {{
                      ReceiptVoucherForm.get('AndThatFor')?.hasError(
                        'required'
                      ) && ReceiptVoucherForm.get('AndThatFor')?.touched
                        ? 'errorInput'
                        : ''
                    }}
                  "
                    type="text"
                    name="AndThatFor"
                    autocomplete="off"
                    formControlName="AndThatFor"
                  />
                  <!-- <div *ngIf="ReceiptVoucherForm.get('AndThatFor')?.hasError('required')
                             && ReceiptVoucherForm.get('AndThatFor')?.touched" class="error-text">
                    This field is required.
                  </div> -->
                </div>
              </div>
            </div>
            <div class="boxContainer w-100 p-3">
              <div class="row">
                <div class="col-md-3">
                  <label for="fromAccount" class="text-orange">
                    {{ "fromAccount" | translate }}
                    <span class="text-danger">*</span>
                  </label>
                </div>
                <div class="col-md-6">
                  <ng-select
                    placeholder="{{ 'Chose' | translate }}"
                    class="w-full p-0 h-100
                  {{
                      ReceiptVoucherForm.get('fromAccount')?.hasError(
                        'required'
                      ) && ReceiptVoucherForm.get('fromAccount')?.touched
                        ? 'errorInput'
                        : ''
                    }}
                  "
                    autocomplete="off"
                    formControlName="fromAccount"
                    name="fromAccount"
                    (change)="
                      GetAccCodeFormID(
                        this.ReceiptVoucherForm.controls['fromAccount'].value,
                        1
                      )
                    "
                  >
                    <ng-option
                      *ngFor="let user of FillCustAccountsSelect2listFROM"
                      [value]="user.id"
                    >
                      {{ user.name }}</ng-option
                    >
                  </ng-select>
                  <!-- <div *ngIf="ReceiptVoucherForm.get('fromAccount')?.hasError('required')
                           && ReceiptVoucherForm.get('fromAccount')?.touched" class="error-text">
                    This field is required.
                  </div> -->
                </div>
                <div class="col-md-3">
                  <input
                    id="accountNumber"
                    placeholder="{{ 'accountNumber' | translate }}"
                    autocomplete="off"
                    formControlName="AccCodeFrom"
                    class="form-control text-center"
                    type="text"
                  />
                </div>
              </div>

              <div class="row">
                <div class="col-md-3">
                  <label for="toAccount" class="text-green-500">
                    {{ "toAccount" | translate }}
                    <span class="text-danger">*</span>
                  </label>
                </div>
                <div class="col-md-6">
                  <ng-select
                    placeholder="{{ 'Chose' | translate }}"
                    required
                    class="w-full p-0 h-100
                  {{
                      ReceiptVoucherForm.get('toAccount')?.hasError(
                        'required'
                      ) && ReceiptVoucherForm.get('toAccount')?.touched
                        ? 'errorInput'
                        : ''
                    }}
                  "
                    (change)="
                      GetAccCodeFormID(
                        this.ReceiptVoucherForm.controls['toAccount'].value,
                        2
                      )
                    "
                    autocomplete="off"
                    formControlName="toAccount"
                  >
                    <ng-option
                      *ngFor="let user of FillCustAccountsSelect2listTO"
                      [value]="user.id"
                    >
                      {{ user.name }}</ng-option
                    >
                  </ng-select>
                  <!-- <div *ngIf="ReceiptVoucherForm.get('toAccount')?.hasError('required')
                           && ReceiptVoucherForm.get('toAccount')?.touched" class="error-text">
                    This field is required.
                  </div> -->
                </div>
                <div class="col-md-3">
                  <input
                    id="accountNumber"
                    placeholder="{{ 'accountNumber' | translate }}"
                    autocomplete="off"
                    formControlName="AccCodeTo"
                    class="form-control text-center"
                    type="text"
                  />
                </div>
              </div>

              <div class="row">
                <div class="col-md-3">
                  <label for="Statement " class="text-babyblue">
                    {{ "Statement" | translate }}
                  </label>
                </div>
                <div class="col-md-9">
                  <input
                    id="Statement "
                    placeholder="{{ 'Statement' | translate }}"
                    autocomplete="off"
                    formControlName="Statement"
                    class="form-control text-center"
                    type="text"
                    name="Statement"
                  />
                </div>
              </div>

              <div class="row">
                <div class="col-md-3">
                  <label for="Notes " class="text-babyblue">
                    {{ "Notes" | translate }}
                  </label>
                </div>
                <div class="col-md-9">
                  <input
                    id="Notes "
                    placeholder="{{ 'Notes' | translate }}"
                    autocomplete="off"
                    formControlName="Notes"
                    class="form-control text-center"
                    type="text"
                    name="Notes"
                  />
                </div>
              </div>
            </div>
          </div>
        </div>
      </form>

      <!-- footer -->
      <div
        class="editable shadow mb-4 d-block"
        style="overflow: auto"
        *ngIf="checkdetailsList.length > 0"
      >
        <p class="text-center">
          {{ "Check_transferDetails" | translate }}
        </p>
        <table
          class="table table-responsive table-striped table-bordered text-center"
          style="
            vertical-align: middle;
            font-size: 14px;
            min-width: max-content;
          "
        >
          <thead
            class="bg-base text-white"
            style="line-height: 30px; font-size: 13px"
          >
            <tr>
              <th>{{ "serial" | translate }}</th>
              <th>{{ "Payment type" | translate }}</th>
              <th>{{ "Check_transferNumber" | translate }}</th>
              <th>{{ "dateCheck_transfer" | translate }}</th>
              <th>{{ "BankName" | translate }}</th>
              <th>{{ "edit" | translate }}</th>
            </tr>
          </thead>
          <tbody>
            <tr
              *ngFor="let item of checkdetailsList; let i = index"
              style="line-height: 5px"
            >
              <td>{{ item.checkdetail }}</td>
              <td>{{ item.checkdetailpaytype }}</td>
              <td>{{ item.checkdetailcheckNo }}</td>
              <td>{{ item.checkdetailcheckDate }}</td>
              <td>{{ item.checkdetailbankName }}</td>
              <td *ngIf="modalType == 'Create' || modalType == 'Edit'">
                <button
                  class="p-2 bg-orange-100 hover:bg-orange-500 rounded-lg duration-300 hover:text-white w-10"
                  (click)="
                    open(
                      EditCheckDetailsModal,
                      item,
                      'EditCheckDetailsModal',
                      '',
                      'EditCheckDetails'
                    )
                  "
                >
                  <i class="fa-regular fa-pen-to-square"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </ng-container>
    <!-- <div class="d-flex align-items-center gap-2" *ngIf="this.modalType == 'Edit'">
      <img class="rounded-circle" width="50" height="50"   src="{{ addInvoiceImg | img }}" alt="" />
      <p class="mb-0">
        {{ "Data Entry" | translate }} :{{addUser}} - {{addDate | date }}
      </p>
    </div> -->
    <div class="d-flex justify-content-end gap-2">
      <div>
        <button
          class="btn text-white"
          style="background-color: var(--base-color)"
          (click)="open(SaveReceiptSVoucherConfirmModal,null,'SaveReceiptSVoucherConfirmModal',null,null, modal)"
          [disabled]="disableButtonSave_Voucher ||
            this.ReceiptVoucherForm.controls['recipientName'].value == null ||
            this.ReceiptVoucherForm.controls['AmountOf'].value == null ||
            this.ReceiptVoucherForm.controls['AndThatFor'].value == null ||
            this.ReceiptVoucherForm.controls['fromAccount'].value == null ||
            this.ReceiptVoucherForm.controls['toAccount'].value == null ||
            this.ReceiptVoucherForm.controls['costCentersId'].value == null ||
            paymenttype == null ||
            (CustCheckPage == 'withCustomer' && ClientId == null)
          "
        >
          {{ "save" | translate }}
        </button>
      </div>

      <div>
        <button (click)="modal?.dismiss()" class="btn btn-secondary">
          {{ "close" | translate }}
        </button>
      </div>
    </div>
  </div>
</ng-template>

<!-- EditCheckDetailsModal -->
<ng-template #EditCheckDetailsModal let-modal>
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4 class="m-0">
      <span class="text-2xl">{{ "Check_transferDetails" | translate }}</span>
    </h4>
    <button
      type="button"
      class="text-2xl text-white m-0"
      (click)="modal.dismiss()"
    >
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>
  <div class="max-h-100 overflow-x-scroll overflow-y-scroll px-4">
    <form [formGroup]="CheckDetailsForm">
      <div class="row align-items-end mb-4 mx-3">
        <!-- 1 line -->

        <div class="col-sm-6 col-md-3 col-lg-4 mb-0 mb-sm-3">
          <div class="form-group">
            <label for="customerEn" class="text-right col-form-label block">
              {{ "Payment type" | translate }}
            </label>
            <input
              autocomplete="off"
              formControlName="paymenttypeName"
              class="form-control"
              type="text"
            />
          </div>
        </div>

        <div class="col-sm-6 col-md-3 col-lg-4 mb-0 mb-sm-3">
          <div class="form-group">
            <label for="customerEn" class="text-right col-form-label block">
              {{ "dateCheck_transfer" | translate }}
            </label>
            <input
              placeholder="{{ 'Chose' | translate }}"
              name="dateCheck_transfer"
              type="text"
              class="form-control"
              bsDatepicker
              #dpr="bsDatepicker"
              formControlName="dateCheck_transfer"
            />
          </div>
        </div>

        <div
          class="col-sm-6 col-md-3 col-lg-4 mb-0 mb-sm-3"
          *ngIf="transferNumber == true"
        >
          <div class="form-group">
            <label for="customerEn" class="text-right col-form-label block">
              {{ "Check_transferNumber" | translate }}
            </label>
            <input
              placeholder="{{ 'Check_transferNumber' | translate }}"
              autocomplete="off"
              formControlName="Check_transferNumber"
              class="form-control"
              type="number"
            />
          </div>
        </div>

        <div class="col-sm-6 col-md-3 col-lg-4 mb-0 mb-sm-3">
          <div class="form-group">
            <label for="customerEn" class="text-right col-form-label block">
              {{ "BankName" | translate }}
            </label>
            <ng-select
              class="w-full p-0"
              placeholder="{{ 'Chose' | translate }}"
              name="user"
              formControlName="BankId"
            >
              <ng-option
                *ngFor="let user of BankSelectList"
                [value]="user.id"
                >{{ user.name }}</ng-option
              >
            </ng-select>
          </div>
        </div>

        <button
          type="button"
          class="flex gap-1 btn btn-success mb-3 col-md-2"
          (click)="open(AddModalBanks, '', 'AddModalBanks')"
        >
          {{ "add" | translate }}
          <i class="fa-solid fa-plus"></i>
        </button>
      </div>
    </form>
  </div>

  <div class="flex justify-end p-3">
    <button class="btn mx-2 btn-secondary" (click)="modal?.dismiss()">
      {{ "close" | translate }}
    </button>

    <button
      class="btn text-white"
      style="background-color: var(--base-color)"
      (click)="checkdetailsTabel(modal)"
      [disabled]="this.CheckDetailsForm.controls['BankId'].value == null"
    >
      {{ "save" | translate }}
    </button>
  </div>
</ng-template>

<!-- AddModalBanks -->
<ng-template #AddModalBanks let-modal>
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4 class="m-0">
      <span class="text-2xl">{{ "Bank Name" | translate }}</span>
    </h4>
    <button
      type="button"
      class="text-2xl text-white m-0"
      (click)="modal.dismiss()"
    >
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>
  <div class="max-h-100 overflow-x-scroll overflow-y-scroll px-4">
    <form class="" #smsForm="ngForm">
      <div class="row align-items-end mb-4 mx-3">
        <!-- 1 line -->

        <div class="col-sm-6 col-md-3 col-lg-6 mb-0 mb-sm-3">
          <div class="form-group">
            <label for="nameAr" class="text-right col-form-label block">
              {{ "nameAr" | translate }}
            </label>
            <input
              class="form-control"
              type="text"
              [(ngModel)]="BanksNameEn"
              [ngModelOptions]="{ standalone: true }"
            />
          </div>
        </div>

        <div class="col-sm-6 col-md-3 col-lg-6 mb-0 mb-sm-3">
          <div class="form-group">
            <label for="nameEn" class="text-right col-form-label block">
              {{ "nameEn" | translate }}
            </label>
            <input
              type="text"
              class="form-control"
              [(ngModel)]="BanksNameAr"
              [ngModelOptions]="{ standalone: true }"
            />
          </div>
        </div>

        <div class="col-sm-6 col-md-3 col-lg-12 mb-0 mb-sm-3 text-center">
          <button
            type="button"
            class="flex gap-1 btn text-white mb-3 col-md-2 me-3"
            (click)="SaveBanks()"
            style="background-color: var(--base-color)"
          >
            {{ "save" | translate }}
          </button>

          <button
            type="button"
            class="flex gap-1 btn btn-secondary mb-3 col-md-2"
            (click)="modal?.dismiss()"
          >
            {{ "close" | translate }}
          </button>
        </div>

        <!-- <div class="col-sm-6 col-md-3 col-lg-12 mb-0 mb-sm-3 text-center">
          <input name="dateCheck_transfer" placeholder="{{ 'search' | translate }}" type="text" class="form-control"/>
        </div> -->
      </div>

      <div class="editable shadow mb-4">
        <table
          class="table table-responsive table-striped table-bordered text-center"
          style="vertical-align: middle; font-size: 14px"
        >
          <thead
            class="bg-base text-white"
            style="line-height: 30px; font-size: 13px"
          >
            <tr>
              <th>{{ "BankName_ar" | translate }}</th>
              <th>{{ "BankName_en" | translate }}</th>
              <th>{{ "operations" | translate }}</th>
            </tr>
          </thead>
          <tbody>
            <tr
              *ngFor="let item of BanksList; let i = index"
              style="line-height: 5px"
            >
              <td>{{ item.nameAr }}</td>
              <td>{{ item.nameEn }}</td>
              <td>
                <button
                  class="p-2 bg-orange-100 hover:bg-orange-500 rounded-lg duration-300 hover:text-white w-10"
                  (click)="updateBanks(item)"
                >
                  <i class="fa-regular fa-pen-to-square"></i>
                </button>

                <button
                  class="p-2 bg-red-100 hover:bg-red-500 rounded-lg duration-300 hover:text-white w-10 me-3"
                  (click)="open(deleteBank, item, 'deleteBank')"
                >
                  <i class="fa-solid fa-trash-can"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </form>
  </div>
  <!--
  <div class="flex justify-end p-3">
    <button class="btn me-2 btn-secondary" (click)="modal?.dismiss()">
      {{ "close" | translate }}
    </button>

    <button (click)="modal?.dismiss()" class="btn text-white" style="background-color: var(--base-color)">
      {{ "save" | translate }}
    </button>
  </div> -->
</ng-template>

<!-- deleteBank -->
<ng-template #deleteBank let-modal>
  <div class="modal-body text-center">
    <p
      [translate]="'name'"
      [translateParams]="{
        ar: 'هل تريد حذف هذا العنصر ؟',
        en: 'Do you want to delete this item?'
      }"
    ></p>
    <div class="flex gap-2 justify-center">
      <button
        type="button"
        (click)="modal.dismiss()"
        mat-raised-button
        color="basic"
      >
        {{ "close" | translate }}
      </button>

      <button
        type="button"
        mat-raised-button
        color="warn"
        (click)="DeleteBank(modal)"
      >
        {{ "confirem" | translate }}
      </button>
    </div>
  </div>
</ng-template>

<!-- SaveInvoiceConfirmModal -->
<ng-template #SaveInvoiceConfirmModal let-modal>
  <div
    class="modal-body text-center"
    style="background-color: #cdcdcd !important"
  >
    <p
      [translate]="'name'"
      [translateParams]="{
        ar: 'هل تريد الحفظ ',
        en: 'Are you sure to save ?'
      }"
    ></p>
    <div class="flex gap-2 justify-center mt-3">
      <button
        type="button"
        mat-raised-button
        color="warn"
        [disabled]="disableButtonSave_Invoice"
        (click)="checkPayTypeAndSave(); modal.dismiss()"
      >
        {{ "Yes" | translate }}
      </button>
      <button
        type="button"
        (click)="modal.dismiss()"
        mat-raised-button
        color="basic"
      >
        {{ "No" | translate }}
      </button>
    </div>
  </div>
</ng-template>

<!-- serviceDetails -->
<ng-template #serviceDetailsModal_Invoice let-modal>
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4 class="m-0">
      <span class="text-2xl">{{ "servicesList" | translate }}</span>
    </h4>
    <button
      type="button"
      class="text-2xl text-white m-0"
      (click)="modal.dismiss()"
    >
      <i class="fa-solid fa-xmark"></i>
    </button>
  </div>
  <div class="modal-body">
    <div
      cdkDropList
      [cdkDropListData]="serviceDetails_Invoice"
      class="example-list"
      (cdkDropListDropped)="drop_Invoice($event)"
    >
      <div
        *ngFor="let item of serviceDetails_Invoice"
        class="example-box"
        cdkDrag
      >
        <div class="col-md-11" style="font-size: 20px">
          <i
            *ngIf="
              (item?.SureService ?? 0) != 1 && OfferPopupAddorEdit_Invoice == 0
            "
            class="fa fa-xmark text-danger"
          ></i>
          <i
            *ngIf="
              (item?.SureService ?? 0) == 1 && OfferPopupAddorEdit_Invoice == 0
            "
            class="fa fa-check text-success"
          ></i>
          <i
            *ngIf="OfferPopupAddorEdit_Invoice == 1"
            class="fa fa-check text-success"
          ></i>
          <span class="text-base mx-2">{{ item?.name }}</span>
        </div>
        <div class="serviceBtns" *ngIf="OfferPopupAddorEdit_Invoice == 0">
          <button
            *ngIf="(item?.SureService ?? 0) != 1"
            (click)="MarkServiceDetails_Invoice(item)"
            type="button"
            class="btn btn-outline-success"
          >
            {{ "Insert" | translate }}
          </button>
          <button
            *ngIf="(item?.SureService ?? 0) == 1"
            (click)="UnMarkServiceDetails_Invoice(item)"
            type="button"
            class="btn btn-outline-danger"
          >
            {{ "delete" | translate }}
          </button>
        </div>
      </div>
    </div>
    <div
      class="flex gap-2 pt-3 border-t border-neutral-300 col-span-1 md:col-span-2 mt-2"
    >
      <button (click)="modal?.dismiss()" class="btn btn-secondary">
        {{ "close" | translate }}
      </button>
    </div>
  </div>
</ng-template>

  <!-- btn add  -->
  <ng-template #StorehouseModal let-modal>
    <div class="modal-header bg-base text-white">
      <h4
        class="modal-title mb-0"
        id="modal-basic-title"
        [translate]="'name'"
        [translateParams]="{ ar: 'اضافة جديدة', en: 'Add New' }"
      ></h4>
      <button
        type="button"
        class="text-2xl text-white m-0"
        (click)="modal.dismiss('Cross click')"
      >
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>
    <div class="modal-body text-center">
      <form #addStorehouse="ngForm" class="grid grid-cols-1 md:grid-cols-2 gap-2">
        <div class="form-group">
          <label for="BuildNameArtxt" class="text-right col-form-label block">
            {{ "nameAr" | translate }}
            <span class="text-danger">*</span></label
          >
          <input
            required
            #StorehouseNameAr="ngModel"
            ngModel
            [(ngModel)]="dataAdd.Storehouse.nameAr"
            class="form-control"
            type="text"
            id="StorehouseNameArtxt"
            name="StorehouseNameArtxt"
            autocomplete="off"
            [placeholder]="('Write' | translate) + ' ' + ('nameAr' | translate)"
          />
        </div>
        <div class="form-group">
          <label for="StorehouseNameEntxt" class="text-right col-form-label block">
            {{ "nameEn" | translate }}
            <span class="text-danger">*</span></label
          >
          <div style="display: inline-flex; width: 100%">
            <input
              required
              #StorehouseNameEnValue
              #StorehouseNameEn="ngModel"
              [(ngModel)]="dataAdd.Storehouse.nameEn"
              ngModel
              class="form-control"
              type="text"
              id="StorehouseNameEntxt"
              name="StorehouseNameEntxt"
              autocomplete="off"
              [placeholder]="('Write' | translate) + ' ' + ('nameEn' | translate)"
            />
            <a
              class="btn"
              id="CopyStorehouseName2"
              (click)="dataAdd.Storehouse.nameEn = dataAdd.Storehouse.nameAr"
              ><i class="fa fa-copy"></i
            ></a>
          </div>
        </div>
      </form>
      <div class="max-h-80 overflow-auto px-2">
        <table class="table table-hover">
          <thead>
            <tr>
              <th>{{ "nameAr" | translate }}</th>
              <th>{{ "nameEn" | translate }}</th>
              <th
                [translate]="'name'"
                [translateParams]="{
                  ar: 'خيارات',
                  en: 'Operations'
                }"
              ></th>
            </tr>
          </thead>
          <tbody>
            <tr
              *ngFor="let type of StorehousePopup"
              (dblclick)="
                setStorehouseInSelect(type, StorehouseModal);
                modal.dismiss('Cross click')
              "
            >
              <td>{{ type.name }}</td>
              <td>{{ type.nameEn }}</td>
              <td class="flex gap-2 justify-center">
                <button
                  class="p-2 bg-orange-100 hover:bg-orange-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
                  (click)="
                    dataAdd.Storehouse.nameAr = type.name;
                    dataAdd.Storehouse.nameEn = type.nameEn;
                    dataAdd.Storehouse.id = type.id
                  "
                >
                  <i class="fa-regular fa-pen-to-square"></i>
                </button>
                <button
                  (click)="getStorehouseRow(type); open(deleteStorehouse)"
                  class="p-2 bg-red-100 hover:bg-red-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
                >
                  <i class="fa-solid fa-trash-can"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="flex gap-2 mt-3 pt-3 border-t border-neutral-300">
        <button
          class="btn bg-base text-white"
          type="submit"
          [disabled]="addStorehouse.invalid"
          (click)="saveStorehouse()"
        >
          {{ "Save" | translate }}
        </button>
        <button (click)="modal.dismiss('Cross click')" class="btn btn-secondary">
          {{ "Back" | translate }}
        </button>
        <button (click)="resetStorehouse()" class="btn bg-base text-white">
          {{ "جديد" | translate }}
        </button>
      </div>
    </div>
  </ng-template>
  
  <ng-template #deleteStorehouse let-modal>
    <div class="modal-body text-center">
      <p
        [translate]="'name'"
        [translateParams]="{
          ar: 'هل تريد بالتأكيد حذف هذا الصف',
          en: 'Are you sure to delete this row ?'
        }"
      ></p>
      <div class="flex gap-2 justify-center mt-3">
        <button
          type="button"
          mat-raised-button
          color="warn"
          (click)="confirmStorehouseDelete(); modal.dismiss()"
        >
          {{ "Yes" | translate }}
        </button>
        <button
          type="button"
          (click)="modal.dismiss()"
          mat-raised-button
          color="basic"
        >
          {{ "No" | translate }}
        </button>
      </div>
    </div>
  </ng-template>

  <ng-template #ServiceTypeModal let-modal>
    <div class="modal-header bg-base text-white">
      <h4
        class="modal-title mb-0"
        id="modal-basic-title"
        [translate]="'name'"
        [translateParams]="{ ar: 'اضافة جديدة', en: 'Add New' }"
      ></h4>
      <button
        type="button"
        class="text-2xl text-white m-0"
        (click)="modal.dismiss('Cross click')"
      >
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>
    <div class="modal-body text-center">
      <form #addServiceType="ngForm" class="grid grid-cols-1 md:grid-cols-2 gap-2">
        <div class="form-group">
          <label for="BuildNameArtxt" class="text-right col-form-label block">
            {{ "nameAr" | translate }}
            <span class="text-danger">*</span></label
          >
          <input
            required
            #ServiceTypeNameAr="ngModel"
            ngModel
            [(ngModel)]="dataAdd.ServiceType.nameAr"
            class="form-control"
            type="text"
            id="ServiceTypeNameArtxt"
            name="ServiceTypeNameArtxt"
            autocomplete="off"
            [placeholder]="('Write' | translate) + ' ' + ('nameAr' | translate)"
          />
        </div>
        <div class="form-group">
          <label for="ServiceTypeNameEntxt" class="text-right col-form-label block">
            {{ "nameEn" | translate }}
            <span class="text-danger">*</span></label
          >
          <div style="display: inline-flex; width: 100%">
            <input
              required
              #ServiceTypeNameEnValue
              #ServiceTypeNameEn="ngModel"
              [(ngModel)]="dataAdd.ServiceType.nameEn"
              ngModel
              class="form-control"
              type="text"
              id="ServiceTypeNameEntxt"
              name="ServiceTypeNameEntxt"
              autocomplete="off"
              [placeholder]="('Write' | translate) + ' ' + ('nameEn' | translate)"
            />
            <a
              class="btn"
              id="CopyServiceTypeName2"
              (click)="dataAdd.ServiceType.nameEn = dataAdd.ServiceType.nameAr"
              ><i class="fa fa-copy"></i
            ></a>
          </div>
        </div>
      </form>
      <div class="max-h-80 overflow-auto px-2">
        <table class="table table-hover">
          <thead>
            <tr>
              <th>{{ "nameAr" | translate }}</th>
              <th>{{ "nameEn" | translate }}</th>
              <th
                [translate]="'name'"
                [translateParams]="{
                  ar: 'خيارات',
                  en: 'Operations'
                }"
              ></th>
            </tr>
          </thead>
          <tbody>
            <tr
              *ngFor="let type of ServiceTypePopup"
              (dblclick)="
                setServiceTypeInSelect(type, ServiceTypeModal);
                modal.dismiss('Cross click')
              "
            >
              <td>{{ type.name }}</td>
              <td>{{ type.nameEn }}</td>
              <td class="flex gap-2 justify-center">
                <button
                  class="p-2 bg-orange-100 hover:bg-orange-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
                  (click)="
                    dataAdd.ServiceType.nameAr = type.name;
                    dataAdd.ServiceType.nameEn = type.nameEn;
                    dataAdd.ServiceType.id = type.id
                  "
                >
                  <i class="fa-regular fa-pen-to-square"></i>
                </button>
                <button
                  (click)="getServiceTypeRow(type); open(deleteServiceType)"
                  class="p-2 bg-red-100 hover:bg-red-500 rounded-lg duration-300 hover:text-white aspect-square w-10"
                >
                  <i class="fa-solid fa-trash-can"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="flex gap-2 mt-3 pt-3 border-t border-neutral-300">
        <button
          class="btn bg-base text-white"
          type="submit"
          [disabled]="addServiceType.invalid"
          (click)="saveServiceType()"
        >
          {{ "Save" | translate }}
        </button>
        <button (click)="modal.dismiss('Cross click')" class="btn btn-secondary">
          {{ "Back" | translate }}
        </button>
        <button (click)="resetServiceType()" class="btn bg-base text-white">
          {{ "جديد" | translate }}
        </button>
      </div>
    </div>
  </ng-template>
  
  <ng-template #deleteServiceType let-modal>
    <div class="modal-body text-center">
      <p
        [translate]="'name'"
        [translateParams]="{
          ar: 'هل تريد بالتأكيد حذف هذا الصف',
          en: 'Are you sure to delete this row ?'
        }"
      ></p>
      <div class="flex gap-2 justify-center mt-3">
        <button
          type="button"
          mat-raised-button
          color="warn"
          (click)="confirmServiceTypeDelete(); modal.dismiss()"
        >
          {{ "Yes" | translate }}
        </button>
        <button
          type="button"
          (click)="modal.dismiss()"
          mat-raised-button
          color="basic"
        >
          {{ "No" | translate }}
        </button>
      </div>
    </div>
  </ng-template>
  <!-- SaveReceiptSVoucherConfirmModal -->
<ng-template #SaveReceiptSVoucherConfirmModal let-modal>
  <div
    class="modal-body text-center"
    style="background-color: #cdcdcd !important"
  >
    <p
      [translate]="'name'"
      [translateParams]="{
        ar: 'هل تريد الحفظ ',
        en: 'Are you sure to save ?'
      }"
    ></p>
    <div class="flex gap-2 justify-center mt-3">
      <button
        type="button"
        mat-raised-button
        color="warn"
        (click)="SaveVoucher(); modal.dismiss()"
      >
        {{ "Yes" | translate }}
      </button>
      <button
        type="button"
        (click)="modal.dismiss()"
        mat-raised-button
        color="basic"
      >
        {{ "No" | translate }}
      </button>
    </div>
  </div>
</ng-template>