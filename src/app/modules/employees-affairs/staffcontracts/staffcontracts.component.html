<div class="staffcontracts">
  <app-navigator [title]="title"></app-navigator>
  <div class="head flex gap-2 flex-wrap items-end justify-between">
    <div class="flex gap-2 flex-wrap items-end">
      <div class="max-w-xs flex-grow">
        <label class="col-form-label"> {{ "Employee Name" | translate }}</label>
        <ng-select
          class="w-full p-0"
          placeholder="{{ 'Chose' | translate }}"
          [(ngModel)]="SearchDetails.employeeId"
          [ngModelOptions]="{ standalone: true }"
          (change)="getData()"
        >
          <ng-option [value]="0"> {{ "Chose" | translate }}</ng-option>

          <ng-option
            *ngFor="let user of employeeselectlist2"
            [value]="user.id"
            >{{ user.name }}</ng-option
          >
        </ng-select>
      </div>
      <div class="max-w-xs flex-grow">
        <label class="col-form-label"> {{ "Branch" | translate }}</label>
        <ng-select
          class="w-full p-0"
          placeholder="{{ 'Chose' | translate }}"
          [(ngModel)]="SearchDetails.branchId"
          [ngModelOptions]="{ standalone: true }"
          (change)="getData()"
        >
          <ng-option [value]="0"> {{ "Chose" | translate }}</ng-option>

          <ng-option *ngFor="let user of branchselectlist" [value]="user.id">{{
            user.name
          }}</ng-option>
        </ng-select>
      </div>
      <div class="max-w-xs flex-grow">
        <input
          (keyup)="applyFilter($event)"
          class="form-control"
          style="max-width: 300px"
          #input
          placeholder="{{ 'search' | translate }}"
        />
      </div>
    </div>

    <div class="btns">
      <button
        *ngIf="userG?.userPrivileges.includes(141901)"
        type="button"
        class="btn bg-base text-white"
        (click)="open(addNewContract, null, 'addnewcontract')"
      >
        {{ "addNewContract" | translate }}
      </button>
    </div>
  </div>

  <div class="tables-data mt-3 overflow-hidden">
    <!-- table -->

    <div class="overflow-auto">
      <table
        mat-table
        [dataSource]="dataSource"
        matSort
        class="mat-elevation-z8 rounded-t-lg overflow-hidden w-max"
      >
        <!-- contractNo column -->
        <ng-container matColumnDef="contractNo">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <span>{{ "contract number" | translate }}</span>
          </th>
          <td mat-cell *matCellDef="let element">
            <span>{{ element.contractCode }}</span>
          </td>
        </ng-container>
        <!-- employeeNo column -->
        <ng-container matColumnDef="employeeNo">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <span>{{ "Job ID" | translate }}</span>
          </th>
          <td mat-cell *matCellDef="let element">
            <span>{{ element.employeeno }}</span>
          </td>
        </ng-container>
        <!-- employeName column -->
        <ng-container matColumnDef="employeName">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <span>{{ "Employee Name" | translate }}</span>
          </th>
          <td mat-cell *matCellDef="let element">
            <span>{{ element.employeeName }}</span>
          </td>
        </ng-container>
        <!-- nationality column -->
        <ng-container matColumnDef="nationality">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <span>{{ "Nationality" | translate }}</span>
          </th>
          <td mat-cell *matCellDef="let element">
            <span>{{ element.natName }}</span>
          </td>
        </ng-container>
        <!-- branch column -->
        <ng-container matColumnDef="branch">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <span>{{ "Branch" | translate }}</span>
          </th>
          <td mat-cell *matCellDef="let element">
            <span>{{ element.branchName }}</span>
          </td>
        </ng-container>
        <!-- startDate column -->
        <ng-container matColumnDef="startDate">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <span>{{ "Beginning of the decade" | translate }}</span>
          </th>
          <td mat-cell *matCellDef="let element">
            <span>{{ element.startDatetxt | date : "dd-MM-yyyy" }}</span>
          </td>
        </ng-container>
        <!-- endDate column -->
        <ng-container matColumnDef="endDate">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <span>{{ "End of the contract" | translate }}</span>
          </th>
          <td mat-cell *matCellDef="let element">
            <span>{{ element.endDatetxt | date : "dd-MM-yyyy" }}</span>
          </td>
        </ng-container>
        <!-- liveDate column -->
        <ng-container matColumnDef="liveDate">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <span>{{ "The date of commencement" | translate }}</span>
          </th>
          <td mat-cell *matCellDef="let element">
            <span>{{ element.startWorkDate | date : "dd-MM-yyyy" }}</span>
          </td>
        </ng-container>

        <!-- operations Column -->
        <ng-container matColumnDef="operations">
          <th
            mat-header-cell
            *matHeaderCellDef
            [translate]="'name'"
            [translateParams]="{
              ar: 'خيارات',
              en: 'Operations'
            }"
          ></th>
          <td mat-cell *matCellDef="let element">
            <div class="flex gap-1 justify-center py-2">
              <button
                *ngIf="userG?.userPrivileges.includes(141902)"
                class="p-2 bg-sky-100 hover:bg-sky-500 rounded-lg duration-300 hover:text-white w-10"
                (click)="PrintEmpContractReport(element)"
              >
                <i class="fa-solid fa-print"></i>
              </button>

              <button
                *ngIf="userG?.userPrivileges.includes(141903)"
                class="p-2 bg-orange-100 hover:bg-orange-500 rounded-lg duration-300 hover:text-white w-10"
                (click)="open(addNewContract, element, 'editcontract')"
              >
                <i class="fa-regular fa-pen-to-square"></i>
              </button>
              <button
                *ngIf="userG?.userPrivileges.includes(141904)"
                class="p-2 bg-red-100 hover:bg-red-500 rounded-lg duration-300 hover:text-white w-10"
                (click)="open(deleteModal, element, 'deletecontract')"
              >
                <i class="fa-solid fa-trash-can"></i>
              </button>
              <button
                *ngIf="userG?.userPrivileges.includes(141907)"
                class="p-2 bg-blue-100 hover:bg-blue-500 rounded-lg duration-300 hover:text-white w-10"
                (click)="
                  open(endEployeeJobModal, element, 'endEmployeeService')
                "
              >
                <i class="fa-solid fa-close"></i>
              </button>
              <button
                *ngIf="userG?.userPrivileges.includes(141906)"
                class="p-2 bg-orange-100 hover:bg-orange-500 rounded-lg duration-300 hover:text-white w-10"
                (click)="open(startJobModal, element, 'editstartwork')"
              >
                <i class="fa-solid fa-calendar"></i>
              </button>
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>

        <tr
          mat-row
          *matRowDef="let row; columns: displayedColumns"
          class="duration-300 hover:bg-slate-100"
        ></tr>
        <tr class="mat-row" *matNoDataRow>
          <td class="mat-cell" colspan="4">
            {{ "noResult" | translate }} "{{ input.value }}"
          </td>
        </tr>
      </table>
    </div>
    <mat-paginator [pageSizeOptions]="[10, 25, 100]"> </mat-paginator>
  </div>
</div>

<!-- addNewContract / edit -->
<ng-template #addNewContract let-modal>
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4 class="modal-title mb-0" id="modal-basic-title">
      <span *ngIf="modalDetails?.id">{{ "editNewContract" | translate }}</span>

      <span *ngIf="!modalDetails?.id">{{ "addNewContract" | translate }}</span>
    </h4>
    <button
      type="button"
      class="text-white m-0"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    >
      <i class="fa fa-close"></i>
    </button>
  </div>

  <div class="modal-body">
    <form #contractForm="ngForm">
      <div class="stepper-container">
        <mat-stepper linear #stepper>
          <mat-step
            [stepControl]="officeEmployeeInfo"
            [editable]="isEditableStepper"
          >
            <form [formGroup]="officeEmployeeInfo">
              <ng-template matStepLabel>
                <span>{{ "Office and employee data" | translate }} </span>
              </ng-template>
              <div class="content">
                <div class="row">
                  <div class="col-md-4">
                    <div class="form-group mb-3">
                      <label
                        for="contractNumber"
                        class="text-right col-form-label block"
                      >
                        {{ "contract number" | translate }}
                      </label>
                      <input
                        class="form-control"
                        formControlName="contractCode"
                        type="text"
                        id="contractNumber"
                        name="contractNumber"
                      />
                    </div>
                  </div>
                </div>

                <div class="row">
                  <div class="col-md-4 col-lg-6">
                    <div class="form-group mb-3">
                      <label
                        for="contractNumber"
                        class="text-right col-form-label block"
                      >
                        {{
                          "The first party / the name of the office" | translate
                        }}
                      </label>
                      <input
                        class="form-control"
                        formControlName="officeName"
                        type="text"
                        id="contractNumber"
                        name="contractNumber"
                      />
                    </div>
                  </div>
                  <div class="col-md-4 col-lg-3">
                    <div class="form-group mb-3">
                      <label class="col-form-label">
                        {{ "and represents it" | translate }}</label
                      >
                      <ng-select
                        class="w-full p-0"
                        name="user"
                        formControlName="companyRepresentativeId"
                        (change)="companyRepresentativeChange()"
                      >
                        <ng-option [value]="0">
                          {{ "Chose" | translate }}</ng-option
                        >
                        <ng-option
                          *ngFor="let user of Repemployeeselectlist"
                          [value]="user.id"
                          >{{ user.name }}</ng-option
                        >
                      </ng-select>
                    </div>
                  </div>
                  <div class="col-md-4 col-lg-3">
                    <div class="form-group mb-3">
                      <label
                        for="contractNumber"
                        class="text-right col-form-label block"
                      >
                        {{ "as" | translate }}
                      </label>
                      <input
                        class="form-control"
                        formControlName="perSe"
                        type="text"
                        id="contractNumber"
                        name="contractNumber"
                      />
                    </div>
                  </div>
                  <div class="col-md-6 col-lg-9">
                    <div class="form-group mb-3">
                      <label class="col-form-label">
                        {{ "The second party / customer" | translate }}</label
                      >
                      <ng-select
                        class="w-full p-0"
                        name="empId"
                        formControlName="empId"
                        (change)="employeechange()"
                        [dropdownPosition]="'bottom'"
                      >
                        <ng-option [value]="0">
                          {{ "Chose" | translate }}</ng-option
                        >

                        <ng-option
                          *ngFor="let user of employeeselectlist"
                          [value]="user.id"
                          name="name"
                          >{{ user.name }}</ng-option
                        >
                      </ng-select>
                    </div>
                  </div>
                  <div class="col-md-6 col-lg-3">
                    <div class="form-group mb-3">
                      <label
                        for="contractNumber"
                        class="text-right col-form-label block"
                      >
                        {{ "as" | translate }}
                      </label>
                      <input
                        class="form-control"
                        formControlName="perse2"
                        type="text"
                        id="perse2"
                        name="perse2"
                      />
                    </div>
                  </div>
                </div>

                <div class="d-flex items-center justify-end gap-3 mt-4">
                  <button
                    mat-button
                    matStepperNext
                    class="bg-base text-white"
                    [disabled]="officeEmployeeInfo.invalid"
                  >
                    {{ "Next" | translate }}
                  </button>
                  <button
                    (click)="modal?.dismiss()"
                    class="btn btn-outline-secondary"
                  >
                    {{ "close" | translate }}
                  </button>
                </div>
              </div>
            </form>
          </mat-step>

          <mat-step
            [stepControl]="contractSubject"
            [editable]="isEditableStepper"
          >
            <form [formGroup]="contractSubject">
              <ng-template matStepLabel>
                <span>{{ "subject matter of the contract" | translate }} </span>
              </ng-template>
              <div class="content">
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group">
                      <label class="col-form-label">
                        {{ "contract type" | translate }}</label
                      >
                      <ng-select
                        class="w-full p-0"
                        placeholder="{{ 'Chose' | translate }}"
                        name="contract type"
                        (change)="contractType = $event"
                        formControlName="contTypeId"
                      >
                        <ng-option [value]="0">
                          {{ "Chose" | translate }}</ng-option
                        >

                        <ng-option [value]="1">{{
                          "limited" | translate
                        }}</ng-option>
                        <ng-option [value]="2">{{
                          "unLimited" | translate
                        }}</ng-option>
                      </ng-select>
                    </div>
                  </div>
                  <div *ngIf="contractType == '1'" class="col-md-6">
                    <div class="form-group mb-3">
                      <label
                        for="contract type"
                        class="text-right col-form-label block"
                      >
                        {{ "duration" | translate }}
                      </label>
                      <input
                        class="form-control"
                        formControlName="contDuration"
                        type="text"
                        id="contDuration"
                        name="contDuration"
                      />
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-lg-6 mb-3 mb-lg-0">
                    <div class="form-group">
                      <label class="text-right col-form-label block">
                        {{ "From" | translate }} {{ " "
                        }}{{ "Date" | translate }}
                      </label>
                      <div class="form-group timeInput">
                        <input
                          formControlName="startDatetxt"
                          name="startDatetxt"
                          type="text"
                          class="form-control"
                          (bsValueChange)="checkdate($event, 1)"
                          bsDatepicker
                          autocomplete="off"
                          (keyup)="contractSubject.patchValue({startDatetxt: '',}); deletedate()"
                        />
                      </div>
                    </div>
                  </div>
                  <div *ngIf="contractType == '1'" class="col-lg-6">
                    <div class="form-group">
                      <label class="text-right col-form-label block">
                        {{ "To" | translate }} {{ " " }}{{ "Date" | translate }}
                      </label>
                      <div class="form-group timeInput">
                        <input
                          formControlName="endDatetxt"
                          name="endDatetxt"
                          type="text"
                          class="form-control"
                          (bsValueChange)="checkdate($event, 2)"
                          bsDatepicker
                          autocomplete="off"
                          (keyup)="contractSubject.patchValue({endDatetxt: '',}); deletedate()"
                        />
                      </div>
                    </div>
                  </div>
                </div>

                <hr class="my-4" />

                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group">
                      <label class="col-form-label">
                        {{ "Probation" | translate }}</label
                      >
                      <ng-select
                        class="w-full p-0"
                        placeholder="{{ 'Chose' | translate }}"
                        name="contract type"
                        formControlName="probationTypeId"
                        (change)="testDuration = $event"
                      >
                        <ng-option [value]="0">
                          {{ "Chose" | translate }}</ng-option
                        >

                        <ng-option [value]="1">{{
                          "exist" | translate
                        }}</ng-option>
                        <ng-option [value]="2">{{
                          "notExist" | translate
                        }}</ng-option>
                      </ng-select>
                    </div>
                  </div>
                  <div *ngIf="testDuration == '1'" class="col-md-6">
                    <div class="form-group mb-3">
                      <label class="col-form-label">
                        {{ "duration" | translate }}</label
                      >
                      <input
                        class="form-control"
                        formControlName="probationDuration"
                        type="text"
                        id="probationDuration"
                        name="probationDuration"
                      />
                    </div>
                  </div>
                </div>

                <div class="d-flex items-center justify-end gap-3 mt-4">
                  <button
                    mat-button
                    matStepperPrevious
                    class="btn btn-secondary"
                  >
                    {{ "Previous" | translate }}
                  </button>

                  <button
                    mat-button
                    matStepperNext
                    class="bg-base text-white"
                    [disabled]="contractSubject.invalid"
                  >
                    {{ "Next" | translate }}
                  </button>
                  <button
                    (click)="modal?.dismiss()"
                    class="btn btn-outline-secondary"
                  >
                    {{ "close" | translate }}
                  </button>
                </div>
              </div>
            </form>
          </mat-step>

          <mat-step
            [stepControl]="workDaysHours"
            [editable]="isEditableStepper"
          >
            <form [formGroup]="workDaysHours">
              <ng-template matStepLabel>
                <span>{{ "Working days and hours" | translate }} </span>
              </ng-template>
              <div class="content">
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <div class="form-group">
                      <label
                        for="hoursInWeek"
                        class="text-right col-form-label block"
                      >
                        {{ "working days per week" | translate }}
                      </label>
                      <input
                        formControlName="workingdaysperweek"
                        class="form-control"
                        type="text"
                        id="workingdaysperweek"
                        name="workingdaysperweek"
                        (input)="onInputChange($event)"
                      />
                    </div>
                  </div>
                  <div class="col-md-6 mb-3">
                    <div class="form-group">
                      <label
                        for="hoursInDay"
                        class="text-right col-form-label block"
                      >
                        {{ "Working hours per day" | translate }}
                      </label>
                      <input
                        formControlName="dailyworkinghours"
                        class="form-control"
                        type="text"
                        id="dailyworkinghours"
                        name="dailyworkinghours"
                        (input)="onInputChange($event)"
                      />
                    </div>
                  </div>
                  <div class="col-md-6 mb-3">
                    <div class="form-group">
                      <label
                        for="daysInWeek"
                        class="text-right col-form-label block"
                      >
                        {{ "Working hours per week" | translate }}
                      </label>
                      <input
                        formControlName="workinghoursperweek"
                        class="form-control"
                        type="text"
                        id="workinghoursperweek"
                        name="workinghoursperweek"
                      />
                    </div>
                  </div>
                </div>

                <div class="d-flex items-center justify-end gap-3 mt-4">
                  <button
                    mat-button
                    matStepperPrevious
                    class="btn btn-secondary"
                  >
                    {{ "Previous" | translate }}
                  </button>

                  <button
                    mat-button
                    matStepperNext
                    class="bg-base text-white"
                    [disabled]="workDaysHours.invalid"
                  >
                    {{ "Next" | translate }}
                  </button>
                  <button
                    (click)="modal?.dismiss()"
                    class="btn btn-outline-secondary"
                  >
                    {{ "close" | translate }}
                  </button>
                </div>
              </div>
            </form>
          </mat-step>

          <mat-step
            [stepControl]="firstObligations"
            [editable]="isEditableStepper"
          >
            <form #form="ngForm" [formGroup]="firstObligations">
              <ng-template matStepLabel>
                <span>{{ "First party's obligations" | translate }} </span>
              </ng-template>
              <div class="content">
                <div class="row mb-3">
                  <div class="col-md-6 mb-3">
                    <div class="form-group">
                      <label
                        for="holidays"
                        class="text-right col-form-label block"
                      >
                        {{ "The duration of the annual leave" | translate }}
                      </label>
                      <input
                        formControlName="durationofannualleave"
                        class="form-control"
                        type="text"
                        id="durationofannualleave"
                        name="durationofannualleave"
                      />
                    </div>
                  </div>
                  <div class="col-md-6 mb-3">
                    <div class="form-group">
                      <label
                        for="salaryType"
                        class="text-right col-form-label block"
                      >
                        {{ "pay status" | translate }}
                      </label>
                      <ng-select
                        formControlName="paycase"
                        id="paycase"
                        name="paycase"
                      >
                        <ng-option [value]="0">
                          {{ "Chose" | translate }}</ng-option
                        >

                        <ng-option value="1">{{
                          "per month" | translate
                        }}</ng-option>
                        <ng-option value="2">{{
                          "lumped" | translate
                        }}</ng-option>
                      </ng-select>
                    </div>
                  </div>
                  <div class="col-md-6 mb-3">
                    <div class="form-group">
                      <label
                        for="basicSalary"
                        class="text-right col-form-label block"
                      >
                        {{ "basic salary" | translate }}
                      </label>
                      <input
                        formControlName="freelanceAmount"
                        class="form-control"
                        type="text"
                        id="freelanceAmount"
                        name="freelanceAmount"
                        (input)="onInputChange2($event)"
                      />
                    </div>
                  </div>
                  <div class="col-md-6 mb-3">
                    <div class="form-group">
                      <label
                        for="housingAllowance"
                        class="text-right col-form-label block"
                      >
                        {{ "housing allowance" | translate }}
                      </label>
                      <input
                        formControlName="allowanceAmount"
                        class="form-control"
                        type="text"
                        id="allowanceAmount"
                        name="allowanceAmount"
                        (input)="onInputChange2($event)"
                      />
                    </div>
                  </div>
                  <div class="col-md-6 mb-3">
                    <div class="form-group">
                      <label
                        for="dailySalary"
                        class="text-right col-form-label block"
                      >
                        {{ "employee journal" | translate }}
                      </label>
                      <input
                        formControlName="dailyEmpCost"
                        class="form-control"
                        type="text"
                        id="dailyEmpCost"
                        name="dailyEmpCost"
                      />
                    </div>
                  </div>
                </div>

                <div class="row mb-3">
                  <h3 class="flex items-center justify-start fw-bold">
                    {{ "Add a new item" | translate }}
                    <button
                      type="button "
                      class="add-btn mx-2"
                      (click)="addBand(bands?.length)"
                    >
                      <i class="fa fa-plus"></i>
                    </button>
                  </h3>

                  <div class="table editable shadow">
                    <table
                      class="table table-responsive table-striped table-bordered text-center"
                      style="vertical-align: middle; font-size: 14px"
                    >
                      <thead
                        class="bg-base text-white"
                        style="line-height: 30px; font-size: 13px"
                      >
                        <tr>
                          <th>{{ "no" | translate }}</th>
                          <th>{{ "clause" | translate }}</th>
                          <th>{{ "action" | translate }}</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr
                          *ngFor="let item of bands; let i = index"
                          style="line-height: 5px"
                        >
                          <td>
                            <input
                              type="text"
                              name="op-statement{{ i }}"
                              [ngModelOptions]="{ standalone: true }"
                              [(ngModel)]="item.clauseId"
                              ngModel
                            />
                          </td>
                          <td>
                            <input
                              type="text"
                              name="op-statementEn{{ i }}"
                              [ngModelOptions]="{ standalone: true }"
                              [(ngModel)]="item.clause"
                            />
                          </td>
                          <td>
                            <button
                              class="p-2 bg-red-100 hover:bg-red-500 rounded-lg duration-300 hover:text-white w-10"
                              (click)="deleteBand(i)"
                            >
                              <i class="fa-solid fa-trash-can"></i>
                            </button>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>

                <div class="d-flex items-center justify-end gap-3 mt-4">
                  <button
                    mat-button
                    matStepperPrevious
                    class="btn btn-secondary"
                  >
                    {{ "Previous" | translate }}
                  </button>

                  <button
                    mat-button
                    matStepperNext
                    class="bg-base text-white"
                    [disabled]="firstObligations.invalid"
                  >
                    {{ "Next" | translate }}
                  </button>
                  <button
                    (click)="modal?.dismiss()"
                    class="btn btn-outline-secondary"
                  >
                    {{ "close" | translate }}
                  </button>
                </div>
              </div>
            </form>
          </mat-step>

          <mat-step
            [stepControl]="secondObligations"
            [editable]="isEditableStepper"
          >
            <form [formGroup]="secondObligations">
              <ng-template matStepLabel>
                <span
                  >{{ "Obligations of the second party" | translate }}
                </span>
              </ng-template>
              <div class="content">
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <div class="form-group">
                      <label
                        for="limitCompetition"
                        class="text-right col-form-label block"
                      >
                        {{ "Limit competition" | translate }}
                      </label>
                      <ng-select
                        formControlName="restrictedmode"
                        id="restrictedmode"
                        name="restrictedmode"
                        (change)="compatationValue = $event"
                      >
                        <ng-option [value]="0">
                          {{ "Chose" | translate }}</ng-option
                        >

                        <ng-option value="1">{{
                          "Define a constraint" | translate
                        }}</ng-option>
                        <ng-option value="2">{{
                          "No restriction specified" | translate
                        }}</ng-option>
                      </ng-select>
                    </div>
                  </div>
                  <div *ngIf="compatationValue == '1'" class="col-md-6 mb-3">
                    <div class="form-group">
                      <label
                        for="duration"
                        class="text-right col-form-label block"
                      >
                        {{ "duration" | translate }}
                      </label>
                      <input
                        formControlName="restrictionDuration"
                        class="form-control"
                        type="text"
                        id="restrictionDuration"
                        name="restrictionDuration"
                      />
                    </div>
                  </div>
                  <div *ngIf="compatationValue == '1'" class="col-md-6 mb-3">
                    <div class="form-group">
                      <label
                        for="locating"
                        class="text-right col-form-label block"
                      >
                        {{ "locating" | translate }}
                      </label>
                      <input
                        formControlName="Identifyplaces"
                        class="form-control"
                        type="text"
                        id="Identifyplaces"
                        name="Identifyplaces"
                      />
                    </div>
                  </div>
                  <div *ngIf="compatationValue == '1'" class="col-md-6 mb-3">
                    <div class="form-group">
                      <label
                        for="regardingWork"
                        class="text-right col-form-label block"
                      >
                        {{ "regarding work" | translate }}
                      </label>
                      <input
                        formControlName="withregardtowork"
                        class="form-control"
                        type="text"
                        id="withregardtowork"
                        name="withregardtowork"
                      />
                    </div>
                  </div>
                </div>

                <div class="row">
                  <div class="col-md-6 mb-3">
                    <div class="form-group">
                      <label
                        for="nonDisclosureSecrets"
                        class="text-right col-form-label block"
                      >
                        {{ "Non-disclosure of secrets" | translate }}
                      </label>
                      <ng-select
                        formControlName="notTodivulgeSecrets"
                        id="notTodivulgeSecrets"
                        name="notTodivulgeSecrets"
                        (change)="nonDisclosureSecretsValue = $event"
                      >
                        <ng-option [value]="0">
                          {{ "Chose" | translate }}</ng-option
                        >

                        <ng-option value="1">{{
                          "Define a constraint" | translate
                        }}</ng-option>
                        <ng-option value="2">{{
                          "No restriction specified" | translate
                        }}</ng-option>
                      </ng-select>
                    </div>
                  </div>
                  <div
                    *ngIf="nonDisclosureSecretsValue == '1'"
                    class="col-md-6 mb-3"
                  >
                    <div class="form-group">
                      <label
                        for="duration"
                        class="text-right col-form-label block"
                      >
                        {{ "duration" | translate }}
                      </label>
                      <input
                        formControlName="notTodivulgeSecretsDuration"
                        class="form-control"
                        type="text"
                        id="notTodivulgeSecretsDuration"
                        name="notTodivulgeSecretsDuration"
                      />
                    </div>
                  </div>
                  <div
                    *ngIf="nonDisclosureSecretsValue == '1'"
                    class="col-md-6 mb-3"
                  >
                    <div class="form-group">
                      <label
                        for="locating"
                        class="text-right col-form-label block"
                      >
                        {{ "locating" | translate }}
                      </label>
                      <input
                        formControlName="secretsIdentifyplaces"
                        class="form-control"
                        type="text"
                        id="secretsIdentifyplaces"
                        name="secretsIdentifyplaces"
                      />
                    </div>
                  </div>
                  <div *ngIf="compatationValue == '1'" class="col-md-6 mb-3">
                    <div class="form-group">
                      <label
                        for="regardingWork"
                        class="text-right col-form-label block"
                      >
                        {{ "regarding work" | translate }}
                      </label>
                      <input
                        formControlName="secretsWithregardtowork"
                        class="form-control"
                        type="text"
                        id="secretsWithregardtowork"
                        name="secretsWithregardtowork"
                      />
                    </div>
                  </div>
                </div>

                <div class="d-flex items-center justify-end gap-3 mt-4">
                  <button
                    mat-button
                    matStepperPrevious
                    class="btn btn-secondary"
                  >
                    {{ "Previous" | translate }}
                  </button>

                  <button
                    mat-button
                    matStepperNext
                    class="bg-base text-white"
                    [disabled]="secondObligations.invalid"
                  >
                    {{ "Next" | translate }}
                  </button>
                  <button
                    (click)="modal?.dismiss()"
                    class="btn btn-outline-secondary"
                  >
                    {{ "close" | translate }}
                  </button>
                </div>
              </div>
            </form>
          </mat-step>

          <mat-step
            [stepControl]="terminateContract"
            [editable]="isEditableStepper"
          >
            <form [formGroup]="terminateContract">
              <ng-template matStepLabel>
                <span
                  >{{ "expiration or termination of the contract" | translate }}
                </span>
              </ng-template>
              <div class="content">
                <div class="row">
                  <div class="col-md-6">
                    <label
                      for="noticeContractTermination"
                      class="text-right col-form-label block"
                    >
                      {{ "Notice of contract termination before" | translate }}
                    </label>

                    <ng-select
                      name="contractTerminationNotice"
                      formControlName="contractTerminationNotice"
                    >
                      <ng-option
                        *ngFor="let item of terminateValues"
                        [value]="item.value"
                        [translate]="'name'"
                        [translateParams]="{
                          ar: item?.title?.ar,
                          en: item?.title?.en
                        }"
                      ></ng-option>
                    </ng-select>
                  </div>
                </div>

                <hr class="my-3" />

                <div class="row mb-3">
                  <div class="col-md-6">
                    <label
                      for="noticeContractTermination"
                      class="text-right col-form-label block"
                    >
                      {{ "Contract termination compensation" | translate }}
                    </label>

                    <ng-select
                      name="compensation"
                      formControlName="compensation"
                      placeholder="{{ 'Chose' | translate }}"
                      (change)="comationType = $event"
                    >
                      <ng-option [value]="0">
                        {{ "Chose" | translate }}</ng-option
                      >

                      <ng-option [value]="2">
                        {{ "each party separately" | translate }}</ng-option
                      >
                      <ng-option [value]="1">
                        {{ "BOTH parties" | translate }}</ng-option
                      >
                    </ng-select>
                  </div>
                </div>

                <div *ngIf="comationType == '1'" class="row mb-3">
                  <div class="col-md-6">
                    <div class="form-group">
                      <label
                        for="compensation"
                        class="text-right col-form-label block"
                      >
                        {{
                          "Compensation in case of termination of the contract by one of the parties"
                            | translate
                        }}
                      </label>
                      <input
                        formControlName="compensationBothParty"
                        class="form-control"
                        type="text"
                        id="compensationBothParty"
                        name="compensationBothParty"
                      />
                    </div>
                  </div>
                </div>

                <div *ngIf="comationType == '2'" class="row mb-3">
                  <div class="col-md-6">
                    <div class="form-group">
                      <label
                        for="firstCompensation"
                        class="text-right col-form-label block"
                      >
                        {{ "First party compensation" | translate }}
                      </label>
                      <input
                        formControlName="firstpartycompensation"
                        class="form-control"
                        type="text"
                        id="firstpartycompensation"
                        name="firstpartycompensation"
                      />
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group">
                      <label
                        for="secondCompensation"
                        class="text-right col-form-label block"
                      >
                        {{ "Compensation of the second party" | translate }}
                      </label>
                      <input
                        formControlName="secondpartycompensation"
                        class="form-control"
                        type="text"
                        id="secondpartycompensation"
                        name="secondpartycompensation"
                      />
                    </div>
                  </div>
                </div>

                <div class="d-flex items-center justify-end gap-3 mt-4">
                  <button
                    mat-button
                    matStepperPrevious
                    class="btn btn-secondary"
                  >
                    {{ "Previous" | translate }}
                  </button>

                  <button
                    type="button"
                    class="btn bg-success text-white"
                    [disabled]="terminateContract.invalid"
                    (click)="
                      modalDetails?.id ? EditContract() : AddContract();
                      modal.close('Save click', 'end')
                    "
                  >
                    {{
                      modalDetails?.id
                        ? ("edit" | translate)
                        : ("add" | translate)
                    }}
                  </button>

                  <button
                    (click)="modal?.dismiss()"
                    class="btn btn-outline-secondary"
                  >
                    {{ "close" | translate }}
                  </button>
                </div>
              </div>
            </form>
          </mat-step>
        </mat-stepper>
      </div>
    </form>
  </div>
</ng-template>

<!-- deleteModal -->
<ng-template #deleteModal let-modal>
  <div class="modal-body text-center">
    <p
      [translate]="'name'"
      [translateParams]="{
        ar: 'هل تريد بالتأكيد حذف هذا الصف',
        en: 'Are you sure to delete this row ?'
      }"
    ></p>
    <div class="flex gap-2 justify-center">
      <button
        type="button"
        mat-raised-button
        color="warn"
        (click)="DeleteEmployee(); modal.dismiss()"
      >
        {{ "Yes" | translate }}
      </button>
      <button
        type="button"
        (click)="modal.dismiss()"
        mat-raised-button
        color="basic"
      >
        {{ "No" | translate }}
      </button>
    </div>
  </div>
</ng-template>

<!-- startJobModal -->
<ng-template #startJobModal let-modal>
  <div class="modal-body text-center">
    <p
      [translate]="'name'"
      [translateParams]="{
        ar: 'اختر تاريخ المباشرة',
        en: 'Choose the live date'
      }"
    ></p>
    <form #form="ngForm">
      <div class="row justify-center">
        <div class="col-md-6 mb-4">
          <div class="form-group">
            <div class="form-group timeInput">
              <input
                ngModel
                name="liveDate"
                type="text"
                class="form-control"
                bsDatepicker
              />
            </div>
          </div>
        </div>
      </div>
    </form>
    <div class="flex gap-2 justify-center">
      <button
        type="button"
        mat-raised-button
        color="primary"
        (click)="startJob(form.value); modal.dismiss()"
      >
        {{ "confirem" | translate }}
      </button>
      <button
        type="button"
        (click)="modal.dismiss()"
        mat-raised-button
        color="basic"
      >
        {{ "close" | translate }}
      </button>
    </div>
  </div>
</ng-template>

<!-- endEployeeJobModal -->
<ng-template #endEployeeJobModal let-modal>
  <div
    style="background-color: var(--base-color)"
    class="modal-header text-white flex justify-between items-center"
  >
    <h4
      class="modal-title mb-0"
      id="modal-basic-title"
      [translate]="'name'"
      [translateParams]="{
        ar: ' انهاء خدمات موظف',
        en: 'Ending employee services'
      }"
    ></h4>
    <button
      type="button"
      class="text-white m-0"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    >
      <i class="fa fa-close"></i>
    </button>
  </div>

  <div class="modal-body">
    <form #endServicesForm="ngForm">
      <div class="row">
        <div class="col-md-6 col-lg-4 mb-3">
          <div class="form-group">
            <label class="col-form-label">
              {{ "Reason for termination" | translate }}</label
            >
            <div class="flex">
              <ng-select
                class="w-full p-0"
                style="min-width: unset !important"
                placeholder="{{ 'Chose' | translate }}"
                name="termination"
                [(ngModel)]="endempworkobj.reson"
              >
                <ng-option [value]="0"> {{ "Chose" | translate }}</ng-option>

                <ng-option
                  *ngFor="let user of reasonleaveselect"
                  [value]="user.reasonId"
                  >{{ user.reasonTxt }}</ng-option
                >
              </ng-select>
              <button
                type="button"
                class="btn bg-base text-white"
                style="padding: 5px 10px"
                (click)="open(AddOption)"
              >
                <i class="fa fa-plus"></i>
              </button>
            </div>
          </div>
        </div>
        <div class="col-md-6 col-lg-4 mb-3">
          <div class="form-group">
            <label class="text-right col-form-label block">
              {{ "Service end date" | translate }}
            </label>
            <div class="form-group timeInput">
              <input
                name="date"
                type="text"
                class="form-control"
                name="enddate"
                [(ngModel)]="endempworkobj.enddate"
                bsDatepicker
              />
            </div>
          </div>
        </div>
        <div class="col-md-6 col-lg-4 mb-3">
          <div class="form-group">
            <label class="text-right col-form-label block">
              {{ "Employee Name" | translate }}
            </label>
            <input
              class="form-control"
              type="text"
              disabled
              name="empname"
              [(ngModel)]="emleavedetailsobj.empName"
            />
          </div>
        </div>
        <div class="col-md-6 col-lg-4 mb-3">
          <div class="form-group">
            <label class="text-right col-form-label block">
              {{ "Job ID" | translate }}
            </label>
            <input
              ngModel
              class="form-control"
              type="text"
              disabled
              name="empnumber"
              [(ngModel)]="emleavedetailsobj.empJobNo"
            />
          </div>
        </div>
        <div class="col-md-6 col-lg-4 mb-3">
          <div class="form-group">
            <label class="text-right col-form-label block">
              {{ "branch" | translate }}
            </label>
            <input
              ngModel
              class="form-control"
              type="text"
              disabled
              name="branch"
              [(ngModel)]="emleavedetailsobj.empbranch"
            />
          </div>
        </div>
        <div class="col-md-6 col-lg-4 mb-3">
          <div class="form-group">
            <label class="text-right col-form-label block">
              {{ "Function" | translate }}
            </label>
            <input
              ngModel
              class="form-control"
              type="text"
              disabled
              name="empjob"
              [(ngModel)]="emleavedetailsobj.empJob"
            />
          </div>
        </div>
        <div class="col-md-6 col-lg-4 mb-3">
          <div class="form-group">
            <label class="text-right col-form-label block">
              {{ "Date of hiring" | translate }}
            </label>
            <input
              ngModel
              class="form-control"
              type="text"
              disabled
              name="sempdate"
              [(ngModel)]="emleavedetailsobj.empStartWork"
            />
          </div>
        </div>
        <div class="col-md-6 col-lg-4 mb-3">
          <div class="form-group">
            <label class="text-right col-form-label block">
              {{ "Length of service" | translate }}
            </label>
            <input
              ngModel
              class="form-control"
              type="text"
              disabled
              name="empduration"
              [(ngModel)]="emleavedetailsobj.empTotalServe"
            />
          </div>
        </div>
        <div class="col-md-6 col-lg-4 mb-3">
          <div class="form-group">
            <label class="text-right col-form-label block">
              {{ "Financial covenant" | translate }}
            </label>
            <input
              ngModel
              class="form-control"
              type="text"
              disabled
              name="Financial"
              [(ngModel)]="emleavedetailsobj.empCustoday"
            />
          </div>
        </div>
        <div class="col-md-6 col-lg-4 mb-3">
          <div class="form-group">
            <label class="text-right col-form-label block">
              {{ "The kind covenant" | translate }}
            </label>
            <input
              ngModel
              class="form-control"
              type="text"
              disabled
              name="empcustody"
              [(ngModel)]="emleavedetailsobj.custoday2"
            />
          </div>
        </div>
        <div class="col-md-6 col-lg-4 mb-3">
          <div class="form-group">
            <label class="text-right col-form-label block">
              {{ "predecessor" | translate }}
            </label>
            <input
              ngModel
              class="form-control"
              type="text"
              name="empLoan"
              disabled
              [(ngModel)]="emleavedetailsobj.empLoan"
            />
          </div>
        </div>
        <div class="col-md-6 col-lg-4 mb-3">
          <div class="form-group">
            <label class="text-right col-form-label block">
              {{ "Late salaries" | translate }}
            </label>
            <input
              [(ngModel)]="emleavedetailsobj.empLateSalary"
              disabled
              class="form-control"
              type="text"
              name="emplatesalary"
            />
          </div>
        </div>
        <div class="col-md-6 col-lg-4 mb-3">
          <div class="form-group">
            <label class="text-right col-form-label block">
              {{ "basic salary" | translate }}
            </label>
            <input
              [(ngModel)]="emleavedetailsobj.empNetSalary"
              class="form-control"
              type="text"
              name="empNetsalary"
              disabled
            />
          </div>
        </div>
        <div class="col-md-6 col-lg-4 mb-3">
          <div class="form-group">
            <label class="text-right col-form-label block">
              {{ "allowances" | translate }}
            </label>
            <input
              [(ngModel)]="emleavedetailsobj.empEndallowance"
              disabled
              class="form-control"
              type="text"
              name="EmpEndallowance"
            />
          </div>
        </div>
        <div class="col-md-6 col-lg-4 mb-3">
          <div class="form-group">
            <label class="text-right col-form-label block">
              {{ "Contract end date" | translate }}
            </label>
            <input
              [(ngModel)]="emleavedetailsobj.endContractDate"
              disabled
              class="form-control"
              type="text"
              name="EmpEndcontract"
            />
          </div>
        </div>
        <div class="col-md-10 mb-3">
          <textarea
            [(ngModel)]="reasonobj.description"
            class="form-control"
            type="text"
            name="info"
            style="height: 50px"
          ></textarea>
        </div>
        <div class="col-md-2 mb-3 flex justify-start">
          <button
            type="button"
            (click)="printDailyVoucherReport_Custody()"
            style="height: 50px; padding: 0px 10px"
            class="bg-base text-white"
          >
            {{ "Print" | translate }}
          </button>
        </div>
      </div>
    </form>

    <div class="flex gap-2 justify-end">
      <button
        type="button"
        mat-raised-button
        color="primary"
        (click)="EndWorkforAnEmployee(); modal.dismiss()"
      >
        {{ "confirem" | translate }}
      </button>
      <button
        type="button"
        (click)="modal.dismiss()"
        mat-raised-button
        color="basic"
      >
        {{ "close" | translate }}
      </button>
    </div>
  </div>
</ng-template>

<ng-template #daletereason let-modal>
  <div class="modal-body text-center">
    <p
      [translate]="'name'"
      [translateParams]="{
        ar: 'هل تريد بالتأكيد حذف هذا الصف',
        en: 'Are you sure to delete this row ?'
      }"
    ></p>
    <div class="flex gap-2 justify-center">
      <button
        type="button"
        mat-raised-button
        color="warn"
        (click)="Deletereasonleave(); modal.dismiss()"
      >
        {{ "Yes" | translate }}
      </button>
      <button
        type="button"
        (click)="modal.dismiss()"
        mat-raised-button
        color="basic"
      >
        {{ "No" | translate }}
      </button>
    </div>
  </div>
</ng-template>

<!-- Add option -->
<ng-template #AddOption let-modal>
  <div class="modal-header bg-base text-white">
    <h4
      class="modal-title mb-0"
      id="modal-basic-title"
      [translate]="'name'"
      [translateParams]="{ ar: 'اضافة جديدة', en: 'Add New' }"
    ></h4>
    <button type="button" class="m-0" (click)="modal.dismiss('Cross click')">
      <i class="fa fa-close"></i>
    </button>
  </div>
  <div class="modal-body">
    <form #addOptionForm="ngForm">
      <div class="row">
        <div class="col-lg-6 mb-4 mb-lg-0">
          <div class="form-input-group">
            <label for="" class="block mb-3">{{ "reason" | translate }}</label>
            <input
              type="text"
              placeholder="{{ 'reason' | translate }}"
              class="form-control"
              [(ngModel)]="reasonobj.reasonTxt"
              name="reason"
              required
            />
          </div>
        </div>
        <div class="col-lg-6">
          <div class="form-input-group">
            <label for="" class="block mb-3">{{
              "Resolution text" | translate
            }}</label>
            <input
              type="text"
              placeholder="{{ 'Resolution text' | translate }}"
              class="form-control"
              [(ngModel)]="reasonobj.desecionTxt"
              name="Resolutiontext"
              required
            />
          </div>
        </div>
      </div>
    </form>
  </div>
  <div class="modal-footer justify-content-center" style="border-top: none">
    <button
      type="button"
      class="btn btn-light py-2 px-3 mt-0"
      (click)="modal.dismiss('Cross click')"
    >
      {{ "close" | translate }}
    </button>
    <button
      type="button"
      class="btn submit-btn bg-base text-white py-2 px-3 mt-0"
      [disabled]="addOptionForm.invalid"
      (click)="Savereasonleave()"
    >
      {{ "Save" | translate }}
    </button>

    <div
      class="d-block w-100 mt-4"
      style="
        border-top: 2px solid #d5dadf;
        padding-top: 24px;
        border-radius: 3px;
      "
    >
      <div class="w-100 mb-3">
        <input
          type="text"
          class="form-control pull-right"
          placeholder="{{ 'search' | translate }}"
          name="searchtext"
          [(ngModel)]="searchtext"
          (keyup)="GetAllreasons()"
        />
      </div>

      <div class="max-h-80 overflow-auto col-span-1 mt-2 md:col-span-2">
        <table class="custome-table">
          <thead>
            <tr class="text-center">
              <th>{{ "nameAr" | translate }}</th>
              <th>{{ "nameEn" | translate }}</th>
              <th
                [translate]="'name'"
                [translateParams]="{
                  ar: 'خيارات',
                  en: 'Operations'
                }"
              ></th>
            </tr>
          </thead>
          <tbody>
            <tr
              *ngFor="let item of reasonleavelist; let i = index"
              style="line-height: 5px"
            >
              <td>
                <input
                  type="text"
                  name="os-namear{{ i }}"
                  [(ngModel)]="item.reasonTxt"
                  disabled="true"
                />
              </td>
              <td>
                <input
                  type="text"
                  name="os-nameen{{ i }}"
                  [(ngModel)]="item.desecionTxt"
                  disabled="true"
                />
              </td>
              <td>
                <button
                  (click)="editreasontext(item)"
                  class="p-2 bg-orange-100 hover:bg-orange-500 rounded-lg duration-300 hover:text-white w-10"
                >
                  <i class="fa-regular fa-pen-to-square"></i>
                </button>

                <button
                  class="p-2 bg-red-100 hover:bg-red-500 rounded-lg duration-300 hover:text-white w-10 me-3"
                  (click)="open(daletereason, item, 'deletereason')"
                >
                  <i class="fa-solid fa-trash-can"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</ng-template>
